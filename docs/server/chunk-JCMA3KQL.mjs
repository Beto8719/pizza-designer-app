import './polyfills.server.mjs';
import{a as _x,b as xx,c as wx,f as kx,l as _m}from"./chunk-7EFHO4RO.mjs";import{$ as ee,$a as ze,A as Qi,Ab as gx,Ca as Xi,D as lm,Da as Rn,Ea as ux,F as dm,Gb as bx,H as Wl,J as ox,Ja as se,Ka as q,La as Xl,M as Kl,Ma as hx,N as Ql,Na as fx,O as Xa,Oa as pm,Ob as gm,P as Yl,Pa as mx,Pb as os,Q as ro,Qa as de,R as is,S as um,T as ei,Ta as ti,U as hm,Ua as Zi,Ub as jt,V as so,Vb as bm,X as rs,Xb as ym,Y as pe,Ya as We,Z as oe,Za as qt,_a as Ve,_b as ln,a as cm,ab as Zl,ba as j,bb as Ut,c as Xn,ca as He,cb as $,da as ax,db as W,eb as Ie,f as Rt,fb as Nn,g as ex,ga as le,gb as ss,h as Gl,ha as dt,hb as Re,hc as ed,i as tx,ia as ae,ib as Se,ic as td,j as nx,ja as we,jb as gn,jc as yx,k as ns,ka as cx,kb as qe,kc as nd,l as io,lb as Ji,m as Zn,mb as an,mc as vx,n as Jn,nb as ut,nc as id,oa as Yi,ob as ht,pa as vt,pb as Za,qa as _t,qb as ye,r as Hl,ra as lx,rb as oo,rc as Ex,s as nt,sa as dx,sb as ao,sc as Tx,t as ix,ta as fm,tb as Ja,tc as vm,ua as mm,ub as ec,uc as Cx,vb as tc,vc as Sx,w as rx,wb as cn,xa as $e,xb as Yt,y as sx,ya as on,yb as px,z as $l,zb as Jl}from"./chunk-AVRSS33M.mjs";import{a as Ix,b as xm,c as Ax,d as nc,e as wm,f as rd,g as Dx,h as Mx,i as Em,j as Ke,k as as,l as ni,m as sd,n as ic,o as Rx,p as Nx,q as er,r as Xt}from"./chunk-GGVYWPAP.mjs";import{a as ke,b as Yn,c as xe,f as A,h as J0,i as am,j as w}from"./chunk-H6KHSOBK.mjs";var _e=A(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=yn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=yn.Propagate=yn.LogVerbosity=yn.Status=void 0;var sE=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n}(sE||(yn.Status=sE={})),oE=function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n}(oE||(yn.LogVerbosity=oE={})),aE=function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n}(aE||(yn.Propagate=aE={}));yn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;yn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var lp=A((U$,wN)=>{wN.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Je=A(Gt=>{"use strict";var dp,up,hp,fp;Object.defineProperty(Gt,"__esModule",{value:!0});Gt.isTracerEnabled=Gt.trace=Gt.log=Gt.setLoggerVerbosity=Gt.setLogger=Gt.getLogger=void 0;var or=_e(),EN=xe("process"),TN=lp().version,CN={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},ms=CN,go=or.LogVerbosity.ERROR,SN=(up=(dp=process.env.GRPC_NODE_VERBOSITY)!==null&&dp!==void 0?dp:process.env.GRPC_VERBOSITY)!==null&&up!==void 0?up:"";switch(SN.toUpperCase()){case"DEBUG":go=or.LogVerbosity.DEBUG;break;case"INFO":go=or.LogVerbosity.INFO;break;case"ERROR":go=or.LogVerbosity.ERROR;break;case"NONE":go=or.LogVerbosity.NONE;break;default:}var kN=()=>ms;Gt.getLogger=kN;var IN=n=>{ms=n};Gt.setLogger=IN;var AN=n=>{go=n};Gt.setLoggerVerbosity=AN;var DN=(n,...e)=>{let t;if(n>=go){switch(n){case or.LogVerbosity.DEBUG:t=ms.debug;break;case or.LogVerbosity.INFO:t=ms.info;break;case or.LogVerbosity.ERROR:t=ms.error;break}t||(t=ms.error),t&&t.bind(ms)(...e)}};Gt.log=DN;var MN=(fp=(hp=process.env.GRPC_NODE_TRACE)!==null&&hp!==void 0?hp:process.env.GRPC_TRACE)!==null&&fp!==void 0?fp:"",mp=new Set,cE=new Set;for(let n of MN.split(","))n.startsWith("-")?cE.add(n.substring(1)):mp.add(n);var RN=mp.has("all");function NN(n,e,t){lE(e)&&(0,Gt.log)(n,new Date().toISOString()+" | v"+TN+" "+EN.pid+" | "+e+" | "+t)}Gt.trace=NN;function lE(n){return!cE.has(n)&&(RN||mp.has(n))}Gt.isTracerEnabled=lE});var Md=A(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.getErrorCode=bo.getErrorMessage=void 0;function ON(n){return n instanceof Error?n.message:String(n)}bo.getErrorMessage=ON;function FN(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}bo.getErrorCode=FN});var Jt=A(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Metadata=void 0;var PN=Je(),LN=_e(),BN=Md(),VN=/^[0-9a-z_.-]+$/,zN=/^[ -~]*$/;function qN(n){return VN.test(n)}function UN(n){return zN.test(n)}function uE(n){return n.endsWith("-bin")}function jN(n){return!n.startsWith("grpc-")}function Rd(n){return n.toLowerCase()}function dE(n,e){if(!qN(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(uE(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!UN(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var pp=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=Rd(e),dE(e,t),this.internalRepr.set(e,[t])}add(e,t){e=Rd(e),dE(e,t);let i=this.internalRepr.get(e);i===void 0?this.internalRepr.set(e,[t]):i.push(t)}remove(e){e=Rd(e),this.internalRepr.delete(e)}get(e){return e=Rd(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,i]of this.internalRepr)if(i.length>0){let r=i[0];e[t]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[i,r]of this.internalRepr){let s=r.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(i,s)}return e}merge(e){for(let[t,i]of e.internalRepr){let r=(this.internalRepr.get(t)||[]).concat(i);this.internalRepr.set(t,r)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,i]of this.internalRepr)e[t]=i.map(GN);return e}toJSON(){let e={};for(let[t,i]of this.internalRepr)e[t]=i;return e}static fromHttp2Headers(e){let t=new n;for(let i of Object.keys(e)){if(i.charAt(0)===":")continue;let r=e[i];try{uE(i)?Array.isArray(r)?r.forEach(s=>{t.add(i,Buffer.from(s,"base64"))}):r!==void 0&&(jN(i)?r.split(",").forEach(s=>{t.add(i,Buffer.from(s.trim(),"base64"))}):t.add(i,Buffer.from(r,"base64"))):Array.isArray(r)?r.forEach(s=>{t.add(i,s)}):r!==void 0&&t.add(i,r)}catch(s){let o=`Failed to add metadata entry ${i}: ${r}. ${(0,BN.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,PN.log)(LN.LogVerbosity.ERROR,o)}}return t}};Nd.Metadata=pp;var GN=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var _p=A(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.CallCredentials=void 0;var vp=Jt();function HN(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var yo=class n{static createFromMetadataGenerator(e){return new bp(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,i)=>{let r;HN(e)?r=e.getRequestHeaders(t.service_url):r=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,c)=>{if(a){o(a);return}if(!c){o(new Error("Headers not set by metadata plugin"));return}s(c)})}),r.then(s=>{let o=new vp.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);i(null,o)},s=>{i(s)})})}static createEmpty(){return new yp}};Od.CallCredentials=yo;var gp=class n extends yo{constructor(e){super(),this.creds=e}generateMetadata(e){return w(this,null,function*(){let t=new vp.Metadata,i=yield Promise.all(this.creds.map(r=>r.generateMetadata(e)));for(let r of i)t.merge(r);return t})}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,i)=>t._equals(e.creds[i])):!1}},bp=class n extends yo{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,i)=>{this.metadataGenerator(e,(r,s)=>{s!==void 0?t(s):i(r)})})}compose(e){return new gp([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},yp=class n extends yo{generateMetadata(e){return Promise.resolve(new vp.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var wp=A(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.getDefaultRootsData=vo.CIPHER_SUITES=void 0;var $N=xe("fs");vo.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var hE=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,xp=null;function WN(){return hE?(xp===null&&(xp=$N.readFileSync(hE)),xp):null}vo.getDefaultRootsData=WN});var Ld=A(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});Pd.ChannelCredentials=void 0;var KN=xe("tls"),QN=_p(),fE=wp();function Ep(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var _o=class{constructor(e){this.callCredentials=e||QN.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,i,r){var s;if(Ep(e,"Root certificate"),Ep(t,"Private key"),Ep(i,"Certificate chain"),t&&!i)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&i)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,KN.createSecureContext)({ca:(s=e??(0,fE.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:i??void 0,ciphers:fE.CIPHER_SUITES});return new Fd(o,r??{})}static createFromSecureContext(e,t){return new Fd(e,t??{})}static createInsecure(){return new Tp}};Pd.ChannelCredentials=_o;var Tp=class n extends _o{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},Fd=class n extends _o{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new Cp(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},Cp=class n extends _o{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var cr=A(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.validateLoadBalancingConfig=Nt.getFirstUsableConfig=Nt.isLoadBalancerNameRegistered=Nt.createLoadBalancer=Nt.registerDefaultLoadBalancerType=Nt.registerLoadBalancerType=Nt.createChildChannelControlHelper=void 0;function YN(n,e){var t,i,r,s,o,a,c,l,d,u;return{createSubchannel:(i=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&i!==void 0?i:n.createSubchannel.bind(n),updateState:(s=(r=e.updateState)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(l=(c=e.addChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:n.addChannelzChild.bind(n),removeChannelzChild:(u=(d=e.removeChannelzChild)===null||d===void 0?void 0:d.bind(e))!==null&&u!==void 0?u:n.removeChannelzChild.bind(n)}}Nt.createChildChannelControlHelper=YN;var ar={},Sp=null;function XN(n,e,t){ar[n]={LoadBalancer:e,LoadBalancingConfig:t}}Nt.registerLoadBalancerType=XN;function ZN(n){Sp=n}Nt.registerDefaultLoadBalancerType=ZN;function JN(n,e){let t=n.getLoadBalancerName();return t in ar?new ar[t].LoadBalancer(e):null}Nt.createLoadBalancer=JN;function eO(n){return n in ar}Nt.isLoadBalancerNameRegistered=eO;function tO(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in ar)return t;return e&&Sp?new ar[Sp].LoadBalancingConfig:null}Nt.getFirstUsableConfig=tO;function nO(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in ar)return ar[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}Nt.validateLoadBalancingConfig=nO});var kp=A(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.extractAndSelectServiceConfig=lr.validateServiceConfig=lr.validateRetryThrottling=void 0;var iO=xe("os"),Bd=_e(),rO=cr(),Vd=/^\d+(\.\d{1,9})?s$/,sO="node";function oO(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function aO(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Vd.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Vd.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Bd.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Bd.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function cO(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Vd.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Bd.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Bd.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function lO(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let i of n.name)t.name.push(oO(i));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Vd.test(n.timeout)){let i=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:i[0]|0,nanos:((e=i[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=aO(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=cO(n.hedgingPolicy));return t}function mE(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}lr.validateRetryThrottling=mE;function pE(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let i of n.loadBalancingConfig)e.loadBalancingConfig.push((0,rO.validateLoadBalancingConfig)(i));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let i of n.methodConfig)e.methodConfig.push(lO(i));"retryThrottling"in n&&(e.retryThrottling=mE(n.retryThrottling));let t=[];for(let i of e.methodConfig)for(let r of i.name){for(let s of t)if(r.service===s.service&&r.method===s.method)throw new Error(`Invalid service config: duplicate name ${r.service}/${r.method}`);t.push(r)}return e}lr.validateServiceConfig=pE;function dO(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:pE(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let i of n.clientLanguage)if(typeof i=="string")e.clientLanguage.push(i);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let i of n.clientHostname)if(typeof i=="string")e.clientHostname.push(i);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let i in n)if(!t.includes(i))throw new Error(`Invalid service config choice: unexpected field ${i}`);return e}function uO(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let i=dO(t);if(!(typeof i.percentage=="number"&&e>i.percentage)){if(Array.isArray(i.clientHostname)){let r=!1;for(let s of i.clientHostname)s===iO.hostname()&&(r=!0);if(!r)continue}if(Array.isArray(i.clientLanguage)){let r=!1;for(let s of i.clientLanguage)s===sO&&(r=!0);if(!r)continue}return i.serviceConfig}}throw new Error("No matching service config found")}function hO(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let i=t.join("").substring(12),r=JSON.parse(i);return uO(r,e)}return null}lr.extractAndSelectServiceConfig=hO});var vn=A(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.ConnectivityState=void 0;var gE=function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n}(gE||(zd.ConnectivityState=gE={}))});var dn=A(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.uriToString=dr.splitHostPort=dr.parseUri=void 0;var fO=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function mO(n){let e=fO.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}dr.parseUri=mO;var bE=/^\d+$/;function pO(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let i=n.substring(e+2);return bE.test(i)?{host:t,port:+i}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?bE.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}dr.splitHostPort=pO;function gO(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}dr.uriToString=gO});var si=A(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.mapUriDefaultScheme=_n.getDefaultAuthority=_n.createResolver=_n.registerDefaultScheme=_n.registerResolver=void 0;var Ap=dn(),xo={},Ip=null;function bO(n,e){xo[n]=e}_n.registerResolver=bO;function yO(n){Ip=n}_n.registerDefaultScheme=yO;function vO(n,e,t){if(n.scheme!==void 0&&n.scheme in xo)return new xo[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,Ap.uriToString)(n)}`)}_n.createResolver=vO;function _O(n){if(n.scheme!==void 0&&n.scheme in xo)return xo[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,Ap.uriToString)(n)}`)}_n.getDefaultAuthority=_O;function xO(n){return n.scheme===void 0||!(n.scheme in xo)?Ip!==null?{scheme:Ip,authority:void 0,path:(0,Ap.uriToString)(n)}:null:n}_n.mapUriDefaultScheme=xO});var hr=A(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.QueuePicker=ur.UnavailablePicker=ur.PickResultType=void 0;var wO=Jt(),EO=_e(),qd=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n}(qd||(ur.PickResultType=qd={})),Dp=class{constructor(e){this.status=Object.assign({code:EO.Status.UNAVAILABLE,details:"No connection established",metadata:new wO.Metadata},e)}pick(e){return{pickResultType:qd.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};ur.UnavailablePicker=Dp;var Mp=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:qd.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};ur.QueuePicker=Mp});var hc=A(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.BackoffTimeout=void 0;var TO=1e3,CO=1.6,SO=12e4,kO=.2;function IO(n,e){return Math.random()*(e-n)+n}var Rp=class{constructor(e,t){this.callback=e,this.initialDelay=TO,this.multiplier=CO,this.maxDelay=SO,this.jitter=kO,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,i;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(i=(t=this.timerId).unref)===null||i===void 0||i.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+IO(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};Ud.BackoffTimeout=Rp});var Gd=A(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.ChildLoadBalancerHandler=void 0;var AO=cr(),DO=vn(),MO="child_load_balancer_helper",Np=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,i){return this.parent.channelControlHelper.createSubchannel(t,i)}updateState(t,i){var r;if(this.calledByPendingChild()){if(t===DO.ConnectivityState.CONNECTING)return;(r=this.parent.currentChild)===null||r===void 0||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,i)}requestReresolution(){var t;let i=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===i&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,i){let r;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,AO.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,r=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,r=this.pendingChild)}else this.pendingChild===null?r=this.currentChild:r=this.pendingChild;this.latestConfig=t,r.updateAddressList(e,t,i)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return MO}};jd.ChildLoadBalancerHandler=Np});var vE=A(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.ResolvingLoadBalancer=void 0;var RO=cr(),NO=kp(),en=vn(),OO=si(),wo=hr(),FO=hc(),Op=_e(),PO=Jt(),LO=Je(),BO=_e(),VO=dn(),zO=Gd(),qO="resolving_load_balancer";function yE(n){LO.trace(BO.LogVerbosity.DEBUG,qO,n)}var UO=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function jO(n,e,t,i){for(let r of t.name)switch(i){case"EMPTY":if(!r.service&&!r.method)return!0;break;case"SERVICE":if(r.service===n&&!r.method)return!0;break;case"SERVICE_AND_METHOD":if(r.service===n&&r.method===e)return!0}return!1}function GO(n,e,t,i){for(let r of t)if(jO(n,e,r,i))return r;return null}function HO(n){return function(t,i){var r,s;let o=t.split("/").filter(l=>l.length>0),a=(r=o[0])!==null&&r!==void 0?r:"",c=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let l of UO){let d=GO(a,c,n.methodConfig,l);if(d)return{methodConfig:d,pickInformation:{},status:Op.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Op.Status.OK,dynamicFilterFactories:[]}}}var Fp=class{constructor(e,t,i,r,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=r,this.onFailedResolution=s,this.latestChildState=en.ConnectivityState.IDLE,this.latestChildPicker=new wo.QueuePicker(this),this.currentState=en.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,i["grpc.service_config"]?this.defaultServiceConfig=(0,NO.validateServiceConfig)(JSON.parse(i["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(en.ConnectivityState.IDLE,new wo.QueuePicker(this)),this.childLoadBalancer=new zO.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(yE("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,c)=>{this.latestChildState=a,this.latestChildPicker=c,this.updateState(a,c)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,OO.createResolver)(e,{onSuccessfulResolution:(a,c,l,d,u)=>{var f;this.backoffTimeout.stop(),this.backoffTimeout.reset();let b=null;c===null?l===null?(this.previousServiceConfig=null,b=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(l):b=this.previousServiceConfig:(b=c,this.previousServiceConfig=c);let E=(f=b?.loadBalancingConfig)!==null&&f!==void 0?f:[],T=(0,RO.getFirstUsableConfig)(E,!0);if(T===null){this.handleResolutionFailure({code:Op.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new PO.Metadata});return}this.childLoadBalancer.updateAddressList(a,T,u);let S=b??this.defaultServiceConfig;this.onSuccessfulResolution(S,d??HO(S))},onError:a=>{this.handleResolutionFailure(a)}},i);let o={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new FO.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===en.ConnectivityState.IDLE&&this.updateState(en.ConnectivityState.CONNECTING,new wo.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){yE((0,VO.uriToString)(this.target)+" "+en.ConnectivityState[this.currentState]+" -> "+en.ConnectivityState[e]),e===en.ConnectivityState.IDLE&&(t=new wo.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===en.ConnectivityState.IDLE&&(this.updateState(en.ConnectivityState.TRANSIENT_FAILURE,new wo.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===en.ConnectivityState.IDLE||this.currentState===en.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=en.ConnectivityState.IDLE,this.latestChildPicker=new wo.QueuePicker(this),this.currentState=en.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Hd.ResolvingLoadBalancer=Fp});var _E=A(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.channelOptionsEqual=Eo.recognizedOptions=void 0;Eo.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function $O(n,e){let t=Object.keys(n).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let r=0;r<t.length;r+=1)if(t[r]!==i[r]||n[t[r]]!==e[i[r]])return!1;return!0}Eo.channelOptionsEqual=$O});var ai=A(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.stringToSubchannelAddress=oi.subchannelAddressToString=oi.subchannelAddressEqual=oi.isTcpSubchannelAddress=void 0;var WO=xe("net");function fc(n){return"port"in n}oi.isTcpSubchannelAddress=fc;function KO(n,e){return!n&&!e?!0:!n||!e?!1:fc(n)?fc(e)&&n.host===e.host&&n.port===e.port:!fc(e)&&n.path===e.path}oi.subchannelAddressEqual=KO;function QO(n){return fc(n)?n.host+":"+n.port:n.path}oi.subchannelAddressToString=QO;var YO=443;function XO(n,e){return(0,WO.isIP)(n)?{host:n,port:e??YO}:{path:n}}oi.stringToSubchannelAddress=XO});var $d=A(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.addAdminServicesToServer=To.registerAdminService=void 0;var xE=[];function ZO(n,e){xE.push({getServiceDefinition:n,getHandlers:e})}To.registerAdminService=ZO;function JO(n){for(let{getServiceDefinition:e,getHandlers:t}of xE)n.addService(e(),t())}To.addAdminServicesToServer=JO});var wE=A(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.ClientDuplexStreamImpl=xn.ClientWritableStreamImpl=xn.ClientReadableStreamImpl=xn.ClientUnaryCallImpl=xn.callErrorFromStatus=void 0;var eF=xe("events"),zp=xe("stream"),mc=_e();function tF(n,e){let t=`${n.code} ${mc.Status[n.code]}: ${n.details}`,r=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:r})}xn.callErrorFromStatus=tF;var Pp=class extends eF.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};xn.ClientUnaryCallImpl=Pp;var Lp=class extends zp.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};xn.ClientReadableStreamImpl=Lp;var Bp=class extends zp.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};xn.ClientWritableStreamImpl=Bp;var Vp=class extends zp.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(mc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,i){var r;let s={callback:i},o=Number(t);Number.isNaN(o)||(s.flags=o),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};xn.ClientDuplexStreamImpl=Vp});var EE=A(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.InterceptingListenerImpl=Co.isInterceptingListener=void 0;function nF(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}Co.isInterceptingListener=nF;var qp=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};Co.InterceptingListenerImpl=qp});var Kp=A(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.getInterceptingCall=wn.InterceptingCall=wn.RequesterBuilder=wn.ListenerBuilder=wn.InterceptorConfigurationError=void 0;var iF=Jt(),TE=EE(),CE=_e(),SE=Md(),gc=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};wn.InterceptorConfigurationError=gc;var jp=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};wn.ListenerBuilder=jp;var Gp=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};wn.RequesterBuilder=Gp;var Up={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},pc={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},Hp=class{constructor(e,t){var i,r,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(i=t.start)!==null&&i!==void 0?i:pc.start,sendMessage:(r=t.sendMessage)!==null&&r!==void 0?r:pc.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:pc.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:pc.cancel}:this.requester=pc}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var i,r,s,o,a,c;let l={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:d=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:d=>{},onReceiveStatus:(c=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&c!==void 0?c:d=>{}};this.processingMetadata=!0,this.requester.start(e,l,(d,u)=>{var f,b,E;this.processingMetadata=!1;let T;if((0,TE.isInterceptingListener)(u))T=u;else{let S={onReceiveMetadata:(f=u.onReceiveMetadata)!==null&&f!==void 0?f:Up.onReceiveMetadata,onReceiveMessage:(b=u.onReceiveMessage)!==null&&b!==void 0?b:Up.onReceiveMessage,onReceiveStatus:(E=u.onReceiveStatus)!==null&&E!==void 0?E:Up.onReceiveStatus};T=new TE.InterceptingListenerImpl(S,l)}this.nextCall.start(d,T),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,i),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};wn.InterceptingCall=Hp;function rF(n,e,t){var i,r;let s=(i=t.deadline)!==null&&i!==void 0?i:1/0,o=t.host,a=(r=t.parent)!==null&&r!==void 0?r:null,c=t.propagate_flags,l=t.credentials,d=n.createCall(e,s,o,a,c);return l&&d.setCredentials(l),d}var Wd=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let i;try{i=this.methodDefinition.requestSerialize(t)}catch(r){this.call.cancelWithStatus(CE.Status.INTERNAL,`Request message serialization failure: ${(0,SE.getErrorMessage)(r)}`);return}this.call.sendMessageWithContext(e,i)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let i=null;this.call.start(e,{onReceiveMetadata:r=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,r)},onReceiveMessage:r=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(r)}catch(a){i={code:CE.Status.INTERNAL,details:`Response message parsing error: ${(0,SE.getErrorMessage)(a)}`,metadata:new iF.Metadata},this.call.cancelWithStatus(i.code,i.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:r=>{var s,o;i?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,i):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,r)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},$p=class extends Wd{constructor(e,t){super(e,t)}start(e,t){var i,r;let s=!1,o={onReceiveMetadata:(r=(i=t?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(t))!==null&&r!==void 0?r:a=>{},onReceiveMessage:a=>{var c;s=!0,(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,a)},onReceiveStatus:a=>{var c,l;s||(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,null),(l=t?.onReceiveStatus)===null||l===void 0||l.call(t,a)}};super.start(e,o),this.call.startRead()}},Wp=class extends Wd{};function sF(n,e,t){let i=rF(n,t.path,e);return t.responseStream?new Wp(i,t):new $p(i,t)}function oF(n,e,t,i){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new gc("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new gc("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let r=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?r=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):r=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return r.reduceRight((a,c)=>l=>c(l,a),a=>sF(i,a,e))(s)}wn.getInterceptingCall=oF});var Xp=A(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.Client=void 0;var ci=wE(),aF=Zp(),cF=vn(),fr=_e(),So=Jt(),Kd=Kp(),Fn=Symbol(),ko=Symbol(),Io=Symbol(),Di=Symbol();function Qp(n){return typeof n=="function"}function Ao(n){return n.stack.split(`
`).slice(1).join(`
`)}var Yp=class{constructor(e,t,i={}){var r,s;if(i=Object.assign({},i),this[ko]=(r=i.interceptors)!==null&&r!==void 0?r:[],delete i.interceptors,this[Io]=(s=i.interceptor_providers)!==null&&s!==void 0?s:[],delete i.interceptor_providers,this[ko].length>0&&this[Io].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Di]=i.callInvocationTransformer,delete i.callInvocationTransformer,i.channelOverride)this[Fn]=i.channelOverride;else if(i.channelFactoryOverride){let o=i.channelFactoryOverride;delete i.channelFactoryOverride,this[Fn]=o(e,t,i)}else this[Fn]=new aF.ChannelImplementation(e,t,i)}close(){this[Fn].close()}getChannel(){return this[Fn]}waitForReady(e,t){let i=r=>{if(r){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Fn].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===cF.ConnectivityState.READY)t();else try{this[Fn].watchConnectivityState(s,e,i)}catch{t(new Error("The channel has been closed"))}};setImmediate(i)}checkOptionalUnaryResponseArguments(e,t,i){if(Qp(e))return{metadata:new So.Metadata,options:{},callback:e};if(Qp(t))return e instanceof So.Metadata?{metadata:e,options:{},callback:t}:{metadata:new So.Metadata,options:e,callback:t};if(!(e instanceof So.Metadata&&t instanceof Object&&Qp(i)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:i}}makeUnaryRequest(e,t,i,r,s,o,a){var c,l;let d=this.checkOptionalUnaryResponseArguments(s,o,a),u={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:i},f={argument:r,metadata:d.metadata,call:new ci.ClientUnaryCallImpl,channel:this[Fn],methodDefinition:u,callOptions:d.options,callback:d.callback};this[Di]&&(f=this[Di](f));let b=f.call,E={clientInterceptors:this[ko],clientInterceptorProviders:this[Io],callInterceptors:(c=f.callOptions.interceptors)!==null&&c!==void 0?c:[],callInterceptorProviders:(l=f.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},T=(0,Kd.getInterceptingCall)(E,f.methodDefinition,f.callOptions,f.channel);b.call=T;let S=null,M=!1,I=new Error;return T.start(f.metadata,{onReceiveMetadata:F=>{b.emit("metadata",F)},onReceiveMessage(F){S!==null&&T.cancelWithStatus(fr.Status.INTERNAL,"Too many responses received"),S=F},onReceiveStatus(F){if(!M){if(M=!0,F.code===fr.Status.OK)if(S===null){let P=Ao(I);f.callback((0,ci.callErrorFromStatus)({code:fr.Status.INTERNAL,details:"No message received",metadata:F.metadata},P))}else f.callback(null,S);else{let P=Ao(I);f.callback((0,ci.callErrorFromStatus)(F,P))}I=null,b.emit("status",F)}}}),T.sendMessage(r),T.halfClose(),b}makeClientStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkOptionalUnaryResponseArguments(r,s,o),d={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:i},u={metadata:l.metadata,call:new ci.ClientWritableStreamImpl(t),channel:this[Fn],methodDefinition:d,callOptions:l.options,callback:l.callback};this[Di]&&(u=this[Di](u));let f=u.call,b={clientInterceptors:this[ko],clientInterceptorProviders:this[Io],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=u.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},E=(0,Kd.getInterceptingCall)(b,u.methodDefinition,u.callOptions,u.channel);f.call=E;let T=null,S=!1,M=new Error;return E.start(u.metadata,{onReceiveMetadata:I=>{f.emit("metadata",I)},onReceiveMessage(I){T!==null&&E.cancelWithStatus(fr.Status.INTERNAL,"Too many responses received"),T=I},onReceiveStatus(I){if(!S){if(S=!0,I.code===fr.Status.OK)if(T===null){let F=Ao(M);u.callback((0,ci.callErrorFromStatus)({code:fr.Status.INTERNAL,details:"No message received",metadata:I.metadata},F))}else u.callback(null,T);else{let F=Ao(M);u.callback((0,ci.callErrorFromStatus)(I,F))}M=null,f.emit("status",I)}}}),f}checkMetadataAndOptions(e,t){let i,r;return e instanceof So.Metadata?(i=e,t?r=t:r={}):(e?r=e:r={},i=new So.Metadata),{metadata:i,options:r}}makeServerStreamRequest(e,t,i,r,s,o){var a,c;let l=this.checkMetadataAndOptions(s,o),d={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:i},u={argument:r,metadata:l.metadata,call:new ci.ClientReadableStreamImpl(i),channel:this[Fn],methodDefinition:d,callOptions:l.options};this[Di]&&(u=this[Di](u));let f=u.call,b={clientInterceptors:this[ko],clientInterceptorProviders:this[Io],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=u.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},E=(0,Kd.getInterceptingCall)(b,u.methodDefinition,u.callOptions,u.channel);f.call=E;let T=!1,S=new Error;return E.start(u.metadata,{onReceiveMetadata(M){f.emit("metadata",M)},onReceiveMessage(M){f.push(M)},onReceiveStatus(M){if(!T){if(T=!0,f.push(null),M.code!==fr.Status.OK){let I=Ao(S);f.emit("error",(0,ci.callErrorFromStatus)(M,I))}S=null,f.emit("status",M)}}}),E.sendMessage(r),E.halfClose(),f}makeBidiStreamRequest(e,t,i,r,s){var o,a;let c=this.checkMetadataAndOptions(r,s),l={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:i},d={metadata:c.metadata,call:new ci.ClientDuplexStreamImpl(t,i),channel:this[Fn],methodDefinition:l,callOptions:c.options};this[Di]&&(d=this[Di](d));let u=d.call,f={clientInterceptors:this[ko],clientInterceptorProviders:this[Io],callInterceptors:(o=d.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=d.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},b=(0,Kd.getInterceptingCall)(f,d.methodDefinition,d.callOptions,d.channel);u.call=b;let E=!1,T=new Error;return b.start(d.metadata,{onReceiveMetadata(S){u.emit("metadata",S)},onReceiveMessage(S){u.push(S)},onReceiveStatus(S){if(!E){if(E=!0,u.push(null),S.code!==fr.Status.OK){let M=Ao(T);u.emit("error",(0,ci.callErrorFromStatus)(S,M))}T=null,u.emit("status",S)}}}),u}};Qd.Client=Yp});var eg=A(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.loadPackageDefinition=Do.makeClientConstructor=void 0;var bc=Xp(),lF={unary:bc.Client.prototype.makeUnaryRequest,server_stream:bc.Client.prototype.makeServerStreamRequest,client_stream:bc.Client.prototype.makeClientStreamRequest,bidi:bc.Client.prototype.makeBidiStreamRequest};function Jp(n){return["__proto__","prototype","constructor"].includes(n)}function kE(n,e,t){t||(t={});class i extends bc.Client{}return Object.keys(n).forEach(r=>{if(Jp(r))return;let s=n[r],o;if(typeof r=="string"&&r.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,c=s.responseDeserialize,l=dF(lF[o],s.path,a,c);i.prototype[r]=l,Object.assign(i.prototype[r],s),s.originalName&&!Jp(s.originalName)&&(i.prototype[s.originalName]=i.prototype[r])}),i.service=n,i.serviceName=e,i}Do.makeClientConstructor=kE;function dF(n,e,t,i){return function(...r){return n.call(this,e,t,i,...r)}}function uF(n){return"format"in n}function hF(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t],r=t.split(".");if(r.some(a=>Jp(a)))continue;let s=r[r.length-1],o=e;for(let a of r.slice(0,-1))o[a]||(o[a]={}),o=o[a];uF(i)?o[s]=i:o[s]=kE(i,s,{})}return e}Do.loadPackageDefinition=hF});var ZE=A((mW,XE)=>{"use strict";var fF=1/0,mF="[object Symbol]",pF=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,gF=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xd="\\ud800-\\udfff",FE="\\u0300-\\u036f\\ufe20-\\ufe23",PE="\\u20d0-\\u20f0",LE="\\u2700-\\u27bf",BE="a-z\\xdf-\\xf6\\xf8-\\xff",bF="\\xac\\xb1\\xd7\\xf7",yF="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vF="\\u2000-\\u206f",_F=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",VE="A-Z\\xc0-\\xd6\\xd8-\\xde",zE="\\ufe0e\\ufe0f",qE=bF+yF+vF+_F,ng="['\u2019]",xF="["+Xd+"]",IE="["+qE+"]",Yd="["+FE+PE+"]",UE="\\d+",wF="["+LE+"]",jE="["+BE+"]",GE="[^"+Xd+qE+UE+LE+BE+VE+"]",tg="\\ud83c[\\udffb-\\udfff]",EF="(?:"+Yd+"|"+tg+")",HE="[^"+Xd+"]",ig="(?:\\ud83c[\\udde6-\\uddff]){2}",rg="[\\ud800-\\udbff][\\udc00-\\udfff]",Mo="["+VE+"]",$E="\\u200d",AE="(?:"+jE+"|"+GE+")",TF="(?:"+Mo+"|"+GE+")",DE="(?:"+ng+"(?:d|ll|m|re|s|t|ve))?",ME="(?:"+ng+"(?:D|LL|M|RE|S|T|VE))?",WE=EF+"?",KE="["+zE+"]?",CF="(?:"+$E+"(?:"+[HE,ig,rg].join("|")+")"+KE+WE+")*",QE=KE+WE+CF,SF="(?:"+[wF,ig,rg].join("|")+")"+QE,kF="(?:"+[HE+Yd+"?",Yd,ig,rg,xF].join("|")+")",IF=RegExp(ng,"g"),AF=RegExp(Yd,"g"),DF=RegExp(tg+"(?="+tg+")|"+kF+QE,"g"),MF=RegExp([Mo+"?"+jE+"+"+DE+"(?="+[IE,Mo,"$"].join("|")+")",TF+"+"+ME+"(?="+[IE,Mo+AE,"$"].join("|")+")",Mo+"?"+AE+"+"+DE,Mo+"+"+ME,UE,SF].join("|"),"g"),RF=RegExp("["+$E+Xd+FE+PE+zE+"]"),NF=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,OF={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},FF=typeof global=="object"&&global&&global.Object===Object&&global,PF=typeof self=="object"&&self&&self.Object===Object&&self,LF=FF||PF||Function("return this")();function BF(n,e,t,i){var r=-1,s=n?n.length:0;for(i&&s&&(t=n[++r]);++r<s;)t=e(t,n[r],r,n);return t}function VF(n){return n.split("")}function zF(n){return n.match(pF)||[]}function qF(n){return function(e){return n?.[e]}}var UF=qF(OF);function YE(n){return RF.test(n)}function jF(n){return NF.test(n)}function GF(n){return YE(n)?HF(n):VF(n)}function HF(n){return n.match(DF)||[]}function $F(n){return n.match(MF)||[]}var WF=Object.prototype,KF=WF.toString,RE=LF.Symbol,NE=RE?RE.prototype:void 0,OE=NE?NE.toString:void 0;function QF(n,e,t){var i=-1,r=n.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=n[i+e];return s}function YF(n){if(typeof n=="string")return n;if(tP(n))return OE?OE.call(n):"";var e=n+"";return e=="0"&&1/n==-fF?"-0":e}function XF(n,e,t){var i=n.length;return t=t===void 0?i:t,!e&&t>=i?n:QF(n,e,t)}function ZF(n){return function(e){e=Zd(e);var t=YE(e)?GF(e):void 0,i=t?t[0]:e.charAt(0),r=t?XF(t,1).join(""):e.slice(1);return i[n]()+r}}function JF(n){return function(e){return BF(oP(rP(e).replace(IF,"")),n,"")}}function eP(n){return!!n&&typeof n=="object"}function tP(n){return typeof n=="symbol"||eP(n)&&KF.call(n)==mF}function Zd(n){return n==null?"":YF(n)}var nP=JF(function(n,e,t){return e=e.toLowerCase(),n+(t?iP(e):e)});function iP(n){return sP(Zd(n).toLowerCase())}function rP(n){return n=Zd(n),n&&n.replace(gF,UF).replace(AF,"")}var sP=ZF("toUpperCase");function oP(n,e,t){return n=Zd(n),e=t?void 0:e,e===void 0?jF(n)?$F(n):zF(n):n.match(e)||[]}XE.exports=nP});var sg=A((pW,JE)=>{"use strict";JE.exports=aP;function aP(n,e){for(var t=new Array(arguments.length-1),i=0,r=2,s=!0;r<arguments.length;)t[i++]=arguments[r++];return new Promise(function(a,c){t[i]=function(d){if(s)if(s=!1,d)c(d);else{for(var u=new Array(arguments.length-1),f=0;f<u.length;)u[f++]=arguments[f];a.apply(null,u)}};try{n.apply(e||null,t)}catch(l){s&&(s=!1,c(l))}})}});var iT=A(nT=>{"use strict";var Jd=nT;Jd.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Ro=new Array(64),tT=new Array(123);for(Pn=0;Pn<64;)tT[Ro[Pn]=Pn<26?Pn+65:Pn<52?Pn+71:Pn<62?Pn-4:Pn-59|43]=Pn++;var Pn;Jd.encode=function(e,t,i){for(var r=null,s=[],o=0,a=0,c;t<i;){var l=e[t++];switch(a){case 0:s[o++]=Ro[l>>2],c=(l&3)<<4,a=1;break;case 1:s[o++]=Ro[c|l>>4],c=(l&15)<<2,a=2;break;case 2:s[o++]=Ro[c|l>>6],s[o++]=Ro[l&63],a=0;break}o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Ro[c],s[o++]=61,a===1&&(s[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var eT="invalid encoding";Jd.decode=function(e,t,i){for(var r=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=tT[c])===void 0)throw Error(eT);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(eT);return i-r};Jd.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var sT=A((bW,rT)=>{"use strict";rT.exports=eu;function eu(){this._listeners={}}eu.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};eu.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this};eu.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}});var hT=A((yW,uT)=>{"use strict";uT.exports=oT(oT);function oT(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function r(c,l,d){e[0]=c,l[d]=t[0],l[d+1]=t[1],l[d+2]=t[2],l[d+3]=t[3]}function s(c,l,d){e[0]=c,l[d]=t[3],l[d+1]=t[2],l[d+2]=t[1],l[d+3]=t[0]}n.writeFloatLE=i?r:s,n.writeFloatBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],e[0]}function a(c,l){return t[3]=c[l],t[2]=c[l+1],t[1]=c[l+2],t[0]=c[l+3],e[0]}n.readFloatLE=i?o:a,n.readFloatBE=i?a:o}():function(){function e(i,r,s,o){var a=r<0?1:0;if(a&&(r=-r),r===0)i(1/r>0?0:2147483648,s,o);else if(isNaN(r))i(2143289344,s,o);else if(r>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(r<11754943508222875e-54)i((a<<31|Math.round(r/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(r)/Math.LN2),l=Math.round(r*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|l)>>>0,s,o)}}n.writeFloatLE=e.bind(null,aT),n.writeFloatBE=e.bind(null,cT);function t(i,r,s){var o=i(r,s),a=(o>>31)*2+1,c=o>>>23&255,l=o&8388607;return c===255?l?NaN:a*(1/0):c===0?a*1401298464324817e-60*l:a*Math.pow(2,c-150)*(l+8388608)}n.readFloatLE=t.bind(null,lT),n.readFloatBE=t.bind(null,dT)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function r(c,l,d){e[0]=c,l[d]=t[0],l[d+1]=t[1],l[d+2]=t[2],l[d+3]=t[3],l[d+4]=t[4],l[d+5]=t[5],l[d+6]=t[6],l[d+7]=t[7]}function s(c,l,d){e[0]=c,l[d]=t[7],l[d+1]=t[6],l[d+2]=t[5],l[d+3]=t[4],l[d+4]=t[3],l[d+5]=t[2],l[d+6]=t[1],l[d+7]=t[0]}n.writeDoubleLE=i?r:s,n.writeDoubleBE=i?s:r;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],t[4]=c[l+4],t[5]=c[l+5],t[6]=c[l+6],t[7]=c[l+7],e[0]}function a(c,l){return t[7]=c[l],t[6]=c[l+1],t[5]=c[l+2],t[4]=c[l+3],t[3]=c[l+4],t[2]=c[l+5],t[1]=c[l+6],t[0]=c[l+7],e[0]}n.readDoubleLE=i?o:a,n.readDoubleBE=i?a:o}():function(){function e(i,r,s,o,a,c){var l=o<0?1:0;if(l&&(o=-o),o===0)i(0,a,c+r),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+r),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+r),i((l<<31|2146435072)>>>0,a,c+s);else{var d;if(o<22250738585072014e-324)d=o/5e-324,i(d>>>0,a,c+r),i((l<<31|d/4294967296)>>>0,a,c+s);else{var u=Math.floor(Math.log(o)/Math.LN2);u===1024&&(u=1023),d=o*Math.pow(2,-u),i(d*4503599627370496>>>0,a,c+r),i((l<<31|u+1023<<20|d*1048576&1048575)>>>0,a,c+s)}}}n.writeDoubleLE=e.bind(null,aT,0,4),n.writeDoubleBE=e.bind(null,cT,4,0);function t(i,r,s,o,a){var c=i(o,a+r),l=i(o,a+s),d=(l>>31)*2+1,u=l>>>20&2047,f=4294967296*(l&1048575)+c;return u===2047?f?NaN:d*(1/0):u===0?d*5e-324*f:d*Math.pow(2,u-1075)*(f+4503599627370496)}n.readDoubleLE=t.bind(null,lT,0,4),n.readDoubleBE=t.bind(null,dT,4,0)}(),n}function aT(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function cT(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function lT(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function dT(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var og=A((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var mT=A(fT=>{"use strict";var ag=fT;ag.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)i=e.charCodeAt(r),i<128?t+=1:i<2048?t+=2:(i&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320?(++r,t+=4):t+=3;return t};ag.read=function(e,t,i){var r=i-t;if(r<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};ag.write=function(e,t,i){for(var r=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-r}});var gT=A((_W,pT)=>{"use strict";pT.exports=cP;function cP(n,e,t){var i=t||8192,r=i>>>1,s=null,o=i;return function(c){if(c<1||c>r)return n(c);o+c>i&&(s=n(i),o=0);var l=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),l}}});var yT=A((xW,bT)=>{"use strict";bT.exports=Tt;var yc=li();function Tt(n,e){this.lo=n>>>0,this.hi=e>>>0}var ps=Tt.zero=new Tt(0,0);ps.toNumber=function(){return 0};ps.zzEncode=ps.zzDecode=function(){return this};ps.length=function(){return 1};var lP=Tt.zeroHash="\0\0\0\0\0\0\0\0";Tt.fromNumber=function(e){if(e===0)return ps;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new Tt(i,r)};Tt.from=function(e){if(typeof e=="number")return Tt.fromNumber(e);if(yc.isString(e))if(yc.Long)e=yc.Long.fromString(e);else return Tt.fromNumber(parseInt(e,10));return e.low||e.high?new Tt(e.low>>>0,e.high>>>0):ps};Tt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Tt.prototype.toLong=function(e){return yc.Long?new yc.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var mr=String.prototype.charCodeAt;Tt.fromHash=function(e){return e===lP?ps:new Tt((mr.call(e,0)|mr.call(e,1)<<8|mr.call(e,2)<<16|mr.call(e,3)<<24)>>>0,(mr.call(e,4)|mr.call(e,5)<<8|mr.call(e,6)<<16|mr.call(e,7)<<24)>>>0)};Tt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Tt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Tt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Tt.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var li=A(cg=>{"use strict";var Y=cg;Y.asPromise=sg();Y.base64=iT();Y.EventEmitter=sT();Y.float=hT();Y.inquire=og();Y.utf8=mT();Y.pool=gT();Y.LongBits=yT();Y.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);Y.global=Y.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||cg;Y.emptyArray=Object.freeze?Object.freeze([]):[];Y.emptyObject=Object.freeze?Object.freeze({}):{};Y.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Y.isString=function(e){return typeof e=="string"||e instanceof String};Y.isObject=function(e){return e&&typeof e=="object"};Y.isset=Y.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};Y.Buffer=function(){try{var n=Y.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();Y._Buffer_from=null;Y._Buffer_allocUnsafe=null;Y.newBuffer=function(e){return typeof e=="number"?Y.Buffer?Y._Buffer_allocUnsafe(e):new Y.Array(e):Y.Buffer?Y._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};Y.Array=typeof Uint8Array<"u"?Uint8Array:Array;Y.Long=Y.global.dcodeIO&&Y.global.dcodeIO.Long||Y.global.Long||Y.inquire("long");Y.key2Re=/^true|false|0|1$/;Y.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Y.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Y.longToHash=function(e){return e?Y.LongBits.from(e).toHash():Y.LongBits.zeroHash};Y.longFromHash=function(e,t){var i=Y.LongBits.fromHash(e);return Y.Long?Y.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)};function vT(n,e,t){for(var i=Object.keys(e),r=0;r<i.length;++r)(n[i[r]]===void 0||!t)&&(n[i[r]]=e[i[r]]);return n}Y.merge=vT;Y.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function _T(n){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&vT(this,i)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}Y.newError=_T;Y.ProtocolError=_T("ProtocolError");Y.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var r=Object.keys(this),s=r.length-1;s>-1;--s)if(t[r[s]]===1&&this[r[s]]!==void 0&&this[r[s]]!==null)return r[s]}};Y.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};Y.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Y._configure=function(){var n=Y.Buffer;if(!n){Y._Buffer_from=Y._Buffer_allocUnsafe=null;return}Y._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,i){return new n(t,i)},Y._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var nu=A((EW,TT)=>{"use strict";TT.exports=ge;var En=li(),lg,tu=En.LongBits,xT=En.base64,wT=En.utf8;function vc(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function ug(){}function dP(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function ge(){this.len=0,this.head=new vc(ug,0,0),this.tail=this.head,this.states=null}var ET=function(){return En.Buffer?function(){return(ge.create=function(){return new lg})()}:function(){return new ge}};ge.create=ET();ge.alloc=function(e){return new En.Array(e)};En.Array!==Array&&(ge.alloc=En.pool(ge.alloc,En.Array.prototype.subarray));ge.prototype._push=function(e,t,i){return this.tail=this.tail.next=new vc(e,t,i),this.len+=t,this};function hg(n,e,t){e[t]=n&255}function uP(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function fg(n,e){this.len=n,this.next=void 0,this.val=e}fg.prototype=Object.create(vc.prototype);fg.prototype.fn=uP;ge.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new fg((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ge.prototype.int32=function(e){return e<0?this._push(mg,10,tu.fromNumber(e)):this.uint32(e)};ge.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function mg(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}ge.prototype.uint64=function(e){var t=tu.from(e);return this._push(mg,t.length(),t)};ge.prototype.int64=ge.prototype.uint64;ge.prototype.sint64=function(e){var t=tu.from(e).zzEncode();return this._push(mg,t.length(),t)};ge.prototype.bool=function(e){return this._push(hg,1,e?1:0)};function dg(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}ge.prototype.fixed32=function(e){return this._push(dg,4,e>>>0)};ge.prototype.sfixed32=ge.prototype.fixed32;ge.prototype.fixed64=function(e){var t=tu.from(e);return this._push(dg,4,t.lo)._push(dg,4,t.hi)};ge.prototype.sfixed64=ge.prototype.fixed64;ge.prototype.float=function(e){return this._push(En.float.writeFloatLE,4,e)};ge.prototype.double=function(e){return this._push(En.float.writeDoubleLE,8,e)};var hP=En.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};ge.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(hg,1,0);if(En.isString(e)){var i=ge.alloc(t=xT.length(e));xT.decode(e,i,0),e=i}return this.uint32(t)._push(hP,t,e)};ge.prototype.string=function(e){var t=wT.length(e);return t?this.uint32(t)._push(wT.write,t,e):this._push(hg,1,0)};ge.prototype.fork=function(){return this.states=new dP(this),this.head=this.tail=new vc(ug,0,0),this.len=0,this};ge.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new vc(ug,0,0),this.len=0),this};ge.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};ge.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};ge._configure=function(n){lg=n,ge.create=ET(),lg._configure()}});var kT=A((TW,ST)=>{"use strict";ST.exports=di;var CT=nu();(di.prototype=Object.create(CT.prototype)).constructor=di;var pr=li();function di(){CT.call(this)}di._configure=function(){di.alloc=pr._Buffer_allocUnsafe,di.writeBytesBuffer=pr.Buffer&&pr.Buffer.prototype instanceof Uint8Array&&pr.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}};di.prototype.bytes=function(e){pr.isString(e)&&(e=pr._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(di.writeBytesBuffer,t,e),this};function fP(n,e,t){n.length<40?pr.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}di.prototype.string=function(e){var t=pr.Buffer.byteLength(e);return this.uint32(t),t&&this._push(fP,t,e),this};di._configure()});var ru=A((CW,RT)=>{"use strict";RT.exports=it;var Ln=li(),gg,DT=Ln.LongBits,mP=Ln.utf8;function Bn(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function it(n){this.buf=n,this.pos=0,this.len=n.length}var IT=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new it(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new it(e);throw Error("illegal buffer")},MT=function(){return Ln.Buffer?function(t){return(it.create=function(r){return Ln.Buffer.isBuffer(r)?new gg(r):IT(r)})(t)}:IT};it.create=MT();it.prototype._slice=Ln.Array.prototype.subarray||Ln.Array.prototype.slice;it.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Bn(this,10);return e}}();it.prototype.int32=function(){return this.uint32()|0};it.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function pg(){var n=new DT(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Bn(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw Bn(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}it.prototype.bool=function(){return this.uint32()!==0};function iu(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}it.prototype.fixed32=function(){if(this.pos+4>this.len)throw Bn(this,4);return iu(this.buf,this.pos+=4)};it.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Bn(this,4);return iu(this.buf,this.pos+=4)|0};function AT(){if(this.pos+8>this.len)throw Bn(this,8);return new DT(iu(this.buf,this.pos+=4),iu(this.buf,this.pos+=4))}it.prototype.float=function(){if(this.pos+4>this.len)throw Bn(this,4);var e=Ln.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};it.prototype.double=function(){if(this.pos+8>this.len)throw Bn(this,4);var e=Ln.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};it.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw Bn(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var r=Ln.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)};it.prototype.string=function(){var e=this.bytes();return mP.read(e,0,e.length)};it.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Bn(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Bn(this);while(this.buf[this.pos++]&128);return this};it.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};it._configure=function(n){gg=n,it.create=MT(),gg._configure();var e=Ln.Long?"toLong":"toNumber";Ln.merge(it.prototype,{int64:function(){return pg.call(this)[e](!1)},uint64:function(){return pg.call(this)[e](!0)},sint64:function(){return pg.call(this).zzDecode()[e](!1)},fixed64:function(){return AT.call(this)[e](!0)},sfixed64:function(){return AT.call(this)[e](!1)}})}});var PT=A((SW,FT)=>{"use strict";FT.exports=gs;var OT=ru();(gs.prototype=Object.create(OT.prototype)).constructor=gs;var NT=li();function gs(n){OT.call(this,n)}gs._configure=function(){NT.Buffer&&(gs.prototype._slice=NT.Buffer.prototype.slice)};gs.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};gs._configure()});var BT=A((kW,LT)=>{"use strict";LT.exports=_c;var bg=li();(_c.prototype=Object.create(bg.EventEmitter.prototype)).constructor=_c;function _c(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");bg.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}_c.prototype.rpcCall=function n(e,t,i,r,s){if(!r)throw TypeError("request must be specified");var o=this;if(!s)return bg.asPromise(n,o,e,t,i,r);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(c,l){if(c)return o.emit("error",c,e),s(c);if(l===null){o.end(!0);return}if(!(l instanceof i))try{l=i[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(d){return o.emit("error",d,e),s(d)}return o.emit("data",l,e),s(null,l)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};_c.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var yg=A(VT=>{"use strict";var pP=VT;pP.Service=BT()});var vg=A((AW,zT)=>{"use strict";zT.exports={}});var jT=A(UT=>{"use strict";var tn=UT;tn.build="minimal";tn.Writer=nu();tn.BufferWriter=kT();tn.Reader=ru();tn.BufferReader=PT();tn.util=li();tn.rpc=yg();tn.roots=vg();tn.configure=qT;function qT(){tn.util._configure(),tn.Writer._configure(tn.BufferWriter),tn.Reader._configure(tn.BufferReader)}qT()});var HT=A((MW,GT)=>{"use strict";GT.exports=_g;function _g(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function i(s){if(typeof s!="string"){var o=r();if(_g.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),l=new Array(a.length),d=0;d<a.length;)c[d]=a[d],l[d]=s[a[d++]];return c[d]=o,Function.apply(null,c).apply(null,l)}return Function(o)()}for(var u=new Array(arguments.length-1),f=0;f<u.length;)u[f]=arguments[++f];if(f=0,s=s.replace(/%([%dfijs])/g,function(E,T){var S=u[f++];switch(T){case"d":case"f":return String(Number(S));case"i":return String(Math.floor(S));case"j":return JSON.stringify(S);case"s":return String(S)}return"%"}),f!==u.length)throw Error("parameter count mismatch");return t.push(s),i}function r(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return i.toString=r,i}_g.verbose=!1});var WT=A((RW,$T)=>{"use strict";$T.exports=xc;var gP=sg(),bP=og(),xg=bP("fs");function xc(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&xg&&xg.readFile?xg.readFile(n,function(r,s){return r&&typeof XMLHttpRequest<"u"?xc.xhr(n,e,t):r?t(r):t(null,e.binary?s:s.toString("utf8"))}):xc.xhr(n,e,t):gP(xc,this,n,e)}xc.xhr=function(e,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return i(Error("status "+r.status));if(t.binary){var o=r.response;if(!o){o=[];for(var a=0;a<r.responseText.length;++a)o.push(r.responseText.charCodeAt(a)&255)}return i(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return i(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}});var YT=A(QT=>{"use strict";var Eg=QT,KT=Eg.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},wg=Eg.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),i=KT(e),r="";i&&(r=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):i?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return r+t.join("/")};Eg.resolve=function(e,t,i){return i||(t=wg(t)),KT(t)?t:(i||(e=wg(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?wg(e+"/"+t):t)}});var bs=A(XT=>{"use strict";var wc=XT,yP=Ct(),vP=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Ec(n,e){var t=0,i={};for(e|=0;t<n.length;)i[vP[t+e]]=n[t++];return i}wc.basic=Ec([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);wc.defaults=Ec([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",yP.emptyArray,null]);wc.long=Ec([0,0,0,1,1],7);wc.mapKey=Ec([0,0,0,5,5,0,0,0,1,1,0,2],2);wc.packed=Ec([1,5,0,0,0,5,5,0,0,0,1,1,0])});var gr=A((FW,eC)=>{"use strict";eC.exports=Tn;var su=ys();((Tn.prototype=Object.create(su.prototype)).constructor=Tn).className="Field";var ZT=Vn(),JT=bs(),mt=Ct(),Tg,_P=/^required|optional|repeated$/;Tn.fromJSON=function(e,t){return new Tn(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Tn(n,e,t,i,r,s,o){if(mt.isObject(i)?(o=r,s=i,i=r=void 0):mt.isObject(r)&&(o=s,s=r,r=void 0),su.call(this,n,s),!mt.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!mt.isString(t))throw TypeError("type must be a string");if(i!==void 0&&!_P.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==void 0&&!mt.isString(r))throw TypeError("extend must be a string");i==="proto3_optional"&&(i="optional"),this.rule=i&&i!=="optional"?i:void 0,this.type=t,this.id=e,this.extend=r||void 0,this.required=i==="required",this.optional=!this.required,this.repeated=i==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=mt.Long?JT.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(Tn.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Tn.prototype.setOption=function(e,t,i){return e==="packed"&&(this._packed=null),su.prototype.setOption.call(this,e,t,i)};Tn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return mt.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Tn.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=JT.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Tg?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof ZT&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof ZT))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=mt.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;mt.base64.test(this.typeDefault)?mt.base64.decode(this.typeDefault,e=mt.newBuffer(mt.base64.length(this.typeDefault)),0):mt.utf8.write(this.typeDefault,e=mt.newBuffer(mt.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=mt.emptyObject:this.repeated?this.defaultValue=mt.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Tg&&(this.parent.ctor.prototype[this.name]=this.defaultValue),su.prototype.resolve.call(this)};Tn.d=function(e,t,i,r){return typeof t=="function"?t=mt.decorateType(t).name:t&&typeof t=="object"&&(t=mt.decorateEnum(t).name),function(o,a){mt.decorateType(o.constructor).add(new Tn(a,e,t,i,{default:r}))}};Tn._configure=function(e){Tg=e}});var No=A((PW,iC)=>{"use strict";iC.exports=Cn;var au=ys();((Cn.prototype=Object.create(au.prototype)).constructor=Cn).className="OneOf";var tC=gr(),ou=Ct();function Cn(n,e,t,i){if(Array.isArray(e)||(t=e,e=void 0),au.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=i}Cn.fromJSON=function(e,t){return new Cn(e,t.oneof,t.options,t.comment)};Cn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return ou.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function nC(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}Cn.prototype.add=function(e){if(!(e instanceof tC))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,nC(this),this};Cn.prototype.remove=function(e){if(!(e instanceof tC))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Cn.prototype.onAdd=function(e){au.prototype.onAdd.call(this,e);for(var t=this,i=0;i<this.oneof.length;++i){var r=e.get(this.oneof[i]);r&&!r.partOf&&(r.partOf=t,t.fieldsArray.push(r))}nC(this)};Cn.prototype.onRemove=function(e){for(var t=0,i;t<this.fieldsArray.length;++t)(i=this.fieldsArray[t]).parent&&i.parent.remove(i);au.prototype.onRemove.call(this,e)};Cn.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(r,s){ou.decorateType(r.constructor).add(new Cn(s,e)),Object.defineProperty(r,s,{get:ou.oneOfGetter(e),set:ou.oneOfSetter(e)})}}});var Po=A((LW,aC)=>{"use strict";aC.exports=ve;var Cg=ys();((ve.prototype=Object.create(Cg.prototype)).constructor=ve).className="Namespace";var rC=gr(),cu=Ct(),xP=No(),Oo,Tc,Fo;ve.fromJSON=function(e,t){return new ve(e,t.options).addJSON(t.nested)};function sC(n,e){if(n&&n.length){for(var t={},i=0;i<n.length;++i)t[n[i].name]=n[i].toJSON(e);return t}}ve.arrayToJSON=sC;ve.isReservedId=function(e,t){if(e){for(var i=0;i<e.length;++i)if(typeof e[i]!="string"&&e[i][0]<=t&&e[i][1]>t)return!0}return!1};ve.isReservedName=function(e,t){if(e){for(var i=0;i<e.length;++i)if(e[i]===t)return!0}return!1};function ve(n,e){Cg.call(this,n,e),this.nested=void 0,this._nestedArray=null}function oC(n){return n._nestedArray=null,n}Object.defineProperty(ve.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=cu.toArray(this.nested))}});ve.prototype.toJSON=function(e){return cu.toObject(["options",this.options,"nested",sC(this.nestedArray,e)])};ve.prototype.addJSON=function(e){var t=this;if(e)for(var i=Object.keys(e),r=0,s;r<i.length;++r)s=e[i[r]],t.add((s.fields!==void 0?Oo.fromJSON:s.values!==void 0?Fo.fromJSON:s.methods!==void 0?Tc.fromJSON:s.id!==void 0?rC.fromJSON:ve.fromJSON)(i[r],s));return this};ve.prototype.get=function(e){return this.nested&&this.nested[e]||null};ve.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Fo)return this.nested[e].values;throw Error("no such enum: "+e)};ve.prototype.add=function(e){if(!(e instanceof rC&&e.extend!==void 0||e instanceof Oo||e instanceof xP||e instanceof Fo||e instanceof Tc||e instanceof ve))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof ve&&e instanceof ve&&!(t instanceof Oo||t instanceof Tc)){for(var i=t.nestedArray,r=0;r<i.length;++r)e.add(i[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),oC(this)};ve.prototype.remove=function(e){if(!(e instanceof Cg))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),oC(this)};ve.prototype.define=function(e,t){if(cu.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var i=this;e.length>0;){var r=e.shift();if(i.nested&&i.nested[r]){if(i=i.nested[r],!(i instanceof ve))throw Error("path conflicts with non-namespace objects")}else i.add(i=new ve(r))}return t&&i.addJSON(t),i};ve.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof ve?e[t++].resolveAll():e[t++].resolve();return this.resolve()};ve.prototype.lookup=function(e,t,i){if(typeof t=="boolean"?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),cu.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(e.length===1){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof ve&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof ve&&(r=this._nestedArray[s].lookup(e,t,!0)))return r;return this.parent===null||i?null:this.parent.lookup(e,t)};ve.prototype.lookupType=function(e){var t=this.lookup(e,[Oo]);if(!t)throw Error("no such type: "+e);return t};ve.prototype.lookupEnum=function(e){var t=this.lookup(e,[Fo]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};ve.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[Oo,Fo]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};ve.prototype.lookupService=function(e){var t=this.lookup(e,[Tc]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};ve._configure=function(n,e,t){Oo=n,Tc=e,Fo=t}});var lu=A((BW,cC)=>{"use strict";cC.exports=Mi;var Sg=gr();((Mi.prototype=Object.create(Sg.prototype)).constructor=Mi).className="MapField";var wP=bs(),Cc=Ct();function Mi(n,e,t,i,r,s){if(Sg.call(this,n,e,i,void 0,void 0,r,s),!Cc.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Mi.fromJSON=function(e,t){return new Mi(e,t.id,t.keyType,t.type,t.options,t.comment)};Mi.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Cc.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Mi.prototype.resolve=function(){if(this.resolved)return this;if(wP.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Sg.prototype.resolve.call(this)};Mi.d=function(e,t,i){return typeof i=="function"?i=Cc.decorateType(i).name:i&&typeof i=="object"&&(i=Cc.decorateEnum(i).name),function(s,o){Cc.decorateType(s.constructor).add(new Mi(o,e,t,i))}}});var du=A((VW,lC)=>{"use strict";lC.exports=vs;var kg=ys();((vs.prototype=Object.create(kg.prototype)).constructor=vs).className="Method";var Lo=Ct();function vs(n,e,t,i,r,s,o,a,c){if(Lo.isObject(r)?(o=r,r=s=void 0):Lo.isObject(s)&&(o=s,s=void 0),!(e===void 0||Lo.isString(e)))throw TypeError("type must be a string");if(!Lo.isString(t))throw TypeError("requestType must be a string");if(!Lo.isString(i))throw TypeError("responseType must be a string");kg.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=r?!0:void 0,this.responseType=i,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}vs.fromJSON=function(e,t){return new vs(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};vs.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Lo.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};vs.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),kg.prototype.resolve.call(this))}});var uu=A((zW,uC)=>{"use strict";uC.exports=Sn;var br=Po();((Sn.prototype=Object.create(br.prototype)).constructor=Sn).className="Service";var Ig=du(),Sc=Ct(),EP=yg();function Sn(n,e){br.call(this,n,e),this.methods={},this._methodsArray=null}Sn.fromJSON=function(e,t){var i=new Sn(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)i.add(Ig.fromJSON(r[s],t.methods[r[s]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i};Sn.prototype.toJSON=function(e){var t=br.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return Sc.toObject(["options",t&&t.options||void 0,"methods",br.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Object.defineProperty(Sn.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Sc.toArray(this.methods))}});function dC(n){return n._methodsArray=null,n}Sn.prototype.get=function(e){return this.methods[e]||br.prototype.get.call(this,e)};Sn.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return br.prototype.resolve.call(this)};Sn.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Ig?(this.methods[e.name]=e,e.parent=this,dC(this)):br.prototype.add.call(this,e)};Sn.prototype.remove=function(e){if(e instanceof Ig){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,dC(this)}return br.prototype.remove.call(this,e)};Sn.prototype.create=function(e,t,i){for(var r=new EP.Service(e,t,i),s=0,o;s<this.methodsArray.length;++s){var a=Sc.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");r[a]=Sc.codegen(["r","c"],Sc.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return r}});var hu=A((qW,hC)=>{"use strict";hC.exports=ui;var TP=li();function ui(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}ui.create=function(e){return this.$type.create(e)};ui.encode=function(e,t){return this.$type.encode(e,t)};ui.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};ui.decode=function(e){return this.$type.decode(e)};ui.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};ui.verify=function(e){return this.$type.verify(e)};ui.fromObject=function(e){return this.$type.fromObject(e)};ui.toObject=function(e,t){return this.$type.toObject(e,t)};ui.prototype.toJSON=function(){return this.$type.toObject(this,TP.toJSONOptions)}});var Ag=A((UW,mC)=>{"use strict";mC.exports=kP;var CP=Vn(),Ri=bs(),fC=Ct();function SP(n){return"missing required '"+n.name+"'"}function kP(n){var e=fC.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<n.fieldsArray.length;++t){var i=n._fieldsArray[t].resolve(),r=i.resolvedType instanceof CP?"int32":i.type,s="m"+fC.safeProp(i.name);e("case %i: {",i.id),i.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Ri.defaults[i.keyType]!==void 0?e("k=%j",Ri.defaults[i.keyType]):e("k=null"),Ri.defaults[r]!==void 0?e("value=%j",Ri.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",i.keyType)("case 2:"),Ri.basic[r]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Ri.long[i.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):i.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Ri.packed[r]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,r)("}else"),Ri.basic[r]===void 0?e(i.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,r)):Ri.basic[r]===void 0?e(i.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,r),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",SP(o))}return e("return m")}});var Rg=A((jW,pC)=>{"use strict";pC.exports=DP;var IP=Vn(),Dg=Ct();function kn(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function Mg(n,e,t,i){if(e.resolvedType)if(e.resolvedType instanceof IP){n("switch(%s){",i)("default:")("return%j",kn(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),s=0;s<r.length;++s)n("case %i:",e.resolvedType.values[r[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,i)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",i)("return%j",kn(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",kn(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',i)("return%j",kn(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',i)("return%j",kn(e,"boolean"));break;case"string":n("if(!util.isString(%s))",i)("return%j",kn(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",kn(e,"buffer"));break}return n}function AP(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",kn(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",kn(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",kn(e,"boolean key"));break}return n}function DP(n){var e=Dg.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,i={};t.length&&e("var p={}");for(var r=0;r<n.fieldsArray.length;++r){var s=n._fieldsArray[r].resolve(),o="m"+Dg.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",kn(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),AP(e,s,"k[i]"),Mg(e,s,r,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",kn(s,"array"))("for(var i=0;i<%s.length;++i){",o),Mg(e,s,r,o+"[i]")("}");else{if(s.partOf){var a=Dg.safeProp(s.partOf.name);i[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),i[s.partOf.name]=1,e("p%s=1",a)}Mg(e,s,r,o)}s.optional&&e("}")}return e("return null")}});var Fg=A(bC=>{"use strict";var gC=bC,kc=Vn(),hi=Ct();function Ng(n,e,t,i){var r=!1;if(e.resolvedType)if(e.resolvedType instanceof kc){n("switch(d%s){",i);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!r&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),e.repeated||n("break"),r=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",i,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',i)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,t,i);else{var c=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",i,i);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,c)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,c?"true":"");break;case"bytes":n('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":n("m%s=String(d%s)",i,i);break;case"bool":n("m%s=Boolean(d%s)",i,i);break}}return n}gC.fromObject=function(e){var t=e.fieldsArray,i=hi.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),o=hi.safeProp(s.name);s.map?(i("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Ng(i,s,r,o+"[ks[i]]")("}")("}")):s.repeated?(i("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Ng(i,s,r,o+"[i]")("}")("}")):(s.resolvedType instanceof kc||i("if(d%s!=null){",o),Ng(i,s,r,o),s.resolvedType instanceof kc||i("}"))}return i("return m")};function Og(n,e,t,i){if(e.resolvedType)e.resolvedType instanceof kc?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,t,i,i,t,i,i):n("d%s=types[%i].toObject(m%s,o)",i,t,i);else{var r=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,r?"true":"",i);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:n("d%s=m%s",i,i);break}}return n}gC.toObject=function(e){var t=e.fieldsArray.slice().sort(hi.compareFieldsById);if(!t.length)return hi.codegen()("return {}");for(var i=hi.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?r:t[a].map?s:o).push(t[a]);if(r.length){for(i("if(o.arrays||o.defaults){"),a=0;a<r.length;++a)i("d%s=[]",hi.safeProp(r[a].name));i("}")}if(s.length){for(i("if(o.objects||o.defaults){"),a=0;a<s.length;++a)i("d%s={}",hi.safeProp(s[a].name));i("}")}if(o.length){for(i("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],l=hi.safeProp(c.name);if(c.resolvedType instanceof kc)i("d%s=o.enums===String?%j:%j",l,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var d="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",l,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else i("d%s=%j",l,c.typeDefault)}i("}")}var u=!1;for(a=0;a<t.length;++a){var c=t[a],f=e._fieldsArray.indexOf(c),l=hi.safeProp(c.name);c.map?(u||(u=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),Og(i,c,f,l+"[ks2[j]]")("}")):c.repeated?(i("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),Og(i,c,f,l+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",l,c.name),Og(i,c,f,l),c.partOf&&i("if(o.oneofs)")("d%s=%j",hi.safeProp(c.partOf.name),c.name)),i("}")}return i("return d")}});var Pg=A(yC=>{"use strict";var MP=yC,RP=hu();MP[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var i=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return i.indexOf("/")===-1&&(i="/"+i),this.create({type_url:i,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",i="",r="";if(e&&e.json&&n.type_url&&n.value){r=n.type_url.substring(n.type_url.lastIndexOf("/")+1),i=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(r);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof RP){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return i===""&&(i=t),r=i+a,o["@type"]=r,o}return this.toObject(n,e)}}});var pu=A(($W,_C)=>{"use strict";_C.exports=Ne;var zn=Po();((Ne.prototype=Object.create(zn.prototype)).constructor=Ne).className="Type";var NP=Vn(),Vg=No(),fu=gr(),OP=lu(),FP=uu(),Lg=hu(),Bg=ru(),PP=nu(),Ot=Ct(),LP=zg(),BP=Ag(),VP=Rg(),vC=Fg(),zP=Pg();function Ne(n,e){zn.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Ne.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],i=t.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Ot.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Ot.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Ne.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Lg||((n.prototype=new Lg).constructor=n,Ot.merge(n.prototype,e)),n.$type=n.prototype.$type=this,Ot.merge(n,Lg,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var i={};for(t=0;t<this.oneofsArray.length;++t)i[this._oneofsArray[t].resolve().name]={get:Ot.oneOfGetter(this._oneofsArray[t].oneof),set:Ot.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,i)}}});Ne.generateConstructor=function(e){for(var t=Ot.codegen(["p"],e.name),i=0,r;i<e.fieldsArray.length;++i)(r=e._fieldsArray[i]).map?t("this%s={}",Ot.safeProp(r.name)):r.repeated&&t("this%s=[]",Ot.safeProp(r.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function mu(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}Ne.fromJSON=function(e,t){var i=new Ne(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var r=Object.keys(t.fields),s=0;s<r.length;++s)i.add((typeof t.fields[r[s]].keyType<"u"?OP.fromJSON:fu.fromJSON)(r[s],t.fields[r[s]]));if(t.oneofs)for(r=Object.keys(t.oneofs),s=0;s<r.length;++s)i.add(Vg.fromJSON(r[s],t.oneofs[r[s]]));if(t.nested)for(r=Object.keys(t.nested),s=0;s<r.length;++s){var o=t.nested[r[s]];i.add((o.id!==void 0?fu.fromJSON:o.fields!==void 0?Ne.fromJSON:o.values!==void 0?NP.fromJSON:o.methods!==void 0?FP.fromJSON:zn.fromJSON)(r[s],o))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i};Ne.prototype.toJSON=function(e){var t=zn.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return Ot.toObject(["options",t&&t.options||void 0,"oneofs",zn.arrayToJSON(this.oneofsArray,e),"fields",zn.arrayToJSON(this.fieldsArray.filter(function(r){return!r.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])};Ne.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return zn.prototype.resolveAll.call(this)};Ne.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Ne.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof fu&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),mu(this)}return e instanceof Vg?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),mu(this)):zn.prototype.add.call(this,e)};Ne.prototype.remove=function(e){if(e instanceof fu&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),mu(this)}if(e instanceof Vg){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),mu(this)}return zn.prototype.remove.call(this,e)};Ne.prototype.isReservedId=function(e){return zn.isReservedId(this.reserved,e)};Ne.prototype.isReservedName=function(e){return zn.isReservedName(this.reserved,e)};Ne.prototype.create=function(e){return new this.ctor(e)};Ne.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=LP(this)({Writer:PP,types:t,util:Ot}),this.decode=BP(this)({Reader:Bg,types:t,util:Ot}),this.verify=VP(this)({types:t,util:Ot}),this.fromObject=vC.fromObject(this)({types:t,util:Ot}),this.toObject=vC.toObject(this)({types:t,util:Ot});var r=zP[e];if(r){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(s),s.toObject=this.toObject,this.toObject=r.toObject.bind(s)}return this};Ne.prototype.encode=function(e,t){return this.setup().encode(e,t)};Ne.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};Ne.prototype.decode=function(e,t){return this.setup().decode(e,t)};Ne.prototype.decodeDelimited=function(e){return e instanceof Bg||(e=Bg.create(e)),this.decode(e,e.uint32())};Ne.prototype.verify=function(e){return this.setup().verify(e)};Ne.prototype.fromObject=function(e){return this.setup().fromObject(e)};Ne.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};Ne.d=function(e){return function(i){Ot.decorateType(i,e)}}});var yu=A((WW,CC)=>{"use strict";CC.exports=un;var bu=Po();((un.prototype=Object.create(bu.prototype)).constructor=un).className="Root";var Ug=gr(),wC=Vn(),qP=No(),yr=Ct(),EC,qg,Ic;function un(n){bu.call(this,"",n),this.deferred=[],this.files=[]}un.fromJSON=function(e,t){return t||(t=new un),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};un.prototype.resolvePath=yr.path.resolve;un.prototype.fetch=yr.fetch;function TC(){}un.prototype.load=function n(e,t,i){typeof t=="function"&&(i=t,t=void 0);var r=this;if(!i)return yr.asPromise(n,r,e,t);var s=i===TC;function o(b,E){if(i){if(s)throw b;var T=i;i=null,T(b,E)}}function a(b){var E=b.lastIndexOf("google/protobuf/");if(E>-1){var T=b.substring(E);if(T in Ic)return T}return null}function c(b,E){try{if(yr.isString(E)&&E.charAt(0)==="{"&&(E=JSON.parse(E)),!yr.isString(E))r.setOptions(E.options).addJSON(E.nested);else{qg.filename=b;var T=qg(E,r,t),S,M=0;if(T.imports)for(;M<T.imports.length;++M)(S=a(T.imports[M])||r.resolvePath(b,T.imports[M]))&&l(S);if(T.weakImports)for(M=0;M<T.weakImports.length;++M)(S=a(T.weakImports[M])||r.resolvePath(b,T.weakImports[M]))&&l(S,!0)}}catch(I){o(I)}!s&&!d&&o(null,r)}function l(b,E){if(b=a(b)||b,!(r.files.indexOf(b)>-1)){if(r.files.push(b),b in Ic){s?c(b,Ic[b]):(++d,setTimeout(function(){--d,c(b,Ic[b])}));return}if(s){var T;try{T=yr.fs.readFileSync(b).toString("utf8")}catch(S){E||o(S);return}c(b,T)}else++d,r.fetch(b,function(S,M){if(--d,!!i){if(S){E?d||o(null,r):o(S);return}c(b,M)}})}}var d=0;yr.isString(e)&&(e=[e]);for(var u=0,f;u<e.length;++u)(f=r.resolvePath("",e[u]))&&l(f);if(s)return r;d||o(null,r)};un.prototype.loadSync=function(e,t){if(!yr.isNode)throw Error("not supported");return this.load(e,t,TC)};un.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return bu.prototype.resolveAll.call(this)};var gu=/^[A-Z]/;function xC(n,e){var t=e.parent.lookup(e.extend);if(t){var i=new Ug(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(i.name)||(i.declaringField=e,e.extensionField=i,t.add(i)),!0}return!1}un.prototype._handleAdd=function(e){if(e instanceof Ug)e.extend!==void 0&&!e.extensionField&&(xC(this,e)||this.deferred.push(e));else if(e instanceof wC)gu.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof qP)){if(e instanceof EC)for(var t=0;t<this.deferred.length;)xC(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);gu.test(e.name)&&(e.parent[e.name]=e)}};un.prototype._handleRemove=function(e){if(e instanceof Ug){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof wC)gu.test(e.name)&&delete e.parent[e.name];else if(e instanceof bu){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);gu.test(e.name)&&delete e.parent[e.name]}};un._configure=function(n,e,t){EC=n,qg=e,Ic=t}});var Ct=A((KW,kC)=>{"use strict";var rt=kC.exports=li(),SC=vg(),jg,Gg;rt.codegen=HT();rt.fetch=WT();rt.path=YT();rt.fs=rt.inquire("fs");rt.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),r=0;r<t.length;)i[r]=e[t[r++]];return i}return[]};rt.toObject=function(e){for(var t={},i=0;i<e.length;){var r=e[i++],s=e[i++];s!==void 0&&(t[r]=s)}return t};var UP=/\\/g,jP=/"/g;rt.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};rt.safeProp=function(e){return!/^[$\w_]+$/.test(e)||rt.isReserved(e)?'["'+e.replace(UP,"\\\\").replace(jP,'\\"')+'"]':"."+e};rt.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var GP=/_([a-z])/g;rt.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(GP,function(t,i){return i.toUpperCase()})};rt.compareFieldsById=function(e,t){return e.id-t.id};rt.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(rt.decorateRoot.remove(e.$type),e.$type.name=t,rt.decorateRoot.add(e.$type)),e.$type;jg||(jg=pu());var i=new jg(t||e.name);return rt.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var HP=0;rt.decorateEnum=function(e){if(e.$type)return e.$type;Gg||(Gg=Vn());var t=new Gg("Enum"+HP++,e);return rt.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};rt.setProperty=function(e,t,i){function r(s,o,a){var c=o.shift();if(c==="__proto__"||c==="prototype")return s;if(o.length>0)s[c]=r(s[c]||{},o,a);else{var l=s[c];l&&(a=[].concat(l).concat(a)),s[c]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),r(e,t,i)};Object.defineProperty(rt,"decorateRoot",{get:function(){return SC.decorated||(SC.decorated=new(yu()))}})});var ys=A((QW,IC)=>{"use strict";IC.exports=hn;hn.className="ReflectionObject";var vu=Ct(),_u;function hn(n,e){if(!vu.isString(n))throw TypeError("name must be a string");if(e&&!vu.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(hn.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});hn.prototype.toJSON=function(){throw Error()};hn.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof _u&&t._handleAdd(this)};hn.prototype.onRemove=function(e){var t=e.root;t instanceof _u&&t._handleRemove(this),this.parent=null,this.resolved=!1};hn.prototype.resolve=function(){return this.resolved?this:(this.root instanceof _u&&(this.resolved=!0),this)};hn.prototype.getOption=function(e){if(this.options)return this.options[e]};hn.prototype.setOption=function(e,t,i){return(!i||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};hn.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(i){var s=r.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];vu.setProperty(o,i,t)}else s={},s[e]=vu.setProperty({},i,t),r.push(s)}else{var a={};a[e]=t,r.push(a)}return this};hn.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),r=0;r<i.length;++r)this.setOption(i[r],e[i[r]],t);return this};hn.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};hn._configure=function(n){_u=n}});var Vn=A((YW,MC)=>{"use strict";MC.exports=fi;var AC=ys();((fi.prototype=Object.create(AC.prototype)).constructor=fi).className="Enum";var DC=Po(),xu=Ct();function fi(n,e,t,i,r,s){if(AC.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=r||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}fi.fromJSON=function(e,t){var i=new fi(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i};fi.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return xu.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};fi.prototype.add=function(e,t,i,r){if(!xu.isString(e))throw TypeError("name must be a string");if(!xu.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=i||null,this};fi.prototype.remove=function(e){if(!xu.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};fi.prototype.isReservedId=function(e){return DC.isReservedId(this.reserved,e)};fi.prototype.isReservedName=function(e){return DC.isReservedName(this.reserved,e)}});var zg=A((XW,NC)=>{"use strict";NC.exports=WP;var $P=Vn(),Hg=bs(),$g=Ct();function RC(n,e,t,i){return e.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,i,(e.id<<3|2)>>>0)}function WP(n){for(var e=$g.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,i,r=n.fieldsArray.slice().sort($g.compareFieldsById),t=0;t<r.length;++t){var s=r[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof $P?"int32":s.type,c=Hg.basic[a];i="m"+$g.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",i,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",i)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Hg.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,i):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,i),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",i,i),s.packed&&Hg.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",i)("w.%s(%s[i])",a,i)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",i),c===void 0?RC(e,s,o,i+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,i)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",i,s.name),c===void 0?RC(e,s,o,i):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,i))}return e("return w")}});var FC=A((ZW,OC)=>{"use strict";var he=OC.exports=jT();he.build="light";function KP(n,e,t){return typeof e=="function"?(t=e,e=new he.Root):e||(e=new he.Root),e.load(n,t)}he.load=KP;function QP(n,e){return e||(e=new he.Root),e.loadSync(n)}he.loadSync=QP;he.encoder=zg();he.decoder=Ag();he.verifier=Rg();he.converter=Fg();he.ReflectionObject=ys();he.Namespace=Po();he.Root=yu();he.Enum=Vn();he.Type=pu();he.Field=gr();he.OneOf=No();he.MapField=lu();he.Service=uu();he.Method=du();he.Message=hu();he.wrappers=Pg();he.types=bs();he.util=Ct();he.ReflectionObject._configure(he.Root);he.Namespace._configure(he.Type,he.Service,he.Enum);he.Root._configure(he.Type);he.Field._configure(he.Type)});var Kg=A((JW,BC)=>{"use strict";BC.exports=LC;var Wg=/[\s{}=;:[\],'"()<>]/g,YP=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,XP=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,ZP=/^ *[*/]+ */,JP=/^\s*\*?\/*/,eL=/\n/g,tL=/\s/,nL=/\\(.?)/g,iL={0:"\0",r:"\r",n:`
`,t:"	"};function PC(n){return n.replace(nL,function(e,t){switch(t){case"\\":case"":return t;default:return iL[t]||""}})}LC.unescape=PC;function LC(n,e){n=n.toString();var t=0,i=n.length,r=1,s=0,o={},a=[],c=null;function l(P){return Error("illegal "+P+" (line "+r+")")}function d(){var P=c==="'"?XP:YP;P.lastIndex=t-1;var G=P.exec(n);if(!G)throw l("string");return t=P.lastIndex,S(c),c=null,PC(G[1])}function u(P){return n.charAt(P)}function f(P,G,J){var _={type:n.charAt(P++),lineEmpty:!1,leading:J},g;e?g=2:g=3;var y=P-g,v;do if(--y<0||(v=n.charAt(y))===`
`){_.lineEmpty=!0;break}while(v===" "||v==="	");for(var m=n.substring(P,G).split(eL),x=0;x<m.length;++x)m[x]=m[x].replace(e?JP:ZP,"").trim();_.text=m.join(`
`).trim(),o[r]=_,s=r}function b(P){var G=E(P),J=n.substring(P,G),_=/^\s*\/\//.test(J);return _}function E(P){for(var G=P;G<i&&u(G)!==`
`;)G++;return G}function T(){if(a.length>0)return a.shift();if(c)return d();var P,G,J,_,g,y=t===0;do{if(t===i)return null;for(P=!1;tL.test(J=u(t));)if(J===`
`&&(y=!0,++r),++t===i)return null;if(u(t)==="/"){if(++t===i)throw l("comment");if(u(t)==="/")if(e){if(_=t,g=!1,b(t-1)){g=!0;do if(t=E(t),t===i||(t++,!y))break;while(b(t))}else t=Math.min(i,E(t)+1);g&&(f(_,t,y),y=!0),r++,P=!0}else{for(g=u(_=t+1)==="/";u(++t)!==`
`;)if(t===i)return null;++t,g&&(f(_,t-1,y),y=!0),++r,P=!0}else if((J=u(t))==="*"){_=t+1,g=e||u(_)==="*";do{if(J===`
`&&++r,++t===i)throw l("comment");G=J,J=u(t)}while(G!=="*"||J!=="/");++t,g&&(f(_,t-2,y),y=!0),P=!0}else return"/"}}while(P);var v=t;Wg.lastIndex=0;var m=Wg.test(u(v++));if(!m)for(;v<i&&!Wg.test(u(v));)++v;var x=n.substring(t,t=v);return(x==='"'||x==="'")&&(c=x),x}function S(P){a.push(P)}function M(){if(!a.length){var P=T();if(P===null)return null;S(P)}return a[0]}function I(P,G){var J=M(),_=J===P;if(_)return T(),!0;if(!G)throw l("token '"+J+"', '"+P+"' expected");return!1}function F(P){var G=null,J;return P===void 0?(J=o[r-1],delete o[r-1],J&&(e||J.type==="*"||J.lineEmpty)&&(G=J.leading?J.text:null)):(s<P&&M(),J=o[P],delete o[P],J&&!J.lineEmpty&&(e||J.type==="/")&&(G=J.leading?null:J.text)),G}return Object.defineProperty({next:T,peek:M,push:S,skip:I,cmnt:F},"line",{get:function(){return r}})}});var GC=A((eK,jC)=>{"use strict";jC.exports=Ni;Ni.filename=null;Ni.defaults={keepCase:!1};var rL=Kg(),VC=yu(),zC=pu(),qC=gr(),sL=lu(),UC=No(),oL=Vn(),aL=uu(),cL=du(),Qg=bs(),Yg=Ct(),lL=/^[1-9][0-9]*$/,dL=/^-?[1-9][0-9]*$/,uL=/^0[x][0-9a-fA-F]+$/,hL=/^-?0[x][0-9a-fA-F]+$/,fL=/^0[0-7]+$/,mL=/^-?0[0-7]+$/,pL=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,mi=/^[a-zA-Z_][a-zA-Z_0-9]*$/,pi=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,gL=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Ni(n,e,t){e instanceof VC||(t=e,e=new VC),t||(t=Ni.defaults);var i=t.preferTrailingComment||!1,r=rL(n,t.alternateCommentMode||!1),s=r.next,o=r.push,a=r.peek,c=r.skip,l=r.cmnt,d=!0,u,f,b,E,T=!1,S=e,M=t.keepCase?function(R){return R}:Yg.camelCase;function I(R,N,L){var Z=Ni.filename;return L||(Ni.filename=null),Error("illegal "+(N||"token")+" '"+R+"' ("+(Z?Z+", ":"")+"line "+r.line+")")}function F(){var R=[],N;do{if((N=s())!=='"'&&N!=="'")throw I(N);R.push(s()),c(N),N=a()}while(N==='"'||N==="'");return R.join("")}function P(R){var N=s();switch(N){case"'":case'"':return o(N),F();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return J(N,!0)}catch{if(R&&pi.test(N))return N;throw I(N,"value")}}function G(R,N){var L,Z;do N&&((L=a())==='"'||L==="'")?R.push(F()):R.push([Z=_(s()),c("to",!0)?_(s()):Z]);while(c(",",!0));var Q={options:void 0};Q.setOption=function(re,Ge){this.options===void 0&&(this.options={}),this.options[re]=Ge},x(Q,function(Ge){if(Ge==="option")Me(Q,Ge),c(";");else throw I(Ge)},function(){It(Q)})}function J(R,N){var L=1;switch(R.charAt(0)==="-"&&(L=-1,R=R.substring(1)),R){case"inf":case"INF":case"Inf":return L*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(lL.test(R))return L*parseInt(R,10);if(uL.test(R))return L*parseInt(R,16);if(fL.test(R))return L*parseInt(R,8);if(pL.test(R))return L*parseFloat(R);throw I(R,"number",N)}function _(R,N){switch(R){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!N&&R.charAt(0)==="-")throw I(R,"id");if(dL.test(R))return parseInt(R,10);if(hL.test(R))return parseInt(R,16);if(mL.test(R))return parseInt(R,8);throw I(R,"id")}function g(){if(u!==void 0)throw I("package");if(u=s(),!pi.test(u))throw I(u,"name");S=S.define(u),c(";")}function y(){var R=a(),N;switch(R){case"weak":N=b||(b=[]),s();break;case"public":s();default:N=f||(f=[]);break}R=F(),c(";"),N.push(R)}function v(){if(c("="),E=F(),T=E==="proto3",!T&&E!=="proto2")throw I(E,"syntax");e.setOption("syntax",E),c(";")}function m(R,N){switch(N){case"option":return Me(R,N),c(";"),!0;case"message":return h(R,N),!0;case"enum":return Ce(R,N),!0;case"service":return lt(R,N),!0;case"extend":return no(R,N),!0}return!1}function x(R,N,L){var Z=r.line;if(R&&(typeof R.comment!="string"&&(R.comment=l()),R.filename=Ni.filename),c("{",!0)){for(var Q;(Q=s())!=="}";)N(Q);c(";",!0)}else L&&L(),c(";"),R&&(typeof R.comment!="string"||i)&&(R.comment=l(Z)||R.comment)}function h(R,N){if(!mi.test(N=s()))throw I(N,"type name");var L=new zC(N);x(L,function(Q){if(!m(L,Q))switch(Q){case"map":me(L,Q);break;case"required":case"repeated":p(L,Q);break;case"optional":T?p(L,"proto3_optional"):p(L,"optional");break;case"oneof":Be(L,Q);break;case"extensions":G(L.extensions||(L.extensions=[]));break;case"reserved":G(L.reserved||(L.reserved=[]),!0);break;default:if(!T||!pi.test(Q))throw I(Q);o(Q),p(L,"optional");break}}),R.add(L)}function p(R,N,L){var Z=s();if(Z==="group"){z(R,N);return}for(;Z.endsWith(".")||a().startsWith(".");)Z+=s();if(!pi.test(Z))throw I(Z,"type");var Q=s();if(!mi.test(Q))throw I(Q,"name");Q=M(Q),c("=");var re=new qC(Q,_(s()),Z,N,L);if(x(re,function(sn){if(sn==="option")Me(re,sn),c(";");else throw I(sn)},function(){It(re)}),N==="proto3_optional"){var Ge=new UC("_"+Q);re.setOption("proto3_optional",!0),Ge.add(re),R.add(Ge)}else R.add(re);!T&&re.repeated&&(Qg.packed[Z]!==void 0||Qg.basic[Z]===void 0)&&re.setOption("packed",!1,!0)}function z(R,N){var L=s();if(!mi.test(L))throw I(L,"name");var Z=Yg.lcFirst(L);L===Z&&(L=Yg.ucFirst(L)),c("=");var Q=_(s()),re=new zC(L);re.group=!0;var Ge=new qC(Z,Q,L,N);Ge.filename=Ni.filename,x(re,function(sn){switch(sn){case"option":Me(re,sn),c(";");break;case"required":case"repeated":p(re,sn);break;case"optional":T?p(re,"proto3_optional"):p(re,"optional");break;case"message":h(re,sn);break;case"enum":Ce(re,sn);break;default:throw I(sn)}}),R.add(re).add(Ge)}function me(R){c("<");var N=s();if(Qg.mapKey[N]===void 0)throw I(N,"type");c(",");var L=s();if(!pi.test(L))throw I(L,"type");c(">");var Z=s();if(!mi.test(Z))throw I(Z,"name");c("=");var Q=new sL(M(Z),_(s()),N,L);x(Q,function(Ge){if(Ge==="option")Me(Q,Ge),c(";");else throw I(Ge)},function(){It(Q)}),R.add(Q)}function Be(R,N){if(!mi.test(N=s()))throw I(N,"name");var L=new UC(M(N));x(L,function(Q){Q==="option"?(Me(L,Q),c(";")):(o(Q),p(L,"optional"))}),R.add(L)}function Ce(R,N){if(!mi.test(N=s()))throw I(N,"name");var L=new oL(N);x(L,function(Q){switch(Q){case"option":Me(L,Q),c(";");break;case"reserved":G(L.reserved||(L.reserved=[]),!0);break;default:tt(L,Q)}}),R.add(L)}function tt(R,N){if(!mi.test(N))throw I(N,"name");c("=");var L=_(s(),!0),Z={options:void 0};Z.setOption=function(Q,re){this.options===void 0&&(this.options={}),this.options[Q]=re},x(Z,function(re){if(re==="option")Me(Z,re),c(";");else throw I(re)},function(){It(Z)}),R.add(N,L,Z.comment,Z.options)}function Me(R,N){var L=c("(",!0);if(!pi.test(N=s()))throw I(N,"name");var Z=N,Q=Z,re;L&&(c(")"),Z="("+Z+")",Q=Z,N=a(),gL.test(N)&&(re=N.slice(1),Z+=N,s())),c("=");var Ge=Vt(R,Z);Ze(R,Q,Ge,re)}function Vt(R,N){if(c("{",!0)){for(var L={};!c("}",!0);){if(!mi.test(Mt=s()))throw I(Mt,"name");if(Mt===null)throw I(Mt,"end of input");var Z,Q=Mt;if(c(":",!0),a()==="{")Z=Vt(R,N+"."+Mt);else if(a()==="["){Z=[];var re;if(c("[",!0)){do re=P(!0),Z.push(re);while(c(",",!0));c("]"),typeof re<"u"&&ct(R,N+"."+Mt,re)}}else Z=P(!0),ct(R,N+"."+Mt,Z);var Ge=L[Q];Ge&&(Z=[].concat(Ge).concat(Z)),L[Q]=Z,c(",",!0),c(";",!0)}return L}var Ki=P(!0);return ct(R,N,Ki),Ki}function ct(R,N,L){R.setOption&&R.setOption(N,L)}function Ze(R,N,L,Z){R.setParsedOption&&R.setParsedOption(N,L,Z)}function It(R){if(c("[",!0)){do Me(R,"option");while(c(",",!0));c("]")}return R}function lt(R,N){if(!mi.test(N=s()))throw I(N,"service name");var L=new aL(N);x(L,function(Q){if(!m(L,Q))if(Q==="rpc")zt(L,Q);else throw I(Q)}),R.add(L)}function zt(R,N){var L=l(),Z=N;if(!mi.test(N=s()))throw I(N,"name");var Q=N,re,Ge,Ki,sn;if(c("("),c("stream",!0)&&(Ge=!0),!pi.test(N=s())||(re=N,c(")"),c("returns"),c("("),c("stream",!0)&&(sn=!0),!pi.test(N=s())))throw I(N);Ki=N,c(")");var jl=new cL(Q,Z,re,Ki,Ge,sn);jl.comment=L,x(jl,function(om){if(om==="option")Me(jl,om),c(";");else throw I(om)}),R.add(jl)}function no(R,N){if(!pi.test(N=s()))throw I(N,"reference");var L=N;x(null,function(Q){switch(Q){case"required":case"repeated":p(R,Q,L);break;case"optional":T?p(R,"proto3_optional",L):p(R,"optional",L);break;default:if(!T||!pi.test(Q))throw I(Q);o(Q),p(R,"optional",L);break}})}for(var Mt;(Mt=s())!==null;)switch(Mt){case"package":if(!d)throw I(Mt);g();break;case"import":if(!d)throw I(Mt);y();break;case"syntax":if(!d)throw I(Mt);v();break;case"option":Me(S,Mt),c(";");break;default:if(m(S,Mt)){d=!1;continue}throw I(Mt)}return Ni.filename=null,{package:u,imports:f,weakImports:b,syntax:E,root:e}}});var WC=A((tK,$C)=>{"use strict";$C.exports=qn;var bL=/\/|\./;function qn(n,e){bL.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),qn[n]=e}qn("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var HC;qn("duration",{Duration:HC={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});qn("timestamp",{Timestamp:HC});qn("empty",{Empty:{fields:{}}});qn("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});qn("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});qn("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});qn.get=function(e){return qn[e]||null}});var QC=A((nK,KC)=>{"use strict";var vr=KC.exports=FC();vr.build="full";vr.tokenize=Kg();vr.parse=GC();vr.common=WC();vr.Root._configure(vr.Type,vr.parse,vr.common)});var wu=A((iK,YC)=>{"use strict";YC.exports=QC()});var Xg=A((rK,yL)=>{yL.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var tS=A((ce,eS)=>{"use strict";var Ht=wu();eS.exports=ce=Ht.descriptor=Ht.Root.fromJSON(Xg()).lookup(".google.protobuf");var XC=Ht.Namespace,Ac=Ht.Root,Oi=Ht.Enum,_r=Ht.Type,xr=Ht.Field,vL=Ht.MapField,Eu=Ht.OneOf,Dc=Ht.Service,Tu=Ht.Method;Ac.fromDescriptor=function(e){typeof e.length=="number"&&(e=ce.FileDescriptorSet.decode(e));var t=new Ac;if(e.file)for(var i,r,s=0,o;s<e.file.length;++s){if(r=t,(i=e.file[s]).package&&i.package.length&&(r=t.define(i.package)),i.name&&i.name.length&&t.files.push(r.filename=i.name),i.messageType)for(o=0;o<i.messageType.length;++o)r.add(_r.fromDescriptor(i.messageType[o],i.syntax));if(i.enumType)for(o=0;o<i.enumType.length;++o)r.add(Oi.fromDescriptor(i.enumType[o]));if(i.extension)for(o=0;o<i.extension.length;++o)r.add(xr.fromDescriptor(i.extension[o]));if(i.service)for(o=0;o<i.service.length;++o)r.add(Dc.fromDescriptor(i.service[o]));var a=Bo(i.options,ce.FileOptions);if(a){var c=Object.keys(a);for(o=0;o<c.length;++o)r.setOption(c[o],a[c[o]])}}return t};Ac.prototype.toDescriptor=function(e){var t=ce.FileDescriptorSet.create();return ZC(this,t.file,e),t};function ZC(n,e,t){var i=ce.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(i.syntax=t),n instanceof Ac||(i.package=n.fullName.substring(1));for(var r=0,s;r<n.nestedArray.length;++r)(s=n._nestedArray[r])instanceof _r?i.messageType.push(s.toDescriptor(t)):s instanceof Oi?i.enumType.push(s.toDescriptor()):s instanceof xr?i.extension.push(s.toDescriptor(t)):s instanceof Dc?i.service.push(s.toDescriptor()):s instanceof XC&&ZC(s,e,t);i.options=Vo(n.options,ce.FileOptions),i.messageType.length+i.enumType.length+i.extension.length+i.service.length&&e.push(i)}var _L=0;_r.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=ce.DescriptorProto.decode(e));var i=new _r(e.name.length?e.name:"Type"+_L++,Bo(e.options,ce.MessageOptions)),r;if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)i.add(Eu.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=xr.fromDescriptor(e.field[r],t);i.add(s),e.field[r].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)i.add(xr.fromDescriptor(e.extension[r],t));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)i.add(_r.fromDescriptor(e.nestedType[r],t)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)i.add(Oi.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],r=0;r<e.extensionRange.length;++r)i.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)i.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)i.reserved.push(e.reservedName[r])}return i};_r.prototype.toDescriptor=function(e){var t=ce.DescriptorProto.create({name:this.name}),i;for(i=0;i<this.fieldsArray.length;++i){var r;if(t.field.push(r=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof vL){var s=Zg(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType),o=Zg(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType),a=o===11||o===14?this._fieldsArray[i].resolvedType&&JC(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;t.nestedType.push(ce.DescriptorProto.create({name:r.typeName,field:[ce.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ce.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ce.MessageOptions.create({mapEntry:!0})}))}}for(i=0;i<this.oneofsArray.length;++i)t.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof xr?t.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof _r?t.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof Oi&&t.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)t.extensionRange.push(ce.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)typeof this.reserved[i]=="string"?t.reservedName.push(this.reserved[i]):t.reservedRange.push(ce.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return t.options=Vo(this.options,ce.MessageOptions),t};var xL=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;xr.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=ce.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=SL(e.type);var r;switch(e.label){case 1:r=void 0;break;case 2:r="required";break;case 3:r="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new xr(e.name.length?e.name:"field"+e.number,e.number,i,r,s);if(o.options=Bo(e.options,ce.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var c=xL.exec(a);c&&(a=parseInt(a));break}o.setOption("default",a)}return kL(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};xr.prototype.toDescriptor=function(e){var t=ce.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=Ht.util.ucFirst(this.name),t.label=3;else{switch(t.type=Zg(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?JC(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=Vo(this.options,ce.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=ce.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=ce.FieldOptions.create())).packed=!0),t};var wL=0;Oi.fromDescriptor=function(e){typeof e.length=="number"&&(e=ce.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var i=0;i<e.value.length;++i){var r=e.value[i].name,s=e.value[i].number||0;t[r&&r.length?r:"NAME"+s]=s}return new Oi(e.name&&e.name.length?e.name:"Enum"+wL++,t,Bo(e.options,ce.EnumOptions))};Oi.prototype.toDescriptor=function(){for(var e=[],t=0,i=Object.keys(this.values);t<i.length;++t)e.push(ce.EnumValueDescriptorProto.create({name:i[t],number:this.values[i[t]]}));return ce.EnumDescriptorProto.create({name:this.name,value:e,options:Vo(this.options,ce.EnumOptions)})};var EL=0;Eu.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ce.OneofDescriptorProto.decode(e)),new Eu(e.name&&e.name.length?e.name:"oneof"+EL++)};Eu.prototype.toDescriptor=function(){return ce.OneofDescriptorProto.create({name:this.name})};var TL=0;Dc.fromDescriptor=function(e){typeof e.length=="number"&&(e=ce.ServiceDescriptorProto.decode(e));var t=new Dc(e.name&&e.name.length?e.name:"Service"+TL++,Bo(e.options,ce.ServiceOptions));if(e.method)for(var i=0;i<e.method.length;++i)t.add(Tu.fromDescriptor(e.method[i]));return t};Dc.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return ce.ServiceDescriptorProto.create({name:this.name,method:e,options:Vo(this.options,ce.ServiceOptions)})};var CL=0;Tu.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ce.MethodDescriptorProto.decode(e)),new Tu(e.name&&e.name.length?e.name:"Method"+CL++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Bo(e.options,ce.MethodOptions))};Tu.prototype.toDescriptor=function(){return ce.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Vo(this.options,ce.MethodOptions)})};function SL(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function kL(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function Zg(n,e){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Oi)return 14;if(e instanceof _r)return e.group?10:11;throw Error("illegal type: "+n)}function Bo(n,e){if(n){for(var t=[],i=0,r,s,o;i<e.fieldsArray.length;++i)(s=(r=e._fieldsArray[i]).name)!=="uninterpretedOption"&&n.hasOwnProperty(s)&&(o=n[s],r.resolvedType instanceof Oi&&typeof o=="number"&&r.resolvedType.valuesById[o]!==void 0&&(o=r.resolvedType.valuesById[o]),t.push(IL(s),o));return t.length?Ht.util.toObject(t):void 0}}function Vo(n,e){if(n){for(var t=[],i=0,r=Object.keys(n),s,o;i<r.length;++i)if(o=n[s=r[i]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=Ht.util.camelCase(s)])||t.push(s,o)}return t.length?e.fromObject(Ht.util.toObject(t)):void 0}}function JC(n,e){var t=n.fullName.split("."),i=e.fullName.split("."),r=0,s=0,o=i.length-1;if(!(n instanceof Ac)&&e instanceof XC)for(;r<t.length&&s<o&&t[r]===i[s];){var a=e.lookup(t[r++],!0);if(a!==null&&a!==e)break;++s}else for(;r<t.length&&s<o&&t[r]===i[s];++r,++s);return i.slice(s).join(".")}function IL(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var nS=A((sK,AL)=>{AL.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var iS=A((oK,DL)=>{DL.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var rS=A((aK,ML)=>{ML.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var cS=A(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.addCommonProtos=wr.loadProtosWithOptionsSync=wr.loadProtosWithOptions=void 0;var sS=xe("fs"),oS=xe("path"),zo=wu();function aS(n,e){let t=n.resolvePath;n.resolvePath=(i,r)=>{if(oS.isAbsolute(r))return r;for(let s of e){let o=oS.join(s,r);try{return sS.accessSync(o,sS.constants.R_OK),o}catch{continue}}return process.emitWarning(`${r} not found in any of the include paths ${e}`),t(i,r)}}function RL(n,e){return w(this,null,function*(){let t=new zo.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));aS(t,e.includeDirs)}let i=yield t.load(n,e);return i.resolveAll(),i})}wr.loadProtosWithOptions=RL;function NL(n,e){let t=new zo.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");aS(t,e.includeDirs)}let i=t.loadSync(n,e);return i.resolveAll(),i}wr.loadProtosWithOptionsSync=NL;function OL(){let n=nS(),e=Xg(),t=iS(),i=rS();zo.common("api",n.nested.google.nested.protobuf.nested),zo.common("descriptor",e.nested.google.nested.protobuf.nested),zo.common("source_context",t.nested.google.nested.protobuf.nested),zo.common("type",i.nested.google.nested.protobuf.nested)}wr.addCommonProtos=OL});var uS=A((dS,Jg)=>{"use strict";var lS=function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(h,p,z){this.low=h|0,this.high=p|0,this.unsigned=!!z}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function i(h){return(h&&h.__isLong__)===!0}function r(h){var p=Math.clz32(h&-h);return h?31-p:p}t.isLong=i;var s={},o={};function a(h,p){var z,me,Be;return p?(h>>>=0,(Be=0<=h&&h<256)&&(me=o[h],me)?me:(z=l(h,0,!0),Be&&(o[h]=z),z)):(h|=0,(Be=-128<=h&&h<128)&&(me=s[h],me)?me:(z=l(h,h<0?-1:0,!1),Be&&(s[h]=z),z))}t.fromInt=a;function c(h,p){if(isNaN(h))return p?P:F;if(p){if(h<0)return P;if(h>=S)return y}else{if(h<=-M)return v;if(h+1>=M)return g}return h<0?c(-h,p).neg():l(h%T|0,h/T|0,p)}t.fromNumber=c;function l(h,p,z){return new t(h,p,z)}t.fromBits=l;var d=Math.pow;function u(h,p,z){if(h.length===0)throw Error("empty string");if(typeof p=="number"?(z=p,p=!1):p=!!p,h==="NaN"||h==="Infinity"||h==="+Infinity"||h==="-Infinity")return p?P:F;if(z=z||10,z<2||36<z)throw RangeError("radix");var me;if((me=h.indexOf("-"))>0)throw Error("interior hyphen");if(me===0)return u(h.substring(1),p,z).neg();for(var Be=c(d(z,8)),Ce=F,tt=0;tt<h.length;tt+=8){var Me=Math.min(8,h.length-tt),Vt=parseInt(h.substring(tt,tt+Me),z);if(Me<8){var ct=c(d(z,Me));Ce=Ce.mul(ct).add(c(Vt))}else Ce=Ce.mul(Be),Ce=Ce.add(c(Vt))}return Ce.unsigned=p,Ce}t.fromString=u;function f(h,p){return typeof h=="number"?c(h,p):typeof h=="string"?u(h,p):l(h.low,h.high,typeof p=="boolean"?p:h.unsigned)}t.fromValue=f;var b=65536,E=1<<24,T=b*b,S=T*T,M=S/2,I=a(E),F=a(0);t.ZERO=F;var P=a(0,!0);t.UZERO=P;var G=a(1);t.ONE=G;var J=a(1,!0);t.UONE=J;var _=a(-1);t.NEG_ONE=_;var g=l(-1,2147483647,!1);t.MAX_VALUE=g;var y=l(-1,-1,!0);t.MAX_UNSIGNED_VALUE=y;var v=l(0,-2147483648,!1);t.MIN_VALUE=v;var m=t.prototype;m.toInt=function(){return this.unsigned?this.low>>>0:this.low},m.toNumber=function(){return this.unsigned?(this.high>>>0)*T+(this.low>>>0):this.high*T+(this.low>>>0)},m.toString=function(p){if(p=p||10,p<2||36<p)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(v)){var z=c(p),me=this.div(z),Be=me.mul(z).sub(this);return me.toString(p)+Be.toInt().toString(p)}else return"-"+this.neg().toString(p);for(var Ce=c(d(p,6),this.unsigned),tt=this,Me="";;){var Vt=tt.div(Ce),ct=tt.sub(Vt.mul(Ce)).toInt()>>>0,Ze=ct.toString(p);if(tt=Vt,tt.isZero())return Ze+Me;for(;Ze.length<6;)Ze="0"+Ze;Me=""+Ze+Me}},m.getHighBits=function(){return this.high},m.getHighBitsUnsigned=function(){return this.high>>>0},m.getLowBits=function(){return this.low},m.getLowBitsUnsigned=function(){return this.low>>>0},m.getNumBitsAbs=function(){if(this.isNegative())return this.eq(v)?64:this.neg().getNumBitsAbs();for(var p=this.high!=0?this.high:this.low,z=31;z>0&&!(p&1<<z);z--);return this.high!=0?z+33:z+1},m.isZero=function(){return this.high===0&&this.low===0},m.eqz=m.isZero,m.isNegative=function(){return!this.unsigned&&this.high<0},m.isPositive=function(){return this.unsigned||this.high>=0},m.isOdd=function(){return(this.low&1)===1},m.isEven=function(){return(this.low&1)===0},m.equals=function(p){return i(p)||(p=f(p)),this.unsigned!==p.unsigned&&this.high>>>31===1&&p.high>>>31===1?!1:this.high===p.high&&this.low===p.low},m.eq=m.equals,m.notEquals=function(p){return!this.eq(p)},m.neq=m.notEquals,m.ne=m.notEquals,m.lessThan=function(p){return this.comp(p)<0},m.lt=m.lessThan,m.lessThanOrEqual=function(p){return this.comp(p)<=0},m.lte=m.lessThanOrEqual,m.le=m.lessThanOrEqual,m.greaterThan=function(p){return this.comp(p)>0},m.gt=m.greaterThan,m.greaterThanOrEqual=function(p){return this.comp(p)>=0},m.gte=m.greaterThanOrEqual,m.ge=m.greaterThanOrEqual,m.compare=function(p){if(i(p)||(p=f(p)),this.eq(p))return 0;var z=this.isNegative(),me=p.isNegative();return z&&!me?-1:!z&&me?1:this.unsigned?p.high>>>0>this.high>>>0||p.high===this.high&&p.low>>>0>this.low>>>0?-1:1:this.sub(p).isNegative()?-1:1},m.comp=m.compare,m.negate=function(){return!this.unsigned&&this.eq(v)?v:this.not().add(G)},m.neg=m.negate,m.add=function(p){i(p)||(p=f(p));var z=this.high>>>16,me=this.high&65535,Be=this.low>>>16,Ce=this.low&65535,tt=p.high>>>16,Me=p.high&65535,Vt=p.low>>>16,ct=p.low&65535,Ze=0,It=0,lt=0,zt=0;return zt+=Ce+ct,lt+=zt>>>16,zt&=65535,lt+=Be+Vt,It+=lt>>>16,lt&=65535,It+=me+Me,Ze+=It>>>16,It&=65535,Ze+=z+tt,Ze&=65535,l(lt<<16|zt,Ze<<16|It,this.unsigned)},m.subtract=function(p){return i(p)||(p=f(p)),this.add(p.neg())},m.sub=m.subtract,m.multiply=function(p){if(this.isZero())return this;if(i(p)||(p=f(p)),e){var z=e.mul(this.low,this.high,p.low,p.high);return l(z,e.get_high(),this.unsigned)}if(p.isZero())return this.unsigned?P:F;if(this.eq(v))return p.isOdd()?v:F;if(p.eq(v))return this.isOdd()?v:F;if(this.isNegative())return p.isNegative()?this.neg().mul(p.neg()):this.neg().mul(p).neg();if(p.isNegative())return this.mul(p.neg()).neg();if(this.lt(I)&&p.lt(I))return c(this.toNumber()*p.toNumber(),this.unsigned);var me=this.high>>>16,Be=this.high&65535,Ce=this.low>>>16,tt=this.low&65535,Me=p.high>>>16,Vt=p.high&65535,ct=p.low>>>16,Ze=p.low&65535,It=0,lt=0,zt=0,no=0;return no+=tt*Ze,zt+=no>>>16,no&=65535,zt+=Ce*Ze,lt+=zt>>>16,zt&=65535,zt+=tt*ct,lt+=zt>>>16,zt&=65535,lt+=Be*Ze,It+=lt>>>16,lt&=65535,lt+=Ce*ct,It+=lt>>>16,lt&=65535,lt+=tt*Vt,It+=lt>>>16,lt&=65535,It+=me*Ze+Be*ct+Ce*Vt+tt*Me,It&=65535,l(zt<<16|no,It<<16|lt,this.unsigned)},m.mul=m.multiply,m.divide=function(p){if(i(p)||(p=f(p)),p.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&p.low===-1&&p.high===-1)return this;var z=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,p.low,p.high);return l(z,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?P:F;var me,Be,Ce;if(this.unsigned){if(p.unsigned||(p=p.toUnsigned()),p.gt(this))return P;if(p.gt(this.shru(1)))return J;Ce=P}else{if(this.eq(v)){if(p.eq(G)||p.eq(_))return v;if(p.eq(v))return G;var tt=this.shr(1);return me=tt.div(p).shl(1),me.eq(F)?p.isNegative()?G:_:(Be=this.sub(p.mul(me)),Ce=me.add(Be.div(p)),Ce)}else if(p.eq(v))return this.unsigned?P:F;if(this.isNegative())return p.isNegative()?this.neg().div(p.neg()):this.neg().div(p).neg();if(p.isNegative())return this.div(p.neg()).neg();Ce=F}for(Be=this;Be.gte(p);){me=Math.max(1,Math.floor(Be.toNumber()/p.toNumber()));for(var Me=Math.ceil(Math.log(me)/Math.LN2),Vt=Me<=48?1:d(2,Me-48),ct=c(me),Ze=ct.mul(p);Ze.isNegative()||Ze.gt(Be);)me-=Vt,ct=c(me,this.unsigned),Ze=ct.mul(p);ct.isZero()&&(ct=G),Ce=Ce.add(ct),Be=Be.sub(Ze)}return Ce},m.div=m.divide,m.modulo=function(p){if(i(p)||(p=f(p)),e){var z=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,p.low,p.high);return l(z,e.get_high(),this.unsigned)}return this.sub(this.div(p).mul(p))},m.mod=m.modulo,m.rem=m.modulo,m.not=function(){return l(~this.low,~this.high,this.unsigned)},m.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},m.clz=m.countLeadingZeros,m.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},m.ctz=m.countTrailingZeros,m.and=function(p){return i(p)||(p=f(p)),l(this.low&p.low,this.high&p.high,this.unsigned)},m.or=function(p){return i(p)||(p=f(p)),l(this.low|p.low,this.high|p.high,this.unsigned)},m.xor=function(p){return i(p)||(p=f(p)),l(this.low^p.low,this.high^p.high,this.unsigned)},m.shiftLeft=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low<<p,this.high<<p|this.low>>>32-p,this.unsigned):l(0,this.low<<p-32,this.unsigned)},m.shl=m.shiftLeft,m.shiftRight=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low>>>p|this.high<<32-p,this.high>>p,this.unsigned):l(this.high>>p-32,this.high>=0?0:-1,this.unsigned)},m.shr=m.shiftRight,m.shiftRightUnsigned=function(p){return i(p)&&(p=p.toInt()),(p&=63)===0?this:p<32?l(this.low>>>p|this.high<<32-p,this.high>>>p,this.unsigned):p===32?l(this.high,0,this.unsigned):l(this.high>>>p-32,0,this.unsigned)},m.shru=m.shiftRightUnsigned,m.shr_u=m.shiftRightUnsigned,m.rotateLeft=function(p){var z;return i(p)&&(p=p.toInt()),(p&=63)===0?this:p===32?l(this.high,this.low,this.unsigned):p<32?(z=32-p,l(this.low<<p|this.high>>>z,this.high<<p|this.low>>>z,this.unsigned)):(p-=32,z=32-p,l(this.high<<p|this.low>>>z,this.low<<p|this.high>>>z,this.unsigned))},m.rotl=m.rotateLeft,m.rotateRight=function(p){var z;return i(p)&&(p=p.toInt()),(p&=63)===0?this:p===32?l(this.high,this.low,this.unsigned):p<32?(z=32-p,l(this.high<<z|this.low>>>p,this.low<<z|this.high>>>p,this.unsigned)):(p-=32,z=32-p,l(this.low<<z|this.high>>>p,this.high<<z|this.low>>>p,this.unsigned))},m.rotr=m.rotateRight,m.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},m.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},m.toBytes=function(p){return p?this.toBytesLE():this.toBytesBE()},m.toBytesLE=function(){var p=this.high,z=this.low;return[z&255,z>>>8&255,z>>>16&255,z>>>24,p&255,p>>>8&255,p>>>16&255,p>>>24]},m.toBytesBE=function(){var p=this.high,z=this.low;return[p>>>24,p>>>16&255,p>>>8&255,p&255,z>>>24,z>>>16&255,z>>>8&255,z&255]},t.fromBytes=function(p,z,me){return me?t.fromBytesLE(p,z):t.fromBytesBE(p,z)},t.fromBytesLE=function(p,z){return new t(p[0]|p[1]<<8|p[2]<<16|p[3]<<24,p[4]|p[5]<<8|p[6]<<16|p[7]<<24,z)},t.fromBytesBE=function(p,z){return new t(p[4]<<24|p[5]<<16|p[6]<<8|p[7],p[0]<<24|p[1]<<16|p[2]<<8|p[3],z)};var x=t;return n.default=x,"default"in n?n.default:n}({});typeof define=="function"&&define.amd?define([],function(){return lS}):typeof Jg=="object"&&typeof dS=="object"&&(Jg.exports=lS)});var ib=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.loadFileDescriptorSetFromObject=wt.loadFileDescriptorSetFromBuffer=wt.fromJSON=wt.loadSync=wt.load=wt.IdempotencyLevel=wt.isAnyExtension=wt.Long=void 0;var FL=ZE(),gi=wu(),tb=tS(),nb=cS(),PL=uS();wt.Long=PL;function LL(n){return"@type"in n&&typeof n["@type"]=="string"}wt.isAnyExtension=LL;var mS;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(mS=wt.IdempotencyLevel||(wt.IdempotencyLevel={}));var pS={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function BL(n,e){return n===""?e:n+"."+e}function VL(n){return n instanceof gi.Service||n instanceof gi.Type||n instanceof gi.Enum}function zL(n){return n instanceof gi.Namespace||n instanceof gi.Root}function gS(n,e){let t=BL(e,n.name);return VL(n)?[[t,n]]:zL(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(i=>gS(n.nested[i],t)).reduce((i,r)=>i.concat(r),[]):[]}function hS(n,e){return function(i){return n.toObject(n.decode(i),e)}}function fS(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let i=n.fromObject(t);return n.encode(i).finish()}}function qL(n){return(n||[]).reduce((e,t)=>{for(let[i,r]of Object.entries(t))switch(i){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[i]=r}return e},{deprecated:!1,idempotency_level:mS.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function UL(n,e,t,i){let r=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:fS(r),requestDeserialize:hS(r,t),responseSerialize:fS(s),responseDeserialize:hS(s,t),originalName:FL(n.name),requestType:eb(r,i),responseType:eb(s,i),options:qL(n.parsedOptions)}}function jL(n,e,t,i){let r={};for(let s of n.methodsArray)r[s.name]=UL(s,e,t,i);return r}function eb(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,pS),fileDescriptorProtos:e}}function GL(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,pS),fileDescriptorProtos:e}}function HL(n,e,t,i){if(n instanceof gi.Service)return jL(n,e,t,i);if(n instanceof gi.Type)return eb(n,i);if(n instanceof gi.Enum)return GL(n,i);throw new Error("Type mismatch in reflection object handling")}function Cu(n,e){let t={};n.resolveAll();let r=n.toDescriptor("proto3").file.map(s=>Buffer.from(tb.FileDescriptorProto.encode(s).finish()));for(let[s,o]of gS(n,""))t[s]=HL(o,s,e,r);return t}function bS(n,e){e=e||{};let t=gi.Root.fromDescriptor(n);return t.resolveAll(),Cu(t,e)}function $L(n,e){return(0,nb.loadProtosWithOptions)(n,e).then(t=>Cu(t,e))}wt.load=$L;function WL(n,e){let t=(0,nb.loadProtosWithOptionsSync)(n,e);return Cu(t,e)}wt.loadSync=WL;function KL(n,e){e=e||{};let t=gi.Root.fromJSON(n);return t.resolveAll(),Cu(t,e)}wt.fromJSON=KL;function QL(n,e){let t=tb.FileDescriptorSet.decode(n);return bS(t,e)}wt.loadFileDescriptorSetFromBuffer=QL;function YL(n,e){let t=tb.FileDescriptorSet.fromObject(n);return bS(t,e)}wt.loadFileDescriptorSetFromObject=YL;(0,nb.addCommonProtos)()});var _s=A(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.setup=Ue.getChannelzServiceDefinition=Ue.getChannelzHandlers=Ue.unregisterChannelzRef=Ue.registerChannelzSocket=Ue.registerChannelzServer=Ue.registerChannelzSubchannel=Ue.registerChannelzChannel=Ue.ChannelzCallTracker=Ue.ChannelzChildrenTracker=Ue.ChannelzTrace=void 0;var yS=xe("net"),Mc=vn(),Nc=_e(),XL=ai(),ZL=$d(),JL=eg();function rb(n){return{channel_id:n.id,name:n.name}}function cb(n){return{subchannel_id:n.id,name:n.name}}function e2(n){return{server_id:n.id}}function ku(n){return{socket_id:n.id,name:n.name}}var vS=32,sb=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,i){let r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:i?.kind==="channel"?i:void 0,childSubchannel:i?.kind==="subchannel"?i:void 0}),this.events.length>=vS*2&&(this.events=this.events.slice(vS)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Fi(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Fi(e.timestamp),channel_ref:e.childChannel?rb(e.childChannel):null,subchannel_ref:e.childSubchannel?cb(e.childSubchannel):null}))}}};Ue.ChannelzTrace=sb;var ob=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,i,r;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(i=this.subchannelChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:r}of this.channelChildren.values())e.push(r);let t=[];for(let{ref:r}of this.subchannelChildren.values())t.push(r);let i=[];for(let{ref:r}of this.socketChildren.values())i.push(r);return{channels:e,subchannels:t,sockets:i}}};Ue.ChannelzChildrenTracker=ob;var ab=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Ue.ChannelzCallTracker=ab;var t2=1;function Iu(){return t2++}var Rc=[],lb=[],Er=[],db=[];function n2(n,e,t){let i=Iu(),r={id:i,name:n,kind:"channel"};return t&&(Rc[i]={ref:r,getInfo:e}),r}Ue.registerChannelzChannel=n2;function i2(n,e,t){let i=Iu(),r={id:i,name:n,kind:"subchannel"};return t&&(lb[i]={ref:r,getInfo:e}),r}Ue.registerChannelzSubchannel=i2;function r2(n,e){let t=Iu(),i={id:t,kind:"server"};return e&&(Er[t]={ref:i,getInfo:n}),i}Ue.registerChannelzServer=r2;function s2(n,e,t){let i=Iu(),r={id:i,name:n,kind:"socket"};return t&&(db[i]={ref:r,getInfo:e}),r}Ue.registerChannelzSocket=s2;function o2(n){switch(n.kind){case"channel":delete Rc[n.id];return;case"subchannel":delete lb[n.id];return;case"server":delete Er[n.id];return;case"socket":delete db[n.id];return}}Ue.unregisterChannelzRef=o2;function a2(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function _S(n){if(n==="")return[];let e=n.split(":").map(i=>a2(i));return[].concat(...e)}function c2(n){if((0,yS.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,yS.isIPv6)(n)){let e,t,i=n.indexOf("::");i===-1?(e=n,t=""):(e=n.substring(0,i),t=n.substring(i+2));let r=Buffer.from(_S(e)),s=Buffer.from(_S(t)),o=Buffer.alloc(16-r.length-s.length,0);return Buffer.concat([r,o,s])}else return null}function wS(n){switch(n){case Mc.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Mc.ConnectivityState.IDLE:return{state:"IDLE"};case Mc.ConnectivityState.READY:return{state:"READY"};case Mc.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Mc.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Fi(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function ES(n){let e=n.getInfo();return{ref:rb(n.ref),data:{target:e.target,state:wS(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fi(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>rb(t)),subchannel_ref:e.children.subchannels.map(t=>cb(t))}}function l2(n,e){let t=Number.parseInt(n.request.channel_id),i=Rc[t];if(i===void 0){e({code:Nc.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:ES(i)})}function d2(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_channel_id);for(;r<Rc.length;r++){let s=Rc[r];if(s!==void 0&&(i.push(ES(s)),i.length>=t))break}e(null,{channel:i,end:r>=Er.length})}function TS(n){let e=n.getInfo();return{ref:e2(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fi(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>ku(t))}}function u2(n,e){let t=Number.parseInt(n.request.server_id),i=Er[t];if(i===void 0){e({code:Nc.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:TS(i)})}function h2(n,e){let t=Number.parseInt(n.request.max_results),i=[],r=Number.parseInt(n.request.start_server_id);for(;r<Er.length;r++){let s=Er[r];if(s!==void 0&&(i.push(TS(s)),i.length>=t))break}e(null,{server:i,end:r>=Er.length})}function f2(n,e){let t=Number.parseInt(n.request.subchannel_id),i=lb[t];if(i===void 0){e({code:Nc.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let r=i.getInfo(),s={ref:cb(i.ref),data:{target:r.target,state:wS(r.state),calls_started:r.callTracker.callsStarted,calls_succeeded:r.callTracker.callsSucceeded,calls_failed:r.callTracker.callsFailed,last_call_started_timestamp:Fi(r.callTracker.lastCallStartedTimestamp),trace:r.trace.getTraceMessage()},socket_ref:r.children.sockets.map(o=>ku(o))};e(null,{subchannel:s})}function xS(n){var e;return(0,XL.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=c2(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function m2(n,e){var t,i,r,s,o;let a=Number.parseInt(n.request.socket_id),c=db[a];if(c===void 0){e({code:Nc.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let l=c.getInfo(),d=l.security?{model:"tls",tls:{cipher_suite:l.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=l.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(i=l.security.cipherSuiteOtherName)!==null&&i!==void 0?i:void 0,local_certificate:(r=l.security.localCertificate)!==null&&r!==void 0?r:void 0,remote_certificate:(s=l.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,u={ref:ku(c.ref),local:l.localAddress?xS(l.localAddress):null,remote:l.remoteAddress?xS(l.remoteAddress):null,remote_name:(o=l.remoteName)!==null&&o!==void 0?o:void 0,security:d,data:{keep_alives_sent:l.keepAlivesSent,streams_started:l.streamsStarted,streams_succeeded:l.streamsSucceeded,streams_failed:l.streamsFailed,last_local_stream_created_timestamp:Fi(l.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Fi(l.lastRemoteStreamCreatedTimestamp),messages_received:l.messagesReceived,messages_sent:l.messagesSent,last_message_received_timestamp:Fi(l.lastMessageReceivedTimestamp),last_message_sent_timestamp:Fi(l.lastMessageSentTimestamp),local_flow_control_window:l.localFlowControlWindow?{value:l.localFlowControlWindow}:null,remote_flow_control_window:l.remoteFlowControlWindow?{value:l.remoteFlowControlWindow}:null}};e(null,{socket:u})}function p2(n,e){let t=Number.parseInt(n.request.server_id),i=Er[t];if(i===void 0){e({code:Nc.Status.NOT_FOUND,details:"No server data found for id "+t});return}let r=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=i.getInfo().sessionChildren.sockets.sort((d,u)=>d.id-u.id),c=[],l=0;for(;l<a.length&&!(a[l].id>=r&&(c.push(ku(a[l])),c.length>=s));l++);e(null,{socket_ref:c,end:l>=a.length})}function CS(){return{GetChannel:l2,GetTopChannels:d2,GetServer:u2,GetServers:h2,GetSubchannel:f2,GetSocket:m2,GetServerSockets:p2}}Ue.getChannelzHandlers=CS;var Su=null;function SS(){if(Su)return Su;let n=ib().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return Su=(0,JL.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,Su}Ue.getChannelzServiceDefinition=SS;function g2(){(0,ZL.registerAdminService)(SS,CS)}Ue.setup=g2});var kS=A(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.Subchannel=void 0;var Oe=vn(),b2=hc(),ub=Je(),Au=_e(),y2=dn(),v2=ai(),qo=_s(),_2="subchannel",x2=~(1<<31),hb=class{constructor(e,t,i,r,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=i,this.credentials=r,this.connector=s,this.connectivityState=Oe.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new qo.ChannelzCallTracker,this.childrenTracker=new qo.ChannelzChildrenTracker,this.streamTracker=new qo.ChannelzCallTracker;let a={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new b2.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,v2.subchannelAddressToString)(t),this.keepaliveTime=(o=i["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new qo.ChannelzTrace,this.channelzRef=(0,qo.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(i,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){ub.trace(Au.LogVerbosity.DEBUG,_2,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){ub.trace(Au.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.CONNECTING):this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,x2);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Oe.ConnectivityState.CONNECTING],Oe.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(i=>{this.transitionToState([Oe.ConnectivityState.READY],Oe.ConnectivityState.IDLE),i&&this.keepaliveTime>0&&(this.keepaliveTime*=2,ub.log(Au.LogVerbosity.ERROR,`Connection to ${(0,y2.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([Oe.ConnectivityState.CONNECTING],Oe.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,i){var r,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Oe.ConnectivityState[this.connectivityState]+" -> "+Oe.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Oe.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Oe.ConnectivityState.READY:this.stopBackoff();break;case Oe.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Oe.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(r=this.transport)===null||r===void 0||r.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Oe.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,i);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,qo.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Oe.ConnectivityState.CONNECTING,Oe.ConnectivityState.READY],Oe.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,i,r){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===Au.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,i,r,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Oe.ConnectivityState.IDLE],Oe.ConnectivityState.CONNECTING)||this.connectivityState===Oe.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Du.Subchannel=hb});var gb=A(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.setup=Sr.DEFAULT_PORT=void 0;var IS=si(),DS=xe("dns"),MS=xe("util"),w2=kp(),fb=_e(),mb=Jt(),E2=Je(),T2=_e(),Tr=dn(),AS=xe("net"),C2=hc(),S2="dns_resolver";function Cr(n){E2.trace(T2.LogVerbosity.DEBUG,S2,n)}Sr.DEFAULT_PORT=443;var k2=3e4,I2=MS.promisify(DS.resolveTxt),A2=MS.promisify(DS.lookup);function D2(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(i=>i.length));t++)for(let i of n)t<i.length&&e.push(i[t]);return e}var pb=class{constructor(e,t,i){var r,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Cr("Resolver constructed for target "+(0,Tr.uriToString)(e));let a=(0,Tr.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,AS.isIPv4)(a.host)||(0,AS.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(r=a.port)!==null&&r!==void 0?r:Sr.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:Sr.DEFAULT_PORT),this.percentage=Math.random()*100,i["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:fb.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Tr.uriToString)(this.target)}`,metadata:new mb.Metadata};let c={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new C2.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=i["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:k2,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Cr("Returning IP address for target "+(0,Tr.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Cr("Failed to parse DNS address "+(0,Tr.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:fb.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Tr.uriToString)(this.target)}`,metadata:new mb.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Cr("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=A2(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let i=t.filter(o=>o.family===4),r=t.filter(o=>o.family===6);this.latestLookupResult=D2(r,i).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Cr("Resolved addresses for target "+(0,Tr.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(Cr("Resolution error for target "+(0,Tr.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=I2(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,w2.extractAndSelectServiceConfig)(t,this.percentage)}catch(i){this.latestServiceConfigError={code:fb.Status.UNAVAILABLE,details:`Parsing service config failed with error ${i.message}`,metadata:new mb.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Cr('resolution update delayed by "min time between resolutions" rate limit'):Cr("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function M2(){(0,IS.registerResolver)("dns",pb),(0,IS.registerDefaultScheme)("dns")}Sr.setup=M2});var bb=A(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.getProxiedConnection=Go.mapProxyName=void 0;var Oc=Je(),Uo=_e(),R2=si(),N2=xe("http"),O2=xe("tls"),F2=Je(),RS=ai(),jo=dn(),P2=xe("url"),L2=gb(),B2="proxy";function kr(n){F2.trace(Uo.LogVerbosity.DEBUG,B2,n)}function V2(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new P2.URL(n)}catch{return(0,Oc.log)(Uo.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,Oc.log)(Uo.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let i=null;t.username&&(t.password?((0,Oc.log)(Uo.LogVerbosity.INFO,"userinfo found in proxy URI"),i=`${t.username}:${t.password}`):i=t.username);let r=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${r}:${s}`};return i&&(o.creds=i),kr("Proxy server "+o.address+" set by environment variable "+e),o}function z2(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(kr("No proxy server list set by environment variable "+e),n.split(",")):[]}function q2(n,e){var t;let i={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return i;let r=V2();if(!r.address)return i;let s=(0,jo.splitHostPort)(n.path);if(!s)return i;let o=s.host;for(let c of z2())if(c===o)return kr("Not using proxy for target in no_proxy list: "+(0,jo.uriToString)(n)),i;let a={"grpc.http_connect_target":(0,jo.uriToString)(n)};return r.creds&&(a["grpc.http_connect_creds"]=r.creds),{target:{scheme:"dns",path:r.address},extraOptions:a}}Go.mapProxyName=q2;function U2(n,e,t){var i;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let r=e["grpc.http_connect_target"],s=(0,jo.parseUri)(r);if(s===null)return Promise.resolve({});let o=(0,jo.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(i=o.port)!==null&&i!==void 0?i:L2.DEFAULT_PORT}`,c={method:"CONNECT",path:a},l={Host:a};(0,RS.isTcpSubchannelAddress)(n)?(c.host=n.host,c.port=n.port):c.socketPath=n.path,"grpc.http_connect_creds"in e&&(l["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),c.headers=l;let d=(0,RS.subchannelAddressToString)(n);return kr("Using proxy "+d+" to connect to "+c.path),new Promise((u,f)=>{let b=N2.request(c);b.once("connect",(E,T,S)=>{var M;if(b.removeAllListeners(),T.removeAllListeners(),E.statusCode===200)if(kr("Successfully connected to "+c.path+" through proxy "+d),"secureContext"in t){let I=(0,R2.getDefaultAuthority)(s),F=(0,jo.splitHostPort)(I),P=(M=F?.host)!==null&&M!==void 0?M:I,G=O2.connect(Object.assign({host:P,servername:P,socket:T},t),()=>{kr("Successfully established a TLS connection to "+c.path+" through proxy "+d),u({socket:G,realTarget:s})});G.on("error",J=>{kr("Failed to establish a TLS connection to "+c.path+" through proxy "+d+" with error "+J.message),f()})}else kr("Successfully established a plaintext connection to "+c.path+" through proxy "+d),u({socket:T,realTarget:s});else(0,Oc.log)(Uo.LogVerbosity.ERROR,"Failed to connect to "+c.path+" through proxy "+d+" with status "+E.statusCode),f()}),b.once("error",E=>{b.removeAllListeners(),(0,Oc.log)(Uo.LogVerbosity.ERROR,"Failed to connect to proxy "+d+" with error "+E.message),f()}),b.end()})}Go.getProxiedConnection=U2});var vb=A(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.StreamDecoder=void 0;var Pi=function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n}(Pi||{}),yb=class{constructor(e){this.maxReadMessageLength=e,this.readState=Pi.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,i,r=[];for(;t<e.length;)switch(this.readState){case Pi.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=Pi.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Pi.READING_SIZE:if(i=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+i),this.readSizeRemaining-=i,t+=i,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Pi.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Pi.NO_DATA,r.push(s)}}break;case Pi.READING_MESSAGE:if(i=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+i)),this.readMessageRemaining-=i,t+=i,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Pi.NO_DATA,r.push(o)}break;default:throw new Error("Unexpected read state")}return r}};Mu.StreamDecoder=yb});var NS=A(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.Http2SubchannelCall=void 0;var Li=xe("http2"),j2=xe("os"),Ee=_e(),Ir=Jt(),G2=vb(),H2=Je(),$2=_e(),W2="subchannel_call";function K2(n){for(let[e,t]of Object.entries(j2.constants.errno))if(t===n)return e;return"Unknown system error "+n}var _b=class{constructor(e,t,i,r,s){var o;this.http2Stream=e,this.callEventTracker=t,this.listener=i,this.transport=r,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Ee.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let a=(o=r.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:Ee.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new G2.StreamDecoder(a),e.on("response",(c,l)=>{let d="";for(let u of Object.keys(c))d+="		"+u+": "+c[u]+`
`;switch(this.trace(`Received server headers:
`+d),c[":status"]){case 400:this.mappedStatusCode=Ee.Status.INTERNAL;break;case 401:this.mappedStatusCode=Ee.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Ee.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Ee.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Ee.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Ee.Status.UNKNOWN}if(l&Li.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(c);else{let u;try{u=Ir.Metadata.fromHttp2Headers(c)}catch(f){this.endCall({code:Ee.Status.UNKNOWN,details:f.message,metadata:new Ir.Metadata});return}this.listener.onReceiveMetadata(u)}}),e.on("trailers",c=>{this.handleTrailers(c)}),e.on("data",c=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+c.length);let l;try{l=this.decoder.write(c)}catch(d){this.cancelWithStatus(Ee.Status.RESOURCE_EXHAUSTED,d.message);return}for(let d of l)this.trace("parsed message of length "+d.length),this.callEventTracker.addMessageReceived(),this.tryPush(d)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var c;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((c=this.finalStatus)===null||c===void 0?void 0:c.code)===Ee.Status.OK)return;let l,d="";switch(e.rstCode){case Li.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;l=Ee.Status.INTERNAL,d=`Received RST_STREAM with code ${e.rstCode}`;break;case Li.constants.NGHTTP2_REFUSED_STREAM:l=Ee.Status.UNAVAILABLE,d="Stream refused by server";break;case Li.constants.NGHTTP2_CANCEL:l=Ee.Status.CANCELLED,d="Call cancelled";break;case Li.constants.NGHTTP2_ENHANCE_YOUR_CALM:l=Ee.Status.RESOURCE_EXHAUSTED,d="Bandwidth exhausted or memory limit exceeded";break;case Li.constants.NGHTTP2_INADEQUATE_SECURITY:l=Ee.Status.PERMISSION_DENIED,d="Protocol not secure enough";break;case Li.constants.NGHTTP2_INTERNAL_ERROR:l=Ee.Status.INTERNAL,this.internalError===null?d=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(l=Ee.Status.UNAVAILABLE,d=this.internalError.message):d=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:l=Ee.Status.INTERNAL,d=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:l,details:d,metadata:new Ir.Metadata,rstCode:e.rstCode})})}),e.on("error",c=>{c.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+c.message+" code="+c.code+" errno="+K2(c.errno)+" syscall="+c.syscall),this.internalError=c),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Ee.Status.UNAVAILABLE,details:"Connection dropped",metadata:new Ir.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){H2.trace($2.LogVerbosity.DEBUG,W2,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Ee.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Ee.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let c of Object.keys(e))t+="		"+c+": "+e[c]+`
`;this.trace(`Received server trailers:
`+t);let i;try{i=Ir.Metadata.fromHttp2Headers(e)}catch{i=new Ir.Metadata}let r=i.getMap(),s=this.mappedStatusCode;if(s===Ee.Status.UNKNOWN&&typeof r["grpc-status"]=="string"){let c=Number(r["grpc-status"]);c in Ee.Status&&(s=c,this.trace("received status code "+c+" from server")),i.remove("grpc-status")}let o="";if(typeof r["grpc-message"]=="string"){try{o=decodeURI(r["grpc-message"])}catch{o=r["grpc-message"]}i.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:i};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Ee.Status.OK?t=Li.constants.NGHTTP2_NO_ERROR:t=Li.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new Ir.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Ee.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let i=r=>{process.nextTick(()=>{var s;let o=Ee.Status.UNAVAILABLE;r?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Ee.Status.INTERNAL),r&&this.cancelWithStatus(o,`Write error: ${r.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,i)}catch(r){this.endCall({code:Ee.Status.UNAVAILABLE,details:`Write failed with error ${r.message}`,metadata:new Ir.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};Ru.Http2SubchannelCall=_b});var xb=A(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.getNextCallNumber=void 0;var Q2=0;function Y2(){return Q2++}Nu.getNextCallNumber=Y2});var PS=A(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.Http2SubchannelConnector=void 0;var Sb=xe("http2"),OS=xe("tls"),wb=_s(),Fc=_e(),X2=bb(),$o=Je(),FS=si(),Ou=ai(),Ho=dn(),Z2=xe("net"),J2=NS(),eB=xb(),Eb="transport",tB="transport_flowctrl",nB=lp().version,{HTTP2_HEADER_AUTHORITY:iB,HTTP2_HEADER_CONTENT_TYPE:rB,HTTP2_HEADER_METHOD:sB,HTTP2_HEADER_PATH:oB,HTTP2_HEADER_TE:aB,HTTP2_HEADER_USER_AGENT:cB}=Sb.constants,lB=2e4,dB=Buffer.from("too_many_pings","ascii"),Tb=class{constructor(e,t,i,r){this.session=e,this.options=i,this.remoteName=r,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=lB,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new wb.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Ou.subchannelAddressToString)(t),i["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,wb.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[i["grpc.primary_user_agent"],`grpc-node-js/${nB}`,i["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in i&&(this.keepaliveTimeMs=i["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in i&&(this.keepaliveTimeoutMs=i["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in i?this.keepaliveWithoutCalls=i["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let c=!1;s===Sb.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(dB)&&(c=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(c)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),$o.isTracerEnabled(Eb)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,i;let r=this.session.socket,s=r.remoteAddress?(0,Ou.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,o=r.localAddress?(0,Ou.stringToSubchannelAddress)(r.localAddress,r.localPort):null,a;if(this.session.encrypted){let l=r,d=l.getCipher(),u=l.getCertificate(),f=l.getPeerCertificate();a={cipherSuiteStandardName:(e=d.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:u&&"raw"in u?u.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(i=this.session.state.remoteWindowSize)!==null&&i!==void 0?i:null}}trace(e){$o.trace(Fc.LogVerbosity.DEBUG,Eb,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){$o.trace(Fc.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){$o.trace(Fc.LogVerbosity.DEBUG,tB,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){$o.trace(Fc.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((i,r,s)=>{i&&(this.keepaliveTrace("Ping failed with error "+i.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,i,r,s){let o=e.toHttp2Headers();o[iB]=t,o[cB]=this.userAgent,o[rB]="application/grpc",o[sB]="POST",o[oB]=i,o[aB]="trailers";let a;try{a=this.session.request(o)}catch(d){throw this.handleDisconnect(),d}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let c,l;return this.channelzEnabled?(this.streamTracker.addCallStarted(),c={addMessageSent:()=>{var d;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(l)},onStreamEnd:d=>{var u;d?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}}):c={addMessageSent:()=>{var d;(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(l)},onStreamEnd:d=>{var u;(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}},l=new J2.Http2SubchannelCall(a,c,r,this,(0,eB.getNextCallNumber)()),this.addActiveCall(l),l}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,wb.unregisterChannelzRef)(this.channelzRef)}},Cb=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){$o.trace(Fc.LogVerbosity.DEBUG,Eb,(0,Ho.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,i,r){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,c,l;let d;r.realTarget?(d=(0,Ho.uriToString)(r.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Ho.uriToString)(r.realTarget))):(d=null,this.trace("creating HTTP/2 session to "+(0,Ou.subchannelAddressToString)(e)));let u=(0,FS.getDefaultAuthority)((a=r.realTarget)!==null&&a!==void 0?a:this.channelTarget),f=t._getConnectionOptions()||{};f.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in i?f.maxSessionMemory=i["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER;let b="http://";if("secureContext"in f){if(b="https://",i["grpc.ssl_target_name_override"]){let S=i["grpc.ssl_target_name_override"];f.checkServerIdentity=(M,I)=>(0,OS.checkServerIdentity)(S,I),f.servername=S}else{let S=(l=(c=(0,Ho.splitHostPort)(u))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";f.servername=S}r.socket&&(f.createConnection=(S,M)=>r.socket)}else f.createConnection=(S,M)=>r.socket?r.socket:Z2.connect(e);f=Object.assign(Object.assign(Object.assign({},f),e),{enableTrace:i["grpc-node.tls_enable_trace"]===1});let E=Sb.connect(b+u,f);this.session=E;let T="Failed to connect";E.unref(),E.once("connect",()=>{E.removeAllListeners(),s(new Tb(E,e,i,d)),this.session=null}),E.once("close",()=>{this.session=null,setImmediate(()=>{o(`${T} (${new Date().toISOString()})`)})}),E.once("error",S=>{T=S.message,this.trace("connection failed with error "+T)})})}connect(e,t,i){var r,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],i["grpc.ssl_target_name_override"]){let a=i["grpc.ssl_target_name_override"];o.checkServerIdentity=(c,l)=>(0,OS.checkServerIdentity)(a,l),o.servername=a}else if("grpc.http_connect_target"in i){let a=(0,FS.getDefaultAuthority)((r=(0,Ho.parseUri)(i["grpc.http_connect_target"]))!==null&&r!==void 0?r:{path:"localhost"}),c=(0,Ho.splitHostPort)(a);o.servername=(s=c?.host)!==null&&s!==void 0?s:a}i["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,X2.getProxiedConnection)(e,i,o).then(a=>this.createSession(e,t,i,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Fu.Http2SubchannelConnector=Cb});var LS=A(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.getSubchannelPool=Wo.SubchannelPool=void 0;var uB=_E(),hB=kS(),fB=ai(),mB=dn(),pB=PS(),gB=1e4,Pc=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},gB),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,i,r){this.ensureCleanupTask();let s=(0,mB.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let c of a)if((0,fB.subchannelAddressEqual)(t,c.subchannelAddress)&&(0,uB.channelOptionsEqual)(i,c.channelArguments)&&r._equals(c.channelCredentials))return c.subchannel}let o=new hB.Subchannel(e,t,i,r,new pB.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:i,channelCredentials:r,subchannel:o}),o.ref(),o}};Wo.SubchannelPool=Pc;var bB=new Pc;function yB(n){return n?bB:new Pc}Wo.getSubchannelPool=yB});var Ib=A(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.FilterStackFactory=Ko.FilterStack=void 0;var Pu=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let i=0;i<this.filters.length;i++)t=this.filters[i].sendMessage(t);return t}receiveMessage(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let i=this.filters.length-1;i>=0;i--)t=this.filters[i].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Ko.FilterStack=Pu;var kb=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Pu(this.factories.map(e=>e.createFilter()))}};Ko.FilterStackFactory=kb});var Ab=A(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.CompressionAlgorithms=void 0;var BS=function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n}(BS||(Lu.CompressionAlgorithms=BS={}))});var Mb=A(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.BaseFilter=void 0;var Db=class{sendMetadata(e){return w(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return w(this,null,function*(){return e})}receiveMessage(e){return w(this,null,function*(){return e})}receiveTrailers(e){return e}};Bu.BaseFilter=Db});var qS=A(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.CompressionFilterFactory=Yo.CompressionFilter=void 0;var Vu=xe("zlib"),zS=Ab(),zu=_e(),vB=Mb(),_B=Je(),xB=n=>typeof n=="number"&&typeof zS.CompressionAlgorithms[n]=="string",Qo=class{writeMessage(e,t){return w(this,null,function*(){let i=e;t&&(i=yield this.compressMessage(i));let r=Buffer.allocUnsafe(i.length+5);return r.writeUInt8(t?1:0,0),r.writeUInt32BE(i.length,1),i.copy(r,5),r})}readMessage(e){return w(this,null,function*(){let t=e.readUInt8(0)===1,i=e.slice(5);return t&&(i=yield this.decompressMessage(i)),i})}},xs=class extends Qo{compressMessage(e){return w(this,null,function*(){return e})}writeMessage(e,t){return w(this,null,function*(){let i=Buffer.allocUnsafe(e.length+5);return i.writeUInt8(0,0),i.writeUInt32BE(e.length,1),e.copy(i,5),i})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},Rb=class extends Qo{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,i)=>{Vu.deflate(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{let r=0,s=[],o=Vu.createInflate();o.on("data",a=>{s.push(a),r+=a.byteLength,this.maxRecvMessageLength!==-1&&r>this.maxRecvMessageLength&&(o.destroy(),i({code:zu.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},Nb=class extends Qo{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,i)=>{Vu.gzip(e,(r,s)=>{r?i(r):t(s)})})}decompressMessage(e){return new Promise((t,i)=>{let r=0,s=[],o=Vu.createGunzip();o.on("data",a=>{s.push(a),r+=a.byteLength,this.maxRecvMessageLength!==-1&&r>this.maxRecvMessageLength&&(o.destroy(),i({code:zu.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},Ob=class extends Qo{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function VS(n,e){switch(n){case"identity":return new xs;case"deflate":return new Rb(e);case"gzip":return new Nb(e);default:return new Ob(n)}}var qu=class extends vB.BaseFilter{constructor(e,t){var i,r;super(),this.sharedFilterConfig=t,this.sendCompression=new xs,this.receiveCompression=new xs,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(i=e["grpc.max_receive_message_length"])!==null&&i!==void 0?i:zu.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(xB(s)){let o=zS.CompressionAlgorithms[s],a=(r=t.serverSupportedEncodingHeader)===null||r===void 0?void 0:r.split(",");(!a||a.includes(o))&&(this.currentCompressionAlgorithm=o,this.sendCompression=VS(this.currentCompressionAlgorithm,-1))}else _B.log(zu.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}sendMetadata(e){return w(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let r=t[0];typeof r=="string"&&(this.receiveCompression=VS(r,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let i=e.get("grpc-accept-encoding")[0];return i&&(this.sharedFilterConfig.serverSupportedEncodingHeader=i,i.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new xs,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return w(this,null,function*(){var t;let i=yield e,r;return this.sendCompression instanceof xs?r=!1:r=(((t=i.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(i.message,r),flags:i.flags}})}receiveMessage(e){return w(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};Yo.CompressionFilter=qu;var Fb=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new qu(this.options,this.sharedFilterConfig)}};Yo.CompressionFilterFactory=Fb});var Uu=A(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.deadlineToString=bi.getRelativeTimeout=bi.getDeadlineTimeoutString=bi.minDeadline=void 0;function wB(...n){let e=1/0;for(let t of n){let i=t instanceof Date?t.getTime():t;i<e&&(e=i)}return e}bi.minDeadline=wB;var EB=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function TB(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[i,r]of EB){let s=t/r;if(s<1e8)return String(Math.ceil(s))+i}throw new Error("Deadline is too far in the future")}bi.getDeadlineTimeoutString=TB;var CB=2147483647;function SB(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),i=e-t;return i<0?0:i>CB?1/0:i}bi.getRelativeTimeout=SB;function kB(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}bi.deadlineToString=kB});var Gu=A(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});ju.restrictControlPlaneStatusCode=void 0;var yi=_e(),IB=[yi.Status.OK,yi.Status.INVALID_ARGUMENT,yi.Status.NOT_FOUND,yi.Status.ALREADY_EXISTS,yi.Status.FAILED_PRECONDITION,yi.Status.ABORTED,yi.Status.OUT_OF_RANGE,yi.Status.DATA_LOSS];function AB(n,e){return IB.includes(n)?{code:yi.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${yi.Status[n]} ${e}`}:{code:n,details:e}}ju.restrictControlPlaneStatusCode=AB});var jS=A(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.LoadBalancingCall=void 0;var US=vn(),Hu=_e(),DB=Uu(),$u=Jt(),Lc=hr(),MB=dn(),RB=Je(),Pb=Gu(),NB=xe("http2"),OB="load_balancing_call",Lb=class{constructor(e,t,i,r,s,o,a){var c,l;this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let d=this.methodName.split("/"),u="";d.length>=2&&(u=d[1]);let f=(l=(c=(0,MB.splitHostPort)(this.host))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";this.serviceUrl=`https://${f}/${u}`}trace(e){RB.trace(Hu.LogVerbosity.DEBUG,OB,"["+this.callNumber+"] "+e)}outputStatus(e,t){var i,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(i=this.listener)===null||i===void 0||i.onReceiveStatus(s),(r=this.onCallEnded)===null||r===void 0||r.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let i=this.channel.doPick(this.metadata,this.callConfig.pickInformation),r=i.subchannel?"("+i.subchannel.getChannelzRef().id+") "+i.subchannel.getAddress():""+i.subchannel;switch(this.trace("Pick result: "+Lc.PickResultType[i.pickResultType]+" subchannel: "+r+" status: "+((e=i.status)===null||e===void 0?void 0:e.code)+" "+((t=i.status)===null||t===void 0?void 0:t.details)),i.pickResultType){case Lc.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var c,l,d;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let u=this.metadata.clone();if(u.merge(a),u.get("authorization").length>1&&this.outputStatus({code:Hu.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new $u.Metadata},"PROCESSED"),i.subchannel.getConnectivityState()!==US.ConnectivityState.READY){this.trace("Picked subchannel "+r+" has state "+US.ConnectivityState[i.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&u.set("grpc-timeout",(0,DB.getDeadlineTimeoutString)(this.deadline));try{this.child=i.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:f=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(f)},onReceiveMessage:f=>{this.trace("Received message"),this.listener.onReceiveMessage(f)},onReceiveStatus:f=>{this.trace("Received status"),f.rstCode===NB.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(f,"REFUSED"):this.outputStatus(f,"PROCESSED")}})}catch(f){this.trace("Failed to start call on picked subchannel "+r+" with error "+f.message),this.outputStatus({code:Hu.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+f.message,metadata:new $u.Metadata},"NOT_STARTED");return}(l=(c=this.callConfig).onCommitted)===null||l===void 0||l.call(c),(d=i.onCallStarted)===null||d===void 0||d.call(i),this.onCallEnded=i.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:c,details:l}=(0,Pb.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:Hu.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:c,details:l,metadata:new $u.Metadata},"PROCESSED")});break;case Lc.PickResultType.DROP:let{code:s,details:o}=(0,Pb.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:i.status.metadata},"DROP")});break;case Lc.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:c}=(0,Pb.restrictControlPlaneStatusCode)(i.status.code,i.status.details);setImmediate(()=>{this.outputStatus({code:a,details:c,metadata:i.status.metadata},"PROCESSED")})}break;case Lc.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new $u.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};Wu.LoadBalancingCall=Lb});var HS=A(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.ResolvingCall=void 0;var Xo=_e(),Ku=Uu(),GS=Jt(),FB=Je(),PB=Gu(),LB="resolving_call",Bb=class{constructor(e,t,i,r,s,o){this.channel=e,this.method=t,this.filterStackFactory=r,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=i.deadline,this.host=i.host,i.parentCall&&(i.flags&Xo.Propagate.CANCELLATION&&i.parentCall.on("cancelled",()=>{this.cancelWithStatus(Xo.Status.CANCELLED,"Cancelled by parent call")}),i.flags&Xo.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+i.parentCall.getDeadline()),this.deadline=(0,Ku.minDeadline)(this.deadline,i.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){FB.trace(Xo.LogVerbosity.DEBUG,LB,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,Ku.deadlineToString)(this.deadline));let e=(0,Ku.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(Xo.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(i=>i(t)),process.nextTick(()=>{var i;(i=this.listener)===null||i===void 0||i.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let i=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(r=>{this.writeFilterPending=!1,i.sendMessageWithContext(e,r.message),this.pendingHalfClose&&i.halfClose()},r=>{this.cancelWithStatus(r.code,r.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==Xo.Status.OK){let{code:i,details:r}=(0,PB.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:i,details:r,metadata:new GS.Metadata});return}if(t.methodConfig.timeout){let i=new Date;i.setSeconds(i.getSeconds()+t.methodConfig.timeout.seconds),i.setMilliseconds(i.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,Ku.minDeadline)(this.deadline,i),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(i=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(i,{onReceiveMetadata:r=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(r))},onReceiveMessage:r=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(r).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:r=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=r:this.outputStatus(r)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},i=>{this.outputStatus(i)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new GS.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};Qu.ResolvingCall=Bb});var $S=A(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.RetryingCall=Ar.MessageBufferTracker=Ar.RetryThrottler=void 0;var Yu=_e(),BB=Jt(),VB=Je(),zB="retrying_call",zb=class{constructor(e,t,i){this.maxTokens=e,this.tokenRatio=t,i?this.tokens=i.tokens*(e/i.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Ar.RetryThrottler=zb;var qb=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var i;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;return this.limitPerCall-r<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,r+e),this.totalAllocated+=e,!0)}free(e,t){var i;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=(i=this.allocatedPerCall.get(t))!==null&&i!==void 0?i:0;if(r<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(t,r-e)}freeAll(e){var t;let i=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<i)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${i} > total allocated ${this.totalAllocated}`);this.totalAllocated-=i,this.allocatedPerCall.delete(e)}};Ar.MessageBufferTracker=qb;var Vb="grpc-previous-rpc-attempts",Ub=class{constructor(e,t,i,r,s,o,a,c,l){if(this.channel=e,this.callConfig=t,this.methodName=i,this.host=r,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=c,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let d=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(d.initialBackoff.substring(0,d.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){VB.trace(Yu.LogVerbosity.DEBUG,zB,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new BB.Metadata});for(let{call:i}of this.underlyingCalls)i.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let i=this.getBufferEntry(t);i.allocated&&this.bufferTracker.free(i.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(Yu.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[i,r]of this.underlyingCalls.entries())r.state==="ACTIVE"&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,t=i);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(i=>i===t||i.toString().toLowerCase()===Yu.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let i=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,r),i}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let i=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(i.maxAttempts,5)){t(!1);return}let r;if(e===null)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,i){var r,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&r!==void 0?r:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(i===null)a=0;else if(i<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=i;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(i,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var i;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===Yu.Status.OK){(i=this.retryThrottler)===null||i===void 0||i.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let r=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,r):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,r);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,i;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let s=(e=r.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(i=(t=this.hedgingTimer).unref)===null||i===void 0||i.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let i=this.attempts-1,r=this.initialMetadata.clone();i>0&&r.set(Vb,`${i}`);let s=!1;e.start(r,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,i>0&&o.set(Vb,`${i}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&i>0&&o.metadata.set(Vb,`${i}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,i;let r=this.underlyingCalls[e],s=r.nextMessageToSend;(i=(t=this.getBufferEntry(s)).callback)===null||i===void 0||i.call(t),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let i=this.getBufferEntry(t.nextMessageToSend);switch(i.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:r=>{this.handleChildWriteCompleted(e)}},i.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var i;this.trace("write() called with message of length "+t.length);let r={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(i=e.callback)===null||i===void 0||i.call(e);for(let[a,c]of this.underlyingCalls.entries())c.state==="ACTIVE"&&c.nextMessageToSend===s&&c.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Ar.RetryingCall=Ub});var Zu=A(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.BaseSubchannelWrapper=void 0;var jb=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};Xu.BaseSubchannelWrapper=jb});var QS=A(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.InternalChannel=void 0;var qB=Ld(),UB=vE(),jB=LS(),WS=hr(),Bc=_e(),GB=Ib(),HB=qS(),KS=si(),Gb=Je(),$B=bb(),Ju=dn(),vi=vn(),Vc=_s(),WB=jS(),KB=Uu(),QB=HS(),Hb=xb(),YB=Gu(),$b=$S(),XB=Zu(),ZB=2147483647,JB=1e3,eV=30*60*1e3,eh=new Map,tV=1<<24,nV=1<<20,Wb=class extends XB.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(i,r,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Kb=class{constructor(e,t,i){var r,s,o,a,c,l,d,u;if(this.credentials=t,this.options=i,this.connectivityState=vi.ConnectivityState.IDLE,this.currentPicker=new WS.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Vc.ChannelzCallTracker,this.childrenTracker=new Vc.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof qB.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let f=(0,Ju.parseUri)(e);if(f===null)throw new Error(`Could not parse target name "${e}"`);let b=(0,KS.mapUriDefaultScheme)(f);if(b===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},ZB),(s=(r=this.callRefTimer).unref)===null||s===void 0||s.call(r),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Vc.ChannelzTrace,this.channelzRef=(0,Vc.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,KS.getDefaultAuthority)(b);let E=(0,$B.mapProxyName)(b,i);this.target=E.target,this.options=Object.assign({},this.options,E.extraOptions),this.subchannelPool=(0,jB.getSubchannelPool)(((o=i["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new $b.MessageBufferTracker((a=i["grpc.retry_buffer_size"])!==null&&a!==void 0?a:tV,(c=i["grpc.per_rpc_retry_buffer_size"])!==null&&c!==void 0?c:nV),this.keepaliveTime=(l=i["grpc.keepalive_time_ms"])!==null&&l!==void 0?l:-1,this.idleTimeoutMs=Math.max((d=i["grpc.client_idle_timeout_ms"])!==null&&d!==void 0?d:eV,JB);let T={createSubchannel:(M,I)=>{let F=this.subchannelPool.getOrCreateSubchannel(this.target,M,Object.assign({},this.options,I),this.credentials);F.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",F.getChannelzRef());let P=new Wb(F,this);return this.wrappedSubchannels.add(P),P},updateState:(M,I)=>{this.currentPicker=I;let F=this.pickQueue.slice();this.pickQueue=[],F.length>0&&this.callRefTimerUnref();for(let P of F)P.doPick();this.updateState(M)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:M=>{this.channelzEnabled&&this.childrenTracker.refChild(M)},removeChannelzChild:M=>{this.channelzEnabled&&this.childrenTracker.unrefChild(M)}};this.resolvingLoadBalancer=new UB.ResolvingLoadBalancer(this.target,T,i,(M,I)=>{M.retryThrottling?eh.set(this.getTarget(),new $b.RetryThrottler(M.retryThrottling.maxTokens,M.retryThrottling.tokenRatio,eh.get(this.getTarget()))):eh.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=I,this.currentResolutionError=null,process.nextTick(()=>{let F=this.configSelectionQueue;this.configSelectionQueue=[],F.length>0&&this.callRefTimerUnref();for(let P of F)P.getConfig()})},M=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+M.code+' and details "'+M.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,YB.restrictControlPlaneStatusCode)(M.code,M.details)),{metadata:M.metadata}));let I=this.configSelectionQueue;this.configSelectionQueue=[],I.length>0&&this.callRefTimerUnref();for(let F of I)F.reportResolverError(M)}),this.filterStackFactory=new GB.FilterStackFactory([new HB.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(i,void 0,2));let S=new Error;(0,Gb.trace)(Bc.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((u=S.stack)===null||u===void 0?void 0:u.substring(S.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,Gb.trace)(t??Bc.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Ju.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,i,r;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(i=this.callRefTimer).ref)===null||r===void 0||r.call(i))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(i=>i===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,Gb.trace)(Bc.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Ju.uriToString)(this.target)+" "+vi.ConnectivityState[this.connectivityState]+" -> "+vi.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+vi.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let i of t)e!==i.currentState&&(i.timer&&clearTimeout(i.timer),this.removeConnectivityStateWatcher(i),i.callback());e!==vi.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(vi.ConnectivityState.IDLE),this.currentPicker=new WS.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,i;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(i=(t=this.idleTimer).unref)===null||i===void 0||i.call(t)}maybeStartIdleTimer(){this.connectivityState!==vi.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===Bc.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,i,r,s){let o=(0,Hb.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new WB.LoadBalancingCall(this,e,t,i,r,s,o)}createRetryingCall(e,t,i,r,s){let o=(0,Hb.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new $b.RetryingCall(this,e,t,i,r,s,o,this.retryBufferTracker,eh.get(this.getTarget()))}createInnerCall(e,t,i,r,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,i,r,s):this.createRetryingCall(e,t,i,r,s)}createResolvingCall(e,t,i,r,s){let o=(0,Hb.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,KB.deadlineToString)(t));let a={deadline:t,flags:s??Bc.Propagate.DEFAULTS,host:i??this.defaultAuthority,parentCall:r},c=new QB.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),c.addStatusWatcher(l=>{this.onCallEnd(l)}),c}close(){this.resolvingLoadBalancer.destroy(),this.updateState(vi.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Vc.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Ju.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,i){if(this.connectivityState===vi.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let r=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(i,new Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(s),i(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:i,timer:r};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===vi.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,i,r,s)}};th.InternalChannel=Kb});var Zp=A(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});nh.ChannelImplementation=void 0;var iV=Ld(),rV=QS(),Qb=class{constructor(e,t,i){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof iV.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new rV.InternalChannel(e,t,i)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,i){this.internalChannel.watchConnectivityState(e,t,i)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,i,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,i,r,s)}};nh.ChannelImplementation=Qb});var rk=A(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.Http2ServerCallStream=In.ServerDuplexStreamImpl=In.ServerWritableStreamImpl=In.ServerReadableStreamImpl=In.ServerUnaryCallImpl=void 0;var tk=xe("events"),Zo=xe("http2"),Zb=xe("stream"),YS=xe("zlib"),Pe=_e(),Jb=Jt(),sV=vb(),nk=Je(),qc=Md(),ik="server_call";function zc(n){nk.trace(Pe.LogVerbosity.DEBUG,ik,n)}var oV="grpc-accept-encoding",aV="grpc-encoding",XS="grpc-message",ZS="grpc-status",JS="grpc-timeout",cV=/(\d{1,8})\s*([HMSmun])/,lV={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},dV={[oV]:"identity,deflate,gzip",[aV]:"identity"},ek={[Zo.constants.HTTP2_HEADER_STATUS]:Zo.constants.HTTP_STATUS_OK,[Zo.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},uV={waitForTrailers:!0},Yb=class extends tk.EventEmitter{constructor(e,t,i){super(),this.call=e,this.metadata=t,this.request=i,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};In.ServerUnaryCallImpl=Yb;var ih=class extends Zb.Readable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=i,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};In.ServerReadableStreamImpl=ih;var Uc=class extends Zb.Writable{constructor(e,t,i,r){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.request=r,this.cancelled=!1,this.trailingMetadata=new Jb.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,i){try{let r=this.call.serializeMessage(e);if(!this.call.write(r)){this.call.once("drain",i);return}}catch(r){this.emit("error",{details:(0,qc.getErrorMessage)(r),code:Pe.Status.INTERNAL})}i()}_final(e){this.call.sendStatus({code:Pe.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};In.ServerWritableStreamImpl=Uc;var Jo=class extends Zb.Duplex{constructor(e,t,i,r,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new Jb.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};In.ServerDuplexStreamImpl=Jo;Jo.prototype._read=ih.prototype._read;Jo.prototype._write=Uc.prototype._write;Jo.prototype._final=Uc.prototype._final;var Xb=class extends tk.EventEmitter{constructor(e,t,i){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=Pe.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Pe.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",r=>{}),this.stream.once("close",()=>{var r;zc("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:Pe.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in i&&(this.maxSendMessageSize=i["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in i&&(this.maxReceiveMessageSize=i["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let i=e.subarray(5);if(t==="identity")return i;if(t==="deflate"||t==="gzip"){let r;return t==="deflate"?r=YS.createInflate():r=YS.createGunzip(),new Promise((s,o)=>{let a=0,c=[];r.on("data",l=>{c.push(l),a+=l.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(r.destroy(),o({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),r.on("end",()=>{s(Buffer.concat(c))}),r.write(i),r.end()})}else return Promise.reject({code:Pe.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,i=Object.assign(Object.assign(Object.assign({},ek),dV),t);this.stream.respond(i,uV)}receiveMetadata(e){let t=Jb.Metadata.fromHttp2Headers(e);nk.isTracerEnabled(ik)&&zc("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let i=t.get(JS);if(i.length>0){let r=i[0].toString().match(cV);if(r===null){let a=new Error("Invalid deadline");return a.code=Pe.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+r[1]*lV[r[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(hV,s,this),t.remove(JS)}return t.remove(Zo.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Zo.constants.HTTP2_HEADER_TE),t.remove(Zo.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,i)=>{let{stream:r}=this,s=0,o=this,a=[],c=this.maxReceiveMessageSize;this.stream.on("data",l),this.stream.on("end",d),this.stream.on("error",d);function l(u){if(s+=u.byteLength,c!==-1&&s>c){r.removeListener("data",l),r.removeListener("end",d),r.removeListener("error",d),i({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${c})`});return}a.push(u)}function d(u){if(r.removeListener("data",l),r.removeListener("end",d),r.removeListener("error",d),u!==void 0){i({code:Pe.Status.INTERNAL,details:u.message});return}if(s===0){i({code:Pe.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let f=Buffer.concat(a,s),E=f.readUInt8(0)===1?e:"identity",T=o.getDecompressedMessage(f,E);if(Buffer.isBuffer(T)){t(o.deserializeMessageWithInternalError(T));return}T.then(S=>t(o.deserializeMessageWithInternalError(S)),S=>i(S.code?S:{code:Pe.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return w(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,qc.getErrorMessage)(t),code:Pe.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),i=t.byteLength,r=Buffer.allocUnsafe(i+5);return r.writeUInt8(0,0),r.writeUInt32BE(i,1),t.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,i,r){return w(this,null,function*(){if(!this.checkCancelled()){if(i===void 0&&(i=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&i&&(e.metadata=i),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:Pe.Status.OK,details:"OK",metadata:i})}catch(s){this.sendError({details:(0,qc.getErrorMessage)(s),code:Pe.Status.INTERNAL})}}})}sendStatus(e){var t,i;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===Pe.Status.OK),!this.checkCancelled())if(zc("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+Pe.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var r;let s=Object.assign({[ZS]:e.code,[XS]:encodeURI(e.details)},(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let r=Object.assign(Object.assign({[ZS]:e.code,[XS]:encodeURI(e.details)},ek),(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.respond(r,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:Pe.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:Pe.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let i=new sV.StreamDecoder(this.maxReceiveMessageSize),r=!1,s=!1,o=!1,a=()=>w(this,null,function*(){!o&&r&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",c=>w(this,null,function*(){let l;try{l=i.write(c)}catch(d){this.sendError({code:Pe.Status.RESOURCE_EXHAUSTED,details:d.message});return}s=!0,this.stream.pause();for(let d of l){this.emit("receiveMessage");let f=d.readUInt8(0)===1?t:"identity",b;try{b=yield this.getDecompressedMessage(d,f)}catch(E){this.sendError(E);return}if(!b)return;yield this.pushOrBufferMessage(e,b)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>w(this,null,function*(){r=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),i=e.push(t);if(t===null||i===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return w(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return w(this,null,function*(){if(t===null){zc("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}zc("Received message of length "+t.length),this.isPushPending=!0;try{let i=yield this.deserializeMessage(t);this.canPush?e.push(i)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(i)}catch(i){this.bufferedMessages.length=0;let r=(0,qc.getErrorCode)(i);(r===null||r<Pe.Status.OK||r>Pe.Status.UNAUTHENTICATED)&&(r=Pe.Status.INTERNAL),e.emit("error",{details:(0,qc.getErrorMessage)(i),code:r})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};In.Http2ServerCallStream=Xb;function hV(n){let e=new Error("Deadline exceeded");e.code=Pe.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var ny=A(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.ServerCredentials=void 0;var sk=wp(),jc=class{static createInsecure(){return new ey}static createSsl(e,t,i=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof i!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let r=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);r.push(a.cert_chain),s.push(a.private_key)}return new ty({ca:e||(0,sk.getDefaultRootsData)()||void 0,cert:r,key:s,requestCert:i,ciphers:sk.CIPHER_SUITES})}};rh.ServerCredentials=jc;var ey=class extends jc{_isSecure(){return!1}_getSettings(){return null}},ty=class extends jc{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var ck=A(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.Server=void 0;var Dr=xe("http2"),Bi=_e(),ws=rk(),fV=ny(),ok=si(),sh=Je(),Un=ai(),mV=dn(),nn=_s(),oh=~(1<<31),pV=~(1<<31),gV=2e4,{HTTP2_HEADER_PATH:ak}=Dr.constants,bV="server";function yV(){}function iy(n){return{code:Bi.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function vV(n,e){let t=iy(e);switch(n){case"unary":return(i,r)=>{r(t,null)};case"clientStream":return(i,r)=>{r(t,null)};case"serverStream":return i=>{i.emit("error",t)};case"bidi":return i=>{i.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var ry=class{constructor(e){var t,i,r,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new nn.ChannelzTrace,this.callTracker=new nn.ChannelzCallTracker,this.listenerChildrenTracker=new nn.ChannelzChildrenTracker,this.sessionChildrenTracker=new nn.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,nn.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:oh,this.maxConnectionAgeGraceMs=(i=this.options["grpc.max_connection_age_grace_ms"])!==null&&i!==void 0?i:oh,this.keepaliveTimeMs=(r=this.options["grpc.keepalive_time_ms"])!==null&&r!==void 0?r:pV,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:gV,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,i,r;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,Un.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,c=o.localAddress?(0,Un.stringToSubchannelAddress)(o.localAddress,o.localPort):null,l;if(e.encrypted){let u=o,f=u.getCipher(),b=u.getCertificate(),E=u.getPeerCertificate();l={cipherSuiteStandardName:(t=f.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:f.standardName?null:f.name,localCertificate:b&&"raw"in b?b.raw:null,remoteCertificate:E&&"raw"in E?E.raw:null}}else l=null;return{remoteAddress:a,localAddress:c,security:l,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(i=e.state.localWindowSize)!==null&&i!==void 0?i:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null}}}trace(e){sh.trace(Bi.LogVerbosity.DEBUG,bV,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let i=Object.keys(e);if(i.length===0)throw new Error("Cannot add an empty service to a server");i.forEach(r=>{let s=e[r],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[r],c;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?c=a.bind(t):c=vV(o,r),this.register(s.path,c,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(i=>{let r=e[i];this.unregister(r.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,i){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof fV.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof i!="function")throw new TypeError("callback must be a function");let r=(0,mV.parseUri)(e);if(r===null)throw new Error(`Could not parse port "${e}"`);let s=(0,ok.mapUriDefaultScheme)(r);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(b,E)=>{process.nextTick(()=>i(b,E))},c=()=>{let b;if(t._isSecure()){let E=Object.assign(o,t._getSettings());E.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,b=Dr.createSecureServer(E),b.on("secureConnection",T=>{T.on("error",S=>{this.trace("An incoming TLS connection closed with error: "+S.message)})})}else b=Dr.createServer(o);return b.setTimeout(0,yV),this._setupHandlers(b),b},l=(b,E,T)=>b.length===0?Promise.resolve({port:E,count:T}):Promise.all(b.map(S=>{this.trace("Attempting to bind "+(0,Un.subchannelAddressToString)(S));let M;(0,Un.isTcpSubchannelAddress)(S)?M={host:S.host,port:E}:M=S;let I=c();return new Promise((F,P)=>{let G=J=>{this.trace("Failed to bind "+(0,Un.subchannelAddressToString)(S)+" with error "+J.message),F(J)};I.once("error",G),I.listen(M,()=>{if(this.shutdown){I.close(),F(new Error("bindAsync failed because server is shutdown"));return}let J=I.address(),_;typeof J=="string"?_={path:J}:_={host:J.address,port:J.port};let g=(0,nn.registerChannelzSocket)((0,Un.subchannelAddressToString)(_),()=>({localAddress:_,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(g),this.http2ServerList.push({server:I,channelzRef:g}),this.trace("Successfully bound "+(0,Un.subchannelAddressToString)(_)),F("port"in _?_.port:E),I.removeListener("error",G)})})})).then(S=>{let M=0;for(let I of S)if(typeof I=="number"&&(M+=1,I!==E))throw new Error("Invalid state: multiple port numbers added from single address");return{port:E,count:M+T}}),d=b=>{if(b.length===0)return Promise.resolve({port:0,count:0});let E=b[0],T=c();return new Promise((S,M)=>{let I=F=>{this.trace("Failed to bind "+(0,Un.subchannelAddressToString)(E)+" with error "+F.message),S(d(b.slice(1)))};T.once("error",I),T.listen(E,()=>{if(this.shutdown){T.close(),S({port:0,count:0});return}let F=T.address(),P={host:F.address,port:F.port},G=(0,nn.registerChannelzSocket)((0,Un.subchannelAddressToString)(P),()=>({localAddress:P,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(G),this.http2ServerList.push({server:T,channelzRef:G}),this.trace("Successfully bound "+(0,Un.subchannelAddressToString)(P)),S(l(b.slice(1),F.port,1)),T.removeListener("error",I)})})},u={onSuccessfulResolution:(b,E,T)=>{if(u.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),b.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let S;(0,Un.isTcpSubchannelAddress)(b[0])?b[0].port===0?S=d(b):S=l(b,b[0].port,0):S=l(b,1,0),S.then(M=>{if(M.count===0){let I=`No address added out of total ${b.length} resolved`;sh.log(Bi.LogVerbosity.ERROR,I),a(new Error(I),0)}else M.count<b.length&&sh.log(Bi.LogVerbosity.INFO,`WARNING Only ${M.count} addresses added out of total ${b.length} resolved`),a(null,M.port)},M=>{let I=`No address added out of total ${b.length} resolved`;sh.log(Bi.LogVerbosity.ERROR,I),a(new Error(I),0)})},onError:b=>{a(new Error(b.details),0)}};(0,ok.createResolver)(s,u,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,nn.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(Dr.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,nn.unregisterChannelzRef)(this.channelzRef)}register(e,t,i,r,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:i,deserialize:r,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,nn.unregisterChannelzRef)(this.channelzRef),e(s)},i=0;function r(){i--,i===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(i++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,nn.unregisterChannelzRef)(o)),r()}));this.sessions.forEach((s,o)=>{o.closed||(i+=1,o.close(r))}),i===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let i=t[Dr.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof i!="string"||!i.startsWith("application/grpc")?(e.respond({[Dr.constants.HTTP2_HEADER_STATUS]:Dr.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,i=null){let r=new ws.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Bi.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,t){let i=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),i?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed();return}let r=t[ak],s=this._retrieveHandler(r);if(!s){this._respondWithError(iy(r),e,i);return}let o=new ws.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Bi.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),i&&(o.once("streamEnd",a=>{a?i.streamTracker.addCallSucceeded():i.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{i.messagesSent+=1,i.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{i.messagesReceived+=1,i.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),i?.streamTracker.addCallFailed(),o.sendError({code:Bi.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let i=t[ak],r=this._retrieveHandler(i);if(!r){this._respondWithError(iy(i),e,null);return}let s=new ws.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(s,r,t)||s.sendError({code:Bi.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,t,i){var r;let s=e.receiveMetadata(i),o=(r=s.get("grpc-encoding")[0])!==null&&r!==void 0?r:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")_V(e,t,s,o);else if(a==="clientStream")xV(e,t,s,o);else if(a==="serverStream")wV(e,t,s,o);else if(a==="bidi")EV(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),i="null";t&&(typeof t=="string"?i=t:i=t.address+":"+t.port),this.serverAddressString=i;let r=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",r.bind(this)),e.on("session",s=>{var o,a,c,l,d;if(!this.started){s.destroy();return}let u=(0,nn.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),f={ref:u,streamTracker:new nn.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,f);let b=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+b),this.sessionChildrenTracker.refChild(u));let E=null,T=null,S=!1;if(this.maxConnectionAgeMs!==oh){let I=this.maxConnectionAgeMs/10,F=Math.random()*I*2-I;E=(c=(a=setTimeout(()=>{var P,G;S=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+b);try{s.goaway(Dr.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==oh&&(T=(G=(P=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||G===void 0?void 0:G.call(P))},this.maxConnectionAgeMs+F)).unref)===null||c===void 0?void 0:c.call(a)}let M=(d=(l=setInterval(()=>{var I,F;let P=(F=(I=setTimeout(()=>{S=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+b),s.close()},this.keepaliveTimeoutMs)).unref)===null||F===void 0?void 0:F.call(I);try{s.ping((G,J,_)=>{clearTimeout(P)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||d===void 0?void 0:d.call(l);s.on("close",()=>{this.channelzEnabled&&(S||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+b),this.sessionChildrenTracker.unrefChild(u),(0,nn.unregisterChannelzRef)(u)),E&&clearTimeout(E),T&&clearTimeout(T),M&&clearTimeout(M),this.sessions.delete(s)})})}};ah.Server=ry;function _V(n,e,t,i){return w(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new ws.ServerUnaryCallImpl(n,t,r);e.func(s,(o,a,c,l)=>{n.sendUnaryMessage(o,a,c,l)})}catch(r){n.sendError(r)}})}function xV(n,e,t,i){let r=new ws.ServerReadableStreamImpl(n,t,e.deserialize,i);function s(o,a,c,l){r.destroy(),n.sendUnaryMessage(o,a,c,l)}n.cancelled||(r.on("error",s),e.func(r,s))}function wV(n,e,t,i){return w(this,null,function*(){try{let r=yield n.receiveUnaryMessage(i);if(r===void 0||n.cancelled)return;let s=new ws.ServerWritableStreamImpl(n,t,e.serialize,r);e.func(s)}catch(r){n.sendError(r)}})}function EV(n,e,t,i){let r=new ws.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,i);n.cancelled||e.func(r)}});var lk=A(ch=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});ch.StatusBuilder=void 0;var sy=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};ch.StatusBuilder=sy});var oy=A(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.isDuration=Mr.durationToMs=Mr.msToDuration=void 0;function TV(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}Mr.msToDuration=TV;function CV(n){return n.seconds*1e3+n.nanos/1e6|0}Mr.durationToMs=CV;function SV(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}Mr.isDuration=SV});var my=A(Rr=>{"use strict";var ay;Object.defineProperty(Rr,"__esModule",{value:!0});Rr.setup=Rr.OutlierDetectionLoadBalancer=Rr.OutlierDetectionLoadBalancingConfig=void 0;var dh=vn(),uk=_e(),Es=oy(),hk=py(),fk=cr(),kV=Gd(),IV=hr(),dk=ai(),AV=Zu(),DV=Je(),MV="outlier_detection";function St(n){DV.trace(uk.LogVerbosity.DEBUG,MV,n)}var fy="outlier_detection",RV=((ay=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&ay!==void 0?ay:"true")==="true",NV={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},OV={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function ea(n,e,t,i){if(e in n&&typeof n[e]!==t){let r=i?`${i}.${e}`:e;throw new Error(`outlier detection config ${r} parse error: expected ${t}, got ${typeof n[e]}`)}}function cy(n,e,t){let i=t?`${t}.${e}`:e;if(e in n){if(!(0,Es.isDuration)(n[e]))throw new Error(`outlier detection config ${i} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${i} parse error: values out of range for non-negative Duaration`)}}function lh(n,e,t){let i=t?`${t}.${e}`:e;if(ea(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${i} parse error: value out of range for percentage (0-100)`)}var Gc=class n{constructor(e,t,i,r,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=i??3e5,this.maxEjectionPercent=r??10,this.successRateEjection=s?Object.assign(Object.assign({},NV),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},OV),o):null}getLoadBalancerName(){return fy}toJsonObject(){return{interval:(0,Es.msToDuration)(this.intervalMs),base_ejection_time:(0,Es.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Es.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(cy(e,"interval"),cy(e,"base_ejection_time"),cy(e,"max_ejection_time"),lh(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");ea(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),lh(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),ea(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),ea(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");lh(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),lh(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),ea(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),ea(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,Es.durationToMs)(e.interval):null,e.base_ejection_time?(0,Es.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Es.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(fk.validateLoadBalancingConfig))}};Rr.OutlierDetectionLoadBalancingConfig=Gc;var dy=class extends AV.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((i,r,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,r,s,o)})}getConnectivityState(){return this.ejected?dh.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,dh.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,dh.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function ly(){return{success:0,failure:0}}var uy=class{constructor(){this.activeBucket=ly(),this.inactiveBucket=ly()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=ly()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},hy=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===IV.PickResultType.COMPLETE){let i=t.subchannel,r=i.getMapEntry();if(r){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===uk.Status.OK?r.counter.addSuccess():r.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:i.getWrappedSubchannel()})}else return t}},uh=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new kV.ChildLoadBalancerHandler((0,hk.createChildChannelControlHelper)(e,{createSubchannel:(t,i)=>{let r=e.createSubchannel(t,i),s=this.addressMap.get((0,dk.subchannelAddressToString)(t)),o=new dy(r,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,i)=>{t===dh.ConnectivityState.READY?e.updateState(t,new hy(i,this.isCountingEnabled())):e.updateState(t,i)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;St("Running success rate check");let i=t.request_volume,r=0,s=[];for(let[u,f]of this.addressMap){let b=f.counter.getLastSuccesses(),E=f.counter.getLastFailures();St("Stats for "+u+": successes="+b+" failures="+E+" targetRequestVolume="+i),b+E>=i&&(r+=1,s.push(b/(b+E)))}if(St("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),r<t.minimum_hosts)return;let o=s.reduce((u,f)=>u+f)/s.length,a=0;for(let u of s){let f=u-o;a+=f*f}let c=a/s.length,l=Math.sqrt(c),d=o-l*(t.stdev_factor/1e3);St("stdev="+l+" ejectionThreshold="+d);for(let[u,f]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let b=f.counter.getLastSuccesses(),E=f.counter.getLastFailures();if(b+E<i)continue;let T=b/(b+E);if(St("Checking candidate "+u+" successRate="+T),T<d){let S=Math.random()*100;St("Candidate "+u+" randomNumber="+S+" enforcement_percentage="+t.enforcement_percentage),S<t.enforcement_percentage&&(St("Ejecting candidate "+u),this.eject(f,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;St("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let i=0;for(let r of this.addressMap.values()){let s=r.counter.getLastSuccesses(),o=r.counter.getLastFailures();s+o>=t.request_volume&&(i+=1)}if(!(i<t.minimum_hosts))for(let[r,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(St("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let l=Math.random()*100;St("Candidate "+r+" randomNumber="+l+" enforcement_percentage="+t.enforcement_percentage),l<t.enforcement_percentage&&(St("Ejecting candidate "+r),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let i of e.subchannelWrappers)i.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,i;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(i=(t=this.ejectionTimer).unref)===null||i===void 0||i.call(t)}runChecks(){let e=new Date;if(St("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,i]of this.addressMap.entries())if(i.currentEjectionTimestamp===null)i.ejectionTimeMultiplier>0&&(i.ejectionTimeMultiplier-=1);else{let r=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(i.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(r*i.ejectionTimeMultiplier,Math.max(r,s))),o<new Date&&(St("Unejecting "+t),this.uneject(i))}}}updateAddressList(e,t,i){if(!(t instanceof Gc))return;let r=new Set;for(let o of e)r.add((0,dk.subchannelAddressToString)(o));for(let o of r)this.addressMap.has(o)||(St("Adding map entry for "+o),this.addressMap.set(o,{counter:new uy,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())r.has(o)||(St("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,fk.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,i),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){St("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else St("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{St("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return fy}};Rr.OutlierDetectionLoadBalancer=uh;function FV(){RV&&(0,hk.registerLoadBalancerType)(fy,uh,Gc)}Rr.setup=FV});var py=A(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.OutlierDetectionLoadBalancingConfig=te.BaseSubchannelWrapper=te.registerAdminService=te.FilterStackFactory=te.BaseFilter=te.PickResultType=te.QueuePicker=te.UnavailablePicker=te.ChildLoadBalancerHandler=te.subchannelAddressToString=te.validateLoadBalancingConfig=te.getFirstUsableConfig=te.registerLoadBalancerType=te.createChildChannelControlHelper=te.BackoffTimeout=te.durationToMs=te.uriToString=te.createResolver=te.registerResolver=te.log=te.trace=void 0;var mk=Je();Object.defineProperty(te,"trace",{enumerable:!0,get:function(){return mk.trace}});Object.defineProperty(te,"log",{enumerable:!0,get:function(){return mk.log}});var pk=si();Object.defineProperty(te,"registerResolver",{enumerable:!0,get:function(){return pk.registerResolver}});Object.defineProperty(te,"createResolver",{enumerable:!0,get:function(){return pk.createResolver}});var PV=dn();Object.defineProperty(te,"uriToString",{enumerable:!0,get:function(){return PV.uriToString}});var LV=oy();Object.defineProperty(te,"durationToMs",{enumerable:!0,get:function(){return LV.durationToMs}});var BV=hc();Object.defineProperty(te,"BackoffTimeout",{enumerable:!0,get:function(){return BV.BackoffTimeout}});var hh=cr();Object.defineProperty(te,"createChildChannelControlHelper",{enumerable:!0,get:function(){return hh.createChildChannelControlHelper}});Object.defineProperty(te,"registerLoadBalancerType",{enumerable:!0,get:function(){return hh.registerLoadBalancerType}});Object.defineProperty(te,"getFirstUsableConfig",{enumerable:!0,get:function(){return hh.getFirstUsableConfig}});Object.defineProperty(te,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return hh.validateLoadBalancingConfig}});var VV=ai();Object.defineProperty(te,"subchannelAddressToString",{enumerable:!0,get:function(){return VV.subchannelAddressToString}});var zV=Gd();Object.defineProperty(te,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return zV.ChildLoadBalancerHandler}});var gy=hr();Object.defineProperty(te,"UnavailablePicker",{enumerable:!0,get:function(){return gy.UnavailablePicker}});Object.defineProperty(te,"QueuePicker",{enumerable:!0,get:function(){return gy.QueuePicker}});Object.defineProperty(te,"PickResultType",{enumerable:!0,get:function(){return gy.PickResultType}});var qV=Mb();Object.defineProperty(te,"BaseFilter",{enumerable:!0,get:function(){return qV.BaseFilter}});var UV=Ib();Object.defineProperty(te,"FilterStackFactory",{enumerable:!0,get:function(){return UV.FilterStackFactory}});var jV=$d();Object.defineProperty(te,"registerAdminService",{enumerable:!0,get:function(){return jV.registerAdminService}});var GV=Zu();Object.defineProperty(te,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return GV.BaseSubchannelWrapper}});var HV=my();Object.defineProperty(te,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return HV.OutlierDetectionLoadBalancingConfig}})});var gk=A(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});fh.setup=void 0;var $V=si(),by=class{constructor(e,t,i){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let r;e.authority===""?r="/"+e.path:r=e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function WV(){(0,$V.registerResolver)("unix",by)}fh.setup=WV});var xk=A(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.setup=void 0;var bk=xe("net"),mh=_e(),yy=Jt(),yk=si(),vk=dn(),KV=Je(),QV="ip_resolver";function _k(n){KV.trace(mh.LogVerbosity.DEBUG,QV,n)}var vy="ipv4",_y="ipv6",YV=443,ph=class{constructor(e,t,i){var r;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,_k("Resolver constructed for target "+(0,vk.uriToString)(e));let s=[];if(!(e.scheme===vy||e.scheme===_y)){this.error={code:mh.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new yy.Metadata};return}let o=e.path.split(",");for(let a of o){let c=(0,vk.splitHostPort)(a);if(c===null){this.error={code:mh.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new yy.Metadata};return}if(e.scheme===vy&&!(0,bk.isIPv4)(c.host)||e.scheme===_y&&!(0,bk.isIPv6)(c.host)){this.error={code:mh.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new yy.Metadata};return}s.push({host:c.host,port:(r=c.port)!==null&&r!==void 0?r:YV})}this.addresses=s,_k("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function XV(){(0,yk.registerResolver)(vy,ph),(0,yk.registerResolver)(_y,ph)}gh.setup=XV});var Tk=A(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.setup=_i.PickFirstLoadBalancer=_i.shuffled=_i.PickFirstLoadBalancingConfig=void 0;var wk=cr(),Ft=vn(),bh=hr(),ZV=Je(),JV=_e(),ez="pick_first";function xy(n){ZV.trace(JV.LogVerbosity.DEBUG,ez,n)}var Hc="pick_first",tz=250,$c=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Hc}toJsonObject(){return{[Hc]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};_i.PickFirstLoadBalancingConfig=$c;var wy=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:bh.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function Ek(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let i=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[i],e[i]=r}return e}_i.shuffled=Ek;var yh=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=Ft.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.onSubchannelStateUpdate(t,i,r,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(Ft.ConnectivityState.READY,new wy(this.currentPick)):this.children.length===0?this.updateState(Ft.ConnectivityState.IDLE,new bh.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(Ft.ConnectivityState.TRANSIENT_FAILURE,new bh.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Ft.ConnectivityState.CONNECTING,new bh.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,i,r){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){i!==Ft.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){i===Ft.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),i===Ft.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,i]of this.children.entries())if(t>=e){let r=i.subchannel.getConnectivityState();if(r===Ft.ConnectivityState.IDLE||r===Ft.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,i;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===Ft.ConnectivityState.IDLE&&(xy("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var r;(r=this.children[e])===null||r===void 0||r.subchannel.startConnecting()})),this.connectionDelayTimeout=(i=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},tz)).unref)===null||i===void 0?void 0:i.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(xy("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){xy(Ft.ConnectivityState[this.currentState]+" -> "+Ft.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(i=>({subchannel:this.channelControlHelper.createSubchannel(i,{}),hasReportedTransientFailure:!1}));for(let{subchannel:i}of t)i.ref(),this.channelControlHelper.addChannelzChild(i.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:i}of this.children)if(i.addConnectivityStateListener(this.subchannelStateListener),i.getConnectivityState()===Ft.ConnectivityState.READY){this.pickSubchannel(i);return}for(let i of this.children)i.subchannel.getConnectivityState()===Ft.ConnectivityState.TRANSIENT_FAILURE&&(i.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof $c&&(t.getShuffleAddressList()&&(e=Ek(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===Ft.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Hc}};_i.PickFirstLoadBalancer=yh;function nz(){(0,wk.registerLoadBalancerType)(Hc,yh,$c),(0,wk.registerDefaultLoadBalancerType)(Hc)}_i.setup=nz});var Sk=A(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.setup=ta.RoundRobinLoadBalancer=void 0;var iz=cr(),Pt=vn(),vh=hr(),rz=ai(),sz=Je(),oz=_e(),az="round_robin";function Ck(n){sz.trace(oz.LogVerbosity.DEBUG,az,n)}var _h="round_robin",Ey=class n{getLoadBalancerName(){return _h}constructor(){}toJsonObject(){return{[_h]:{}}}static createFromJson(e){return new n}},Ty=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:vh.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},xh=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=Pt.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,i,r,s,o)=>{this.calculateAndUpdateState(),(r===Pt.ConnectivityState.TRANSIENT_FAILURE||r===Pt.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(Pt.ConnectivityState.READY)>0){let e=this.subchannels.filter(i=>i.getConnectivityState()===Pt.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(Pt.ConnectivityState.READY,new Ty(e,t))}else this.countSubchannelsWithState(Pt.ConnectivityState.CONNECTING)>0?this.updateState(Pt.ConnectivityState.CONNECTING,new vh.QueuePicker(this)):this.countSubchannelsWithState(Pt.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(Pt.ConnectivityState.TRANSIENT_FAILURE,new vh.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Pt.ConnectivityState.IDLE,new vh.QueuePicker(this))}updateState(e,t){Ck(Pt.ConnectivityState[this.currentState]+" -> "+Pt.ConnectivityState[e]),e===Pt.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),Ck("Connect to address list "+e.map(i=>(0,rz.subchannelAddressToString)(i))),this.subchannels=e.map(i=>this.channelControlHelper.createSubchannel(i,{}));for(let i of this.subchannels){i.ref(),i.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(i.getChannelzRef());let r=i.getConnectivityState();(r===Pt.ConnectivityState.IDLE||r===Pt.ConnectivityState.TRANSIENT_FAILURE)&&i.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return _h}};ta.RoundRobinLoadBalancer=xh;function cz(){(0,iz.registerLoadBalancerType)(_h,xh,Ey)}ta.setup=cz});var Dk=A(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.experimental=H.addAdminServicesToServer=H.getChannelzHandlers=H.getChannelzServiceDefinition=H.InterceptorConfigurationError=H.InterceptingCall=H.RequesterBuilder=H.ListenerBuilder=H.StatusBuilder=H.getClientChannel=H.ServerCredentials=H.Server=H.setLogVerbosity=H.setLogger=H.load=H.loadObject=H.CallCredentials=H.ChannelCredentials=H.waitForClientReady=H.closeClient=H.Channel=H.makeGenericClientConstructor=H.makeClientConstructor=H.loadPackageDefinition=H.Client=H.compressionAlgorithms=H.propagate=H.connectivityState=H.status=H.logVerbosity=H.Metadata=H.credentials=void 0;var wh=_p();Object.defineProperty(H,"CallCredentials",{enumerable:!0,get:function(){return wh.CallCredentials}});var lz=Zp();Object.defineProperty(H,"Channel",{enumerable:!0,get:function(){return lz.ChannelImplementation}});var dz=Ab();Object.defineProperty(H,"compressionAlgorithms",{enumerable:!0,get:function(){return dz.CompressionAlgorithms}});var uz=vn();Object.defineProperty(H,"connectivityState",{enumerable:!0,get:function(){return uz.ConnectivityState}});var Eh=Ld();Object.defineProperty(H,"ChannelCredentials",{enumerable:!0,get:function(){return Eh.ChannelCredentials}});var kk=Xp();Object.defineProperty(H,"Client",{enumerable:!0,get:function(){return kk.Client}});var Cy=_e();Object.defineProperty(H,"logVerbosity",{enumerable:!0,get:function(){return Cy.LogVerbosity}});Object.defineProperty(H,"status",{enumerable:!0,get:function(){return Cy.Status}});Object.defineProperty(H,"propagate",{enumerable:!0,get:function(){return Cy.Propagate}});var Ik=Je(),Sy=eg();Object.defineProperty(H,"loadPackageDefinition",{enumerable:!0,get:function(){return Sy.loadPackageDefinition}});Object.defineProperty(H,"makeClientConstructor",{enumerable:!0,get:function(){return Sy.makeClientConstructor}});Object.defineProperty(H,"makeGenericClientConstructor",{enumerable:!0,get:function(){return Sy.makeClientConstructor}});var hz=Jt();Object.defineProperty(H,"Metadata",{enumerable:!0,get:function(){return hz.Metadata}});var fz=ck();Object.defineProperty(H,"Server",{enumerable:!0,get:function(){return fz.Server}});var mz=ny();Object.defineProperty(H,"ServerCredentials",{enumerable:!0,get:function(){return mz.ServerCredentials}});var pz=lk();Object.defineProperty(H,"StatusBuilder",{enumerable:!0,get:function(){return pz.StatusBuilder}});H.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),combineCallCredentials:(n,...e)=>e.reduce((t,i)=>t.compose(i),n),createInsecure:Eh.ChannelCredentials.createInsecure,createSsl:Eh.ChannelCredentials.createSsl,createFromSecureContext:Eh.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:wh.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:wh.CallCredentials.createFromGoogleCredential,createEmpty:wh.CallCredentials.createEmpty};var gz=n=>n.close();H.closeClient=gz;var bz=(n,e,t)=>n.waitForReady(e,t);H.waitForClientReady=bz;var yz=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};H.loadObject=yz;var vz=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};H.load=vz;var _z=n=>{Ik.setLogger(n)};H.setLogger=_z;var xz=n=>{Ik.setLoggerVerbosity(n)};H.setLogVerbosity=xz;var wz=n=>kk.Client.prototype.getChannel.call(n);H.getClientChannel=wz;var Th=Kp();Object.defineProperty(H,"ListenerBuilder",{enumerable:!0,get:function(){return Th.ListenerBuilder}});Object.defineProperty(H,"RequesterBuilder",{enumerable:!0,get:function(){return Th.RequesterBuilder}});Object.defineProperty(H,"InterceptingCall",{enumerable:!0,get:function(){return Th.InterceptingCall}});Object.defineProperty(H,"InterceptorConfigurationError",{enumerable:!0,get:function(){return Th.InterceptorConfigurationError}});var Ak=_s();Object.defineProperty(H,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Ak.getChannelzServiceDefinition}});Object.defineProperty(H,"getChannelzHandlers",{enumerable:!0,get:function(){return Ak.getChannelzHandlers}});var Ez=$d();Object.defineProperty(H,"addAdminServicesToServer",{enumerable:!0,get:function(){return Ez.addAdminServicesToServer}});var Tz=py();H.experimental=Tz;var Cz=gb(),Sz=gk(),kz=xk(),Iz=Tk(),Az=Sk(),Dz=my(),Mz=_s();Cz.setup(),Sz.setup(),kz.setup(),Iz.setup(),Az.setup(),Dz.setup(),Mz.setup()});var qx=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(q(pm),q($e))}}static{this.\u0275dir=we({type:n})}}return n})(),TM=(()=>{class n extends qx{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=fm(n)))(r||n)}})()}static{this.\u0275dir=we({type:n,features:[ti]})}}return n})(),pd=new ee("");var CM={provide:pd,useExisting:rs(()=>lo),multi:!0};function SM(){let n=ym()?ym().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var kM=new ee(""),lo=(()=>{class n extends qx{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!SM())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(q(pm),q($e),q(kM,8))}}static{this.\u0275dir=we({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&Re("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[cn([CM]),ti]})}}return n})();function tr(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function Ux(n){return n!=null&&typeof n.length=="number"}var ac=new ee(""),Sm=new ee(""),IM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ad=class{static min(e){return AM(e)}static max(e){return DM(e)}static required(e){return MM(e)}static requiredTrue(e){return RM(e)}static email(e){return NM(e)}static minLength(e){return OM(e)}static maxLength(e){return FM(e)}static pattern(e){return PM(e)}static nullValidator(e){return jx(e)}static compose(e){return Qx(e)}static composeAsync(e){return Yx(e)}};function AM(n){return e=>{if(tr(e.value)||tr(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function DM(n){return e=>{if(tr(e.value)||tr(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function MM(n){return tr(n.value)?{required:!0}:null}function RM(n){return n.value===!0?null:{required:!0}}function NM(n){return tr(n.value)||IM.test(n.value)?null:{email:!0}}function OM(n){return e=>tr(e.value)||!Ux(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function FM(n){return e=>Ux(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function PM(n){if(!n)return jx;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(tr(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function jx(n){return null}function Gx(n){return n!=null}function Hx(n){return bx(n)?Zn(n):n}function $x(n){let e={};return n.forEach(t=>{e=t!=null?ke(ke({},e),t):e}),Object.keys(e).length===0?null:e}function Wx(n,e){return e.map(t=>t(n))}function LM(n){return!n.validate}function Kx(n){return n.map(e=>LM(e)?e:t=>e.validate(t))}function Qx(n){if(!n)return null;let e=n.filter(Gx);return e.length==0?null:function(t){return $x(Wx(t,e))}}function km(n){return n!=null?Qx(Kx(n)):null}function Yx(n){if(!n)return null;let e=n.filter(Gx);return e.length==0?null:function(t){let i=Wx(t,e).map(Hx);return sx(i).pipe(nt($x))}}function Im(n){return n!=null?Yx(Kx(n)):null}function Ox(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Xx(n){return n._rawValidators}function Zx(n){return n._rawAsyncValidators}function Tm(n){return n?Array.isArray(n)?n:[n]:[]}function cd(n,e){return Array.isArray(n)?n.includes(e):n===e}function Fx(n,e){let t=Tm(e);return Tm(n).forEach(r=>{cd(t,r)||t.push(r)}),t}function Px(n,e){return Tm(e).filter(t=>!cd(n,t))}var ld=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=km(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Im(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},cs=class extends ld{get formDirective(){return null}get path(){return null}},ls=class extends ld{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Cm=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},BM={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},a8=Yn(ke({},BM),{"[class.ng-submitted]":"isSubmitted"}),gd=(()=>{class n extends Cm{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(q(ls,2))}}static{this.\u0275dir=we({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&ze("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[ti]})}}return n})();var rc="VALID",od="INVALID",co="PENDING",sc="DISABLED";function Jx(n){return(bd(n)?n.validators:n)||null}function VM(n){return Array.isArray(n)?km(n):n||null}function ew(n,e){return(bd(e)?e.asyncValidators:n)||null}function zM(n){return Array.isArray(n)?Im(n):n||null}function bd(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function qM(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new so(1e3,"");if(!i[t])throw new so(1001,"")}function UM(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new so(1002,"")})}var dd=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===rc}get invalid(){return this.status===od}get pending(){return this.status==co}get disabled(){return this.status===sc}get enabled(){return this.status!==sc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Fx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Fx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Px(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Px(e,this._rawAsyncValidators))}hasValidator(e){return cd(this._rawValidators,e)}hasAsyncValidator(e){return cd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=co,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=sc,this.errors=null,this._forEachChild(i=>{i.disable(Yn(ke({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Yn(ke({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=rc,this._forEachChild(i=>{i.enable(Yn(ke({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Yn(ke({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===rc||this.status===co)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sc:rc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=co,this._hasOwnPendingAsyncValidator=!0;let t=Hx(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new on,this.statusChanges=new on}_calculateStatus(){return this._allControlsDisabled()?sc:this.errors?od:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(co)?co:this._anyControlsHaveStatus(od)?od:rc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){bd(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=VM(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=zM(this._rawAsyncValidators)}},ud=class extends dd{constructor(e,t,i){super(Jx(t),ew(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){UM(this,!0,e),Object.keys(e).forEach(i=>{qM(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var yd=new ee("CallSetDisabledState",{providedIn:"root",factory:()=>Am}),Am="always";function jM(n,e){return[...e.path,n]}function hd(n,e,t=Am){Dm(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),HM(n,e),WM(n,e),$M(n,e),GM(n,e)}function Lx(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),md(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function fd(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function GM(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Dm(n,e){let t=Xx(n);e.validator!==null?n.setValidators(Ox(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=Zx(n);e.asyncValidator!==null?n.setAsyncValidators(Ox(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();fd(e._rawValidators,r),fd(e._rawAsyncValidators,r)}function md(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=Xx(n);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let r=Zx(n);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}let i=()=>{};return fd(e._rawValidators,i),fd(e._rawAsyncValidators,i),t}function HM(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&tw(n,e)})}function $M(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&tw(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function tw(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function WM(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function nw(n,e){n==null,Dm(n,e)}function KM(n,e){return md(n,e)}function QM(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function YM(n){return Object.getPrototypeOf(n.constructor)===TM}function iw(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function XM(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(s=>{s.constructor===lo?t=s:YM(s)?i=s:r=s}),r||i||t||null}function ZM(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var JM={provide:cs,useExisting:rs(()=>Mm)},oc=Promise.resolve(),Mm=(()=>{class n extends cs{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new on,this.form=new ud({},km(t),Im(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){oc.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),hd(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){oc.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){oc.then(()=>{let i=this._findContainer(t.path),r=new ud({});nw(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){oc.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){oc.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,iw(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(i){return new(i||n)(q(ac,10),q(Sm,10),q(yd,8))}}static{this.\u0275dir=we({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&Re("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:[le.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[cn([JM]),ti]})}}return n})();function Bx(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Vx(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var rw=class extends dd{constructor(e=null,t,i){super(Jx(t),ew(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),bd(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Vx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Bx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Bx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Vx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var eR=n=>n instanceof rw;var tR={provide:ls,useExisting:rs(()=>cc)},zx=Promise.resolve(),cc=(()=>{class n extends ls{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new rw,this._registered=!1,this.name="",this.update=new on,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=XM(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),QM(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){hd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){zx.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&jt(i);zx.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?jM(t,this._parent):[t]}static{this.\u0275fac=function(i){return new(i||n)(q(cs,9),q(ac,10),q(Sm,10),q(pd,10),q(os,8),q(yd,8))}}static{this.\u0275dir=we({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[le.None,"disabled","isDisabled"],model:[le.None,"ngModel","model"],options:[le.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[cn([tR]),ti,Yi]})}}return n})();var nR={provide:cs,useExisting:rs(()=>Rm)},Rm=(()=>{class n extends cs{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new on,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(md(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return hd(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){Lx(t.control||null,t,!1),ZM(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,iw(this.form,this.directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(Lx(i||null,t),eR(r)&&(hd(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);nw(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&KM(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Dm(this.form,this),this._oldForm&&md(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(i){return new(i||n)(q(ac,10),q(Sm,10),q(yd,8))}}static{this.\u0275dir=we({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&Re("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{form:[le.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[cn([nR]),ti,Yi]})}}return n})();var iR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({})}}return n})();var sw=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:yd,useValue:t.callSetDisabledState??Am}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[iR]})}}return n})();var rR=[],ow=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[_m.forRoot(rR),_m]})}}return n})();var Fm;try{Fm=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Fm=!1}var xt=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?vx(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Fm)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(j(Xi))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var uo,aw=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Pm(){if(uo)return uo;if(typeof document!="object"||!document)return uo=new Set(aw),uo;let n=document.createElement("input");return uo=new Set(aw.filter(e=>(n.setAttribute("type",e),n.type===e))),uo}var lc;function sR(){if(lc==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>lc=!0}))}finally{lc=lc||!1}return lc}function nr(n){return sR()?n:!!n.capture}var Om;function oR(){if(Om==null){let n=typeof document<"u"?document.head:null;Om=!!(n&&(n.createShadowRoot||n.attachShadow))}return Om}function cw(n){if(oR()){let e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function ir(n){return n.composedPath?n.composedPath()[0]:n.target}function lw(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function ii(n){return n!=null&&`${n}`!="false"}function Lm(n){return Array.isArray(n)?n:[n]}function ri(n){return n instanceof $e?n.nativeElement:n}var aR=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var dw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({providers:[aR]})}}return n})();var uw=new Set,us,cR=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):dR}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&lR(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(j(xt),j(ux,8))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function lR(n,e){if(!uw.has(n))try{us||(us=document.createElement("style"),e&&us.setAttribute("nonce",e),us.setAttribute("type","text/css"),document.head.appendChild(us)),us.sheet&&(us.sheet.insertRule(`@media ${n} {body{ }}`,0),uw.add(n))}catch(t){console.error(t)}}function dR(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var fw=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Rt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return hw(Lm(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=hw(Lm(t)).map(o=>this._registerQuery(o).observable),s=ix(r);return s=rx(s.pipe(dm(1)),s.pipe(Yl(1),lm(0))),s.pipe(nt(o=>{let a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),s={observable:new Xn(o=>{let a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(ro(i),nt(({matches:o})=>({query:t,matches:o})),ei(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(j(cR),j(de))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function hw(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function Vm(n){return n.buttons===0||n.detail===0}function zm(n){let e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var uR=new ee("cdk-input-modality-detector-options"),hR={ignoreKeys:[18,17,224,91,16]},gw=650,ho=nr({passive:!0,capture:!0}),fR=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new ex(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=ir(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<gw||(this._modality.next(Vm(o)?"keyboard":"mouse"),this._mostRecentTarget=ir(o))},this._onTouchstart=o=>{if(zm(o)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=ir(o)},this._options=ke(ke({},hR),s),this.modalityDetected=this._modality.pipe(Yl(1)),this.modalityChanged=this.modalityDetected.pipe(Wl()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,ho),r.addEventListener("mousedown",this._onMousedown,ho),r.addEventListener("touchstart",this._onTouchstart,ho)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ho),document.removeEventListener("mousedown",this._onMousedown,ho),document.removeEventListener("touchstart",this._onTouchstart,ho))}static{this.\u0275fac=function(i){return new(i||n)(j(xt),j(de),j(ln),j(uR,8))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var _d=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(_d||{}),mR=new ee("cdk-focus-monitor-default-options"),vd=nr({passive:!0,capture:!0}),bw=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Rt,this._rootNodeFocusAndBlurListener=a=>{let c=ir(a);for(let l=c;l;l=l.parentElement)a.type==="focus"?this._onFocus(a,l):this._onBlur(a,l)},this._document=s,this._detectionMode=o?.detectionMode||_d.IMMEDIATE}monitor(t,i=!1){let r=ri(t);if(!this._platform.isBrowser||r.nodeType!==1)return Jn();let s=cw(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;let a={checkChildren:i,subject:new Rt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){let i=ri(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){let s=ri(t),o=this._getDocument().activeElement;s===o?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,i,c)):(this._setOrigin(i),typeof s.focus=="function"&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===_d.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused",i==="touch"),t.classList.toggle("cdk-keyboard-focused",i==="keyboard"),t.classList.toggle("cdk-mouse-focused",i==="mouse"),t.classList.toggle("cdk-program-focused",i==="program")}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=t,this._originFromTouchInteraction=t==="touch"&&i,this._detectionMode===_d.IMMEDIATE){clearTimeout(this._originTimeoutId);let r=this._originFromTouchInteraction?gw:1;this._originTimeoutId=setTimeout(()=>this._origin=null,r)}})}_onFocus(t,i){let r=this._elementInfo.get(i),s=ir(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){let r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;let i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,vd),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,vd)}),this._rootNodeFocusListenerCount.set(i,r+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ei(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){let i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){let r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,vd),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,vd),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){let i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){let{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if(r!=="mouse"||!i||i===t||t.nodeName!=="INPUT"&&t.nodeName!=="TEXTAREA"||t.disabled)return!1;let s=t.labels;if(s){for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0}return!1}static{this.\u0275fac=function(i){return new(i||n)(j(de),j(xt),j(fR),j(ln,8),j(mR,8))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var hs=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(hs||{}),mw="cdk-high-contrast-black-on-white",pw="cdk-high-contrast-white-on-black",Bm="cdk-high-contrast-active",yw=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=He(fw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return hs.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return hs.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return hs.BLACK_ON_WHITE}return hs.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(Bm,mw,pw),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===hs.BLACK_ON_WHITE?t.add(Bm,mw):i===hs.WHITE_ON_BLACK&&t.add(Bm,pw)}}static{this.\u0275fac=function(i){return new(i||n)(j(xt),j(ln))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var gR=new ee("cdk-dir-doc",{providedIn:"root",factory:bR});function bR(){return He(ln)}var yR=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function vR(n){let e=n?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?yR.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var vw=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new on,t){let i=t.body?t.body.dir:null,r=t.documentElement?t.documentElement.dir:null;this.value=vR(i||r||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||n)(j(gR,8))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var qm=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({})}}return n})();var wR=["mat-internal-form-field",""],ER=["*"];function TR(){return!0}var CR=new ee("mat-sanity-checks",{providedIn:"root",factory:TR}),ft=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return lw()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[t]}static{this.\u0275fac=function(i){return new(i||n)(j(yw),j(CR,8),j(ln))}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[qm,qm]})}}return n})();var wd=class{constructor(e,t,i,r,s){this._defaultMatcher=e,this.ngControl=t,this._parentFormGroup=i,this._parentForm=r,this._stateChanges=s,this.errorState=!1}updateErrorState(){let e=this.errorState,t=this._parentFormGroup||this._parentForm,i=this.matcher||this._defaultMatcher,r=this.ngControl?this.ngControl.control:null,s=i?.isErrorState(r,t)??!1;s!==e&&(this.errorState=s,this._stateChanges.next())}};var Iw=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var bn=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(bn||{}),Gm=class{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=bn.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},_w=nr({passive:!0,capture:!0}),Hm=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=ir(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){let s=this._events.get(t);if(s){let o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,_w)})}removeHandler(e,t,i){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(i),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,_w)))}},xw={enterDuration:225,exitDuration:150},SR=800,ww=nr({passive:!0,capture:!0}),Ew=["mousedown","touchstart"],Tw=["mouseup","mouseleave","touchend","touchcancel"],$m=class n{static{this._eventManager=new Hm}constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ri(i))}fadeInRipple(e,t,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=ke(ke({},xw),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let o=i.radius||kR(e,t,r),a=e-r.left,c=t-r.top,l=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=`${a-o}px`,d.style.top=`${c-o}px`,d.style.height=`${o*2}px`,d.style.width=`${o*2}px`,i.color!=null&&(d.style.backgroundColor=i.color),d.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(d);let u=window.getComputedStyle(d),f=u.transitionProperty,b=u.transitionDuration,E=f==="none"||b==="0s"||b==="0s, 0s"||r.width===0&&r.height===0,T=new Gm(this,d,i,E);d.style.transform="scale3d(1, 1, 1)",T.state=bn.FADING_IN,i.persistent||(this._mostRecentTransientRipple=T);let S=null;return!E&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let M=()=>this._finishRippleTransition(T),I=()=>this._destroyRipple(T);d.addEventListener("transitionend",M),d.addEventListener("transitioncancel",I),S={onTransitionEnd:M,onTransitionCancel:I}}),this._activeRipples.set(T,S),(E||!l)&&this._finishRippleTransition(T),T}fadeOutRipple(e){if(e.state===bn.FADING_OUT||e.state===bn.HIDDEN)return;let t=e.element,i=ke(ke({},xw),e.config.animation);t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=bn.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=ri(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,Ew.forEach(i=>{n._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Tw.forEach(t=>{this._triggerElement.addEventListener(t,this,ww)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===bn.FADING_IN?this._startFadeOutTransition(e):e.state===bn.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=bn.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=bn.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){let t=Vm(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+SR;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!zm(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===bn.VISIBLE||e.config.terminateOnPointerUp&&e.state===bn.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(Ew.forEach(t=>n._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(Tw.forEach(t=>e.removeEventListener(t,this,ww)),this._pointerUpEventsRegistered=!1))}};function kR(n,e,t){let i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}var Aw=new ee("mat-ripple-global-options"),Ed=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new $m(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:ke(ke(ke({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return typeof t=="number"?this._rippleRenderer.fadeInRipple(t,i,ke(ke({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,ke(ke({},this.rippleConfig),t))}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(de),q(xt),q(Aw,8),q(Rn,8))}}static{this.\u0275dir=we({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){i&2&&ze("mat-ripple-unbounded",r.unbounded)},inputs:{color:[le.None,"matRippleColor","color"],unbounded:[le.None,"matRippleUnbounded","unbounded"],centered:[le.None,"matRippleCentered","centered"],radius:[le.None,"matRippleRadius","radius"],animation:[le.None,"matRippleAnimation","animation"],disabled:[le.None,"matRippleDisabled","disabled"],trigger:[le.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return n})(),Dw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,ft]})}}return n})();var Cw={capture:!0},Sw=["focus","click","mouseenter","touchstart"],Um="mat-ripple-loader-uninitialized",jm="mat-ripple-loader-class-name",kw="mat-ripple-loader-centered",xd="mat-ripple-loader-disabled",Mw=(()=>{class n{constructor(){this._document=He(ln,{optional:!0}),this._animationMode=He(Rn,{optional:!0}),this._globalRippleOptions=He(Aw,{optional:!0}),this._platform=He(xt),this._ngZone=He(de),this._hosts=new Map,this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;let r=t.target.closest(`[${Um}]`);r&&this._createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(let t of Sw)this._document?.addEventListener(t,this._onInteraction,Cw)})}ngOnDestroy(){let t=this._hosts.keys();for(let i of t)this.destroyRipple(i);for(let i of Sw)this._document?.removeEventListener(i,this._onInteraction,Cw)}configureRipple(t,i){t.setAttribute(Um,""),(i.className||!t.hasAttribute(jm))&&t.setAttribute(jm,i.className||""),i.centered&&t.setAttribute(kw,""),i.disabled&&t.setAttribute(xd,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,i){let r=this._hosts.get(t);if(r){r.disabled=i;return}i?t.setAttribute(xd,""):t.removeAttribute(xd)}_createRipple(t){if(!this._document)return;let i=this._hosts.get(t);if(i)return i;t.querySelector(".mat-ripple")?.remove();let r=this._document.createElement("span");r.classList.add("mat-ripple",t.getAttribute(jm)),t.append(r);let s=new Ed(new $e(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=t,s.centered=t.hasAttribute(kw),s.disabled=t.hasAttribute(xd),this.attachRipple(t,s),s}attachRipple(t,i){t.removeAttribute(Um),this._hosts.set(t,i)}destroyRipple(t){let i=this._hosts.get(t);i&&(i.ngOnDestroy(),this._hosts.delete(t))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Rw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=dt({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){i&2&&ze("mdc-form-field--align-end",r.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[Yt],attrs:wR,ngContentSelectors:ER,decls:1,vars:0,template:function(i,r){i&1&&(gn(),qe(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}}return n})();var AR=["*"];var DR=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],MR=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],RR=new ee("MAT_CARD_CONFIG"),Nw=(()=>{class n{constructor(t){this.appearance=t?.appearance||"raised"}static{this.\u0275fac=function(i){return new(i||n)(q(RR,8))}}static{this.\u0275cmp=dt({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,r){i&2&&ze("mat-mdc-card-outlined",r.appearance==="outlined")("mdc-card--outlined",r.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[Yt],ngContentSelectors:AR,decls:1,vars:0,template:function(i,r){i&1&&(gn(),qe(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}}return n})(),Ow=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"],standalone:!0})}}return n})();var Fw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"],standalone:!0})}}return n})();var Pw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=dt({type:n,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],standalone:!0,features:[Yt],ngContentSelectors:MR,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(i,r){i&1&&(gn(DR),qe(0),$(1,"div",0),qe(2,1),W(),qe(3,2))},encapsulation:2,changeDetection:0})}}return n})();var Lw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n,selectors:[["","mat-card-avatar",""],["","matCardAvatar",""]],hostAttrs:[1,"mat-mdc-card-avatar"],standalone:!0})}}return n})();var Td=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,nd,ft]})}}return n})();var Cd=(()=>{class n{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=ii(t)}get inset(){return this._inset}set inset(t){this._inset=ii(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=dt({type:n,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(i,r){i&2&&(qt("aria-orientation",r.vertical?"vertical":"horizontal"),ze("mat-divider-vertical",r.vertical)("mat-divider-horizontal",!r.vertical)("mat-divider-inset",r.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[Yt],decls:0,vars:0,template:function(i,r){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}}return n})(),Bw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,ft]})}}return n})();var OR="firebase",FR="10.14.1";er(OR,FR,"app");var fo=new Jl("ANGULARFIRE2_VERSION");var PR=(n,e)=>{let t=e?[e]:Nx(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},fs=class{constructor(){return PR(LR)}},LR="app-check";function Wm(){}var Sd=class{zone;delegate;constructor(e,t=tx){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},Km=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Wm,{},Wm,Wm)),t.pipe(hm({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},kd=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Sd(Zone.current)),this.insideAngular=t.run(()=>new Sd(Zone.current,Gl)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(j(de))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function BR(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Zt(n){return VR(BR())(n)}function VR(n){return function(t){return t=t.lift(new Km(n.ngZone)),t.pipe(io(n.outsideAngular),ns(n.insideAngular))}}var UR=new Map,jR={activated:!1,tokenObservers:[]},GR={initialized:!1,enabled:!1};function On(n){return UR.get(n)||Object.assign({},jR)}function Hw(){return GR}var HR="https://content-firebaseappcheck.googleapis.com/v1";var $R="exchangeDebugToken",qw={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},i$=24*60*60*1e3;var Ym=class{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return w(this,null,function*(){this.stop();try{this.pending=new xm,this.pending.promise.catch(t=>{}),yield WR(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new xm,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function WR(n){return new Promise(e=>{setTimeout(e,n)})}var KR={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},rr=new Mx("appCheck","AppCheck",KR);function $w(n){if(!On(n).activated)throw rr.create("use-before-activation",{appName:n.name})}function Ww(i,r){return w(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let b=yield o.getHeartbeatsHeader();b&&(s["X-Firebase-Client"]=b)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(b){throw rr.create("fetch-network-error",{originalErrorMessage:b?.message})}if(c.status!==200)throw rr.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(b){throw rr.create("fetch-parse-error",{originalErrorMessage:b?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw rr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let u=Number(d[1])*1e3,f=Date.now();return{token:l.token,expireTimeMillis:f+u,issuedAtTimeMillis:f}})}function Kw(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${HR}/projects/${t}/apps/${i}:${$R}?key=${r}`,body:{debug_token:e}}}var QR="firebase-app-check-database",YR=1,Xm="firebase-app-check-store";var Id=null;function XR(){return Id||(Id=new Promise((n,e)=>{try{let t=indexedDB.open(QR,YR);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(rr.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(Xm,{keyPath:"compositeKey"})}}}catch(t){e(rr.create("storage-open",{originalErrorMessage:t?.message}))}}),Id)}function ZR(n,e){return JR(eN(n),e)}function JR(n,e){return w(this,null,function*(){let i=(yield XR()).transaction(Xm,"readwrite"),s=i.objectStore(Xm).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},i.onerror=c=>{var l;a(rr.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function eN(n){return`${n.options.appId}-${n.name}`}var Zm=new sd("@firebase/app-check");function Qm(n,e){return rd()?ZR(n,e).catch(t=>{Zm.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Qw(){return Hw().enabled}function Yw(){return w(this,null,function*(){let n=Hw();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var tN={error:"UNKNOWN_ERROR"};function nN(n){return Ix.encodeString(JSON.stringify(n),!1)}function Jm(n,e=!1){return w(this,null,function*(){let t=n.app;$w(t);let i=On(t),r=i.token,s;if(r&&!dc(r)&&(i.token=void 0,r=void 0),!r){let c=yield i.cachedTokenPromise;c&&(dc(c)?r=c:yield Qm(t,void 0))}if(!e&&r&&dc(r))return{token:r.token};let o=!1;if(Qw()){i.exchangeTokenPromise||(i.exchangeTokenPromise=Ww(Kw(t,yield Yw()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let c=yield i.exchangeTokenPromise;return yield Qm(t,c),i.token=c,{token:c.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=yield On(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Zm.warn(c.message):Zm.error(c),s=c}let a;return r?s?dc(r)?a={token:r.token,internalError:s}:a=jw(s):(a={token:r.token},i.token=r,yield Qm(t,r)):a=jw(s),o&&oN(t,a),a})}function iN(n){return w(this,null,function*(){let e=n.app;$w(e);let{provider:t}=On(e);if(Qw()){let i=yield Yw(),{token:r}=yield Ww(Kw(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function rN(n,e,t,i){let{app:r}=n,s=On(r),o={next:t,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&dc(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),Uw(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Uw(n))}function Xw(n,e){let t=On(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function Uw(n){let{app:e}=n,t=On(e),i=t.tokenRefresher;i||(i=sN(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function sN(n){let{app:e}=n;return new Ym(()=>w(this,null,function*(){let t=On(e),i;if(t.token?i=yield Jm(n,!0):i=yield Jm(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=On(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},qw.RETRIAL_MIN_WAIT,qw.RETRIAL_MAX_WAIT)}function oN(n,e){let t=On(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function dc(n){return n.expireTimeMillis-Date.now()>0}function jw(n){return{token:nN(tN),error:n}}var ep=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=On(this.app);for(let t of e)Xw(this.app,t.next);return Promise.resolve()}};function aN(n,e){return new ep(n,e)}function cN(n){return{getToken:e=>Jm(n,e),getLimitedUseToken:()=>iN(n),addTokenListener:e=>rN(n,"INTERNAL",e),removeTokenListener:e=>Xw(n.app,e)}}var lN="@firebase/app-check",dN="0.8.8";var uN="app-check",Gw="app-check-internal";function hN(){ic(new as(uN,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return aN(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Gw).initialize()})),ic(new as(Gw,n=>{let e=n.getProvider("app-check").getImmediate();return cN(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),er(lN,dN)}hN();var fN=["localhost","0.0.0.0","127.0.0.1"],p$=typeof window<"u"&&fN.includes(window.location.hostname);var mN="firebase",pN="10.14.1";Xt.registerVersion(mN,pN,"app-compat");var gN=["ngOnDestroy"],eE=(n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(gN.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(d=>{let u=d?.(...l);return i?.spy?.apply&&i.spy.apply(s,l,u),u})})})});var Ad=class{constructor(e){return e}},mo=new ee("angularfire2.app.options"),po=new ee("angularfire2.app.name");function uc(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=Xt.apps.filter(a=>a&&a.name===r.name)[0]||e.runOutsideAngular(()=>Xt.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;bN("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Ad(o)}var bN=(n,...e)=>{gm()&&typeof console<"u"&&console[n](...e)},yN={provide:Ad,useFactory:uc,deps:[mo,de,[new ax,po]]},tE=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:mo,useValue:t},{provide:po,useValue:i}]}}constructor(t){Xt.registerVersion("angularfire",fo.full,"core"),Xt.registerVersion("angularfire",fo.full,"app-compat"),Xt.registerVersion("angular",gx.full,t.toString())}static \u0275fac=function(i){return new(i||n)(j(Xi))};static \u0275mod=ae({type:n});static \u0275inj=oe({providers:[yN]})}return n})();function Dd(n,e,t,i,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return vN(r,o)||(Jw("error",`${e} was already initialized on the ${t} Firebase App with different settings.${_N?" You may need to reload as Firebase is not HMR aware.":""}`),Jw("warn",{is:r,was:o})),s;{let a=i();return globalThis.\u0275AngularfireInstanceCache.push([n,a,r]),a}}function vN(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var _N=typeof module<"u"&&!!module.hot,Jw=(n,...e)=>{gm()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var tp=new ee("angularfire2.auth.use-emulator"),np=new ee("angularfire2.auth.settings"),ip=new ee("angularfire2.auth.tenant-id"),rp=new ee("angularfire2.auth.langugage-code"),sp=new ee("angularfire2.auth.use-device-language"),op=new ee("angularfire.auth.persistence"),ap=(n,e,t,i,r,s,o,a)=>Dd(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),i&&(c.tenantId=i),c.languageCode=r,s&&c.useDeviceLanguage(),o)for(let[l,d]of Object.entries(o))c.settings[l]=d;return a&&c.setPersistence(a),c},[t,i,r,s,o,a]),nE=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,s,o,a,c,l,d,u,f,b){let E=new Rt,T=Jn(void 0).pipe(ns(o.outsideAngular),is(()=>s.runOutsideAngular(()=>import("./chunk-DJ4ANN6U.mjs"))),nt(()=>uc(t,s,i)),nt(S=>ap(S,s,a,l,d,u,c,f)),Xa({bufferSize:1,refCount:!1}));if(id(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Jn(null);else{T.pipe(ox()).subscribe();let S=T.pipe(is(F=>F.getRedirectResult().then(P=>P,()=>null)),Zt,Xa({bufferSize:1,refCount:!1})),M=T.pipe(is(F=>new Xn(P=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(G=>P.next(G),G=>P.error(G),()=>P.complete()))})))),I=T.pipe(is(F=>new Xn(P=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(G=>P.next(G),G=>P.error(G),()=>P.complete()))}))));this.authState=S.pipe(um(M),io(o.outsideAngular),ns(o.insideAngular)),this.user=S.pipe(um(I),io(o.outsideAngular),ns(o.insideAngular)),this.idToken=this.user.pipe(is(F=>F?Zn(F.getIdToken()):Jn(null))),this.idTokenResult=this.user.pipe(is(F=>F?Zn(F.getIdTokenResult()):Jn(null))),this.credential=$l(S,E,this.authState.pipe(Qi(F=>!F))).pipe(nt(F=>F?.user?F:null),io(o.outsideAngular),ns(o.insideAngular))}return eE(this,T,s,{spy:{apply:(S,M,I)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&I.then(F=>E.next(F))}}})}static \u0275fac=function(i){return new(i||n)(j(mo),j(po,8),j(Xi),j(de),j(kd),j(tp,8),j(np,8),j(ip,8),j(rp,8),j(sp,8),j(op,8),j(fs,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();import{inspect as Rz,TextEncoder as Nz,TextDecoder as Oz}from"util";import{randomBytes as Fz}from"crypto";var iE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rE={};var sr,cp;(function(){var n;function e(_,g){function y(){}y.prototype=g.prototype,_.D=g.prototype,_.prototype=new y,_.prototype.constructor=_,_.C=function(v,m,x){for(var h=Array(arguments.length-2),p=2;p<arguments.length;p++)h[p-2]=arguments[p];return g.prototype[m].apply(v,h)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(_,g,y){y||(y=0);var v=Array(16);if(typeof g=="string")for(var m=0;16>m;++m)v[m]=g.charCodeAt(y++)|g.charCodeAt(y++)<<8|g.charCodeAt(y++)<<16|g.charCodeAt(y++)<<24;else for(m=0;16>m;++m)v[m]=g[y++]|g[y++]<<8|g[y++]<<16|g[y++]<<24;g=_.g[0],y=_.g[1],m=_.g[2];var x=_.g[3],h=g+(x^y&(m^x))+v[0]+3614090360&4294967295;g=y+(h<<7&4294967295|h>>>25),h=x+(m^g&(y^m))+v[1]+3905402710&4294967295,x=g+(h<<12&4294967295|h>>>20),h=m+(y^x&(g^y))+v[2]+606105819&4294967295,m=x+(h<<17&4294967295|h>>>15),h=y+(g^m&(x^g))+v[3]+3250441966&4294967295,y=m+(h<<22&4294967295|h>>>10),h=g+(x^y&(m^x))+v[4]+4118548399&4294967295,g=y+(h<<7&4294967295|h>>>25),h=x+(m^g&(y^m))+v[5]+1200080426&4294967295,x=g+(h<<12&4294967295|h>>>20),h=m+(y^x&(g^y))+v[6]+2821735955&4294967295,m=x+(h<<17&4294967295|h>>>15),h=y+(g^m&(x^g))+v[7]+4249261313&4294967295,y=m+(h<<22&4294967295|h>>>10),h=g+(x^y&(m^x))+v[8]+1770035416&4294967295,g=y+(h<<7&4294967295|h>>>25),h=x+(m^g&(y^m))+v[9]+2336552879&4294967295,x=g+(h<<12&4294967295|h>>>20),h=m+(y^x&(g^y))+v[10]+4294925233&4294967295,m=x+(h<<17&4294967295|h>>>15),h=y+(g^m&(x^g))+v[11]+2304563134&4294967295,y=m+(h<<22&4294967295|h>>>10),h=g+(x^y&(m^x))+v[12]+1804603682&4294967295,g=y+(h<<7&4294967295|h>>>25),h=x+(m^g&(y^m))+v[13]+4254626195&4294967295,x=g+(h<<12&4294967295|h>>>20),h=m+(y^x&(g^y))+v[14]+2792965006&4294967295,m=x+(h<<17&4294967295|h>>>15),h=y+(g^m&(x^g))+v[15]+1236535329&4294967295,y=m+(h<<22&4294967295|h>>>10),h=g+(m^x&(y^m))+v[1]+4129170786&4294967295,g=y+(h<<5&4294967295|h>>>27),h=x+(y^m&(g^y))+v[6]+3225465664&4294967295,x=g+(h<<9&4294967295|h>>>23),h=m+(g^y&(x^g))+v[11]+643717713&4294967295,m=x+(h<<14&4294967295|h>>>18),h=y+(x^g&(m^x))+v[0]+3921069994&4294967295,y=m+(h<<20&4294967295|h>>>12),h=g+(m^x&(y^m))+v[5]+3593408605&4294967295,g=y+(h<<5&4294967295|h>>>27),h=x+(y^m&(g^y))+v[10]+38016083&4294967295,x=g+(h<<9&4294967295|h>>>23),h=m+(g^y&(x^g))+v[15]+3634488961&4294967295,m=x+(h<<14&4294967295|h>>>18),h=y+(x^g&(m^x))+v[4]+3889429448&4294967295,y=m+(h<<20&4294967295|h>>>12),h=g+(m^x&(y^m))+v[9]+568446438&4294967295,g=y+(h<<5&4294967295|h>>>27),h=x+(y^m&(g^y))+v[14]+3275163606&4294967295,x=g+(h<<9&4294967295|h>>>23),h=m+(g^y&(x^g))+v[3]+4107603335&4294967295,m=x+(h<<14&4294967295|h>>>18),h=y+(x^g&(m^x))+v[8]+1163531501&4294967295,y=m+(h<<20&4294967295|h>>>12),h=g+(m^x&(y^m))+v[13]+2850285829&4294967295,g=y+(h<<5&4294967295|h>>>27),h=x+(y^m&(g^y))+v[2]+4243563512&4294967295,x=g+(h<<9&4294967295|h>>>23),h=m+(g^y&(x^g))+v[7]+1735328473&4294967295,m=x+(h<<14&4294967295|h>>>18),h=y+(x^g&(m^x))+v[12]+2368359562&4294967295,y=m+(h<<20&4294967295|h>>>12),h=g+(y^m^x)+v[5]+4294588738&4294967295,g=y+(h<<4&4294967295|h>>>28),h=x+(g^y^m)+v[8]+2272392833&4294967295,x=g+(h<<11&4294967295|h>>>21),h=m+(x^g^y)+v[11]+1839030562&4294967295,m=x+(h<<16&4294967295|h>>>16),h=y+(m^x^g)+v[14]+4259657740&4294967295,y=m+(h<<23&4294967295|h>>>9),h=g+(y^m^x)+v[1]+2763975236&4294967295,g=y+(h<<4&4294967295|h>>>28),h=x+(g^y^m)+v[4]+1272893353&4294967295,x=g+(h<<11&4294967295|h>>>21),h=m+(x^g^y)+v[7]+4139469664&4294967295,m=x+(h<<16&4294967295|h>>>16),h=y+(m^x^g)+v[10]+3200236656&4294967295,y=m+(h<<23&4294967295|h>>>9),h=g+(y^m^x)+v[13]+681279174&4294967295,g=y+(h<<4&4294967295|h>>>28),h=x+(g^y^m)+v[0]+3936430074&4294967295,x=g+(h<<11&4294967295|h>>>21),h=m+(x^g^y)+v[3]+3572445317&4294967295,m=x+(h<<16&4294967295|h>>>16),h=y+(m^x^g)+v[6]+76029189&4294967295,y=m+(h<<23&4294967295|h>>>9),h=g+(y^m^x)+v[9]+3654602809&4294967295,g=y+(h<<4&4294967295|h>>>28),h=x+(g^y^m)+v[12]+3873151461&4294967295,x=g+(h<<11&4294967295|h>>>21),h=m+(x^g^y)+v[15]+530742520&4294967295,m=x+(h<<16&4294967295|h>>>16),h=y+(m^x^g)+v[2]+3299628645&4294967295,y=m+(h<<23&4294967295|h>>>9),h=g+(m^(y|~x))+v[0]+4096336452&4294967295,g=y+(h<<6&4294967295|h>>>26),h=x+(y^(g|~m))+v[7]+1126891415&4294967295,x=g+(h<<10&4294967295|h>>>22),h=m+(g^(x|~y))+v[14]+2878612391&4294967295,m=x+(h<<15&4294967295|h>>>17),h=y+(x^(m|~g))+v[5]+4237533241&4294967295,y=m+(h<<21&4294967295|h>>>11),h=g+(m^(y|~x))+v[12]+1700485571&4294967295,g=y+(h<<6&4294967295|h>>>26),h=x+(y^(g|~m))+v[3]+2399980690&4294967295,x=g+(h<<10&4294967295|h>>>22),h=m+(g^(x|~y))+v[10]+4293915773&4294967295,m=x+(h<<15&4294967295|h>>>17),h=y+(x^(m|~g))+v[1]+2240044497&4294967295,y=m+(h<<21&4294967295|h>>>11),h=g+(m^(y|~x))+v[8]+1873313359&4294967295,g=y+(h<<6&4294967295|h>>>26),h=x+(y^(g|~m))+v[15]+4264355552&4294967295,x=g+(h<<10&4294967295|h>>>22),h=m+(g^(x|~y))+v[6]+2734768916&4294967295,m=x+(h<<15&4294967295|h>>>17),h=y+(x^(m|~g))+v[13]+1309151649&4294967295,y=m+(h<<21&4294967295|h>>>11),h=g+(m^(y|~x))+v[4]+4149444226&4294967295,g=y+(h<<6&4294967295|h>>>26),h=x+(y^(g|~m))+v[11]+3174756917&4294967295,x=g+(h<<10&4294967295|h>>>22),h=m+(g^(x|~y))+v[2]+718787259&4294967295,m=x+(h<<15&4294967295|h>>>17),h=y+(x^(m|~g))+v[9]+3951481745&4294967295,_.g[0]=_.g[0]+g&4294967295,_.g[1]=_.g[1]+(m+(h<<21&4294967295|h>>>11))&4294967295,_.g[2]=_.g[2]+m&4294967295,_.g[3]=_.g[3]+x&4294967295}i.prototype.u=function(_,g){g===void 0&&(g=_.length);for(var y=g-this.blockSize,v=this.B,m=this.h,x=0;x<g;){if(m==0)for(;x<=y;)r(this,_,x),x+=this.blockSize;if(typeof _=="string"){for(;x<g;)if(v[m++]=_.charCodeAt(x++),m==this.blockSize){r(this,v),m=0;break}}else for(;x<g;)if(v[m++]=_[x++],m==this.blockSize){r(this,v),m=0;break}}this.h=m,this.o+=g},i.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var g=1;g<_.length-8;++g)_[g]=0;var y=8*this.o;for(g=_.length-8;g<_.length;++g)_[g]=y&255,y/=256;for(this.u(_),_=Array(16),g=y=0;4>g;++g)for(var v=0;32>v;v+=8)_[y++]=this.g[g]>>>v&255;return _};function s(_,g){var y=a;return Object.prototype.hasOwnProperty.call(y,_)?y[_]:y[_]=g(_)}function o(_,g){this.h=g;for(var y=[],v=!0,m=_.length-1;0<=m;m--){var x=_[m]|0;v&&x==g||(y[m]=x,v=!1)}this.g=y}var a={};function c(_){return-128<=_&&128>_?s(_,function(g){return new o([g|0],0>g?-1:0)}):new o([_|0],0>_?-1:0)}function l(_){if(isNaN(_)||!isFinite(_))return u;if(0>_)return S(l(-_));for(var g=[],y=1,v=0;_>=y;v++)g[v]=_/y|0,y*=4294967296;return new o(g,0)}function d(_,g){if(_.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(_.charAt(0)=="-")return S(d(_.substring(1),g));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=l(Math.pow(g,8)),v=u,m=0;m<_.length;m+=8){var x=Math.min(8,_.length-m),h=parseInt(_.substring(m,m+x),g);8>x?(x=l(Math.pow(g,x)),v=v.j(x).add(l(h))):(v=v.j(y),v=v.add(l(h)))}return v}var u=c(0),f=c(1),b=c(16777216);n=o.prototype,n.m=function(){if(T(this))return-S(this).m();for(var _=0,g=1,y=0;y<this.g.length;y++){var v=this.i(y);_+=(0<=v?v:4294967296+v)*g,g*=4294967296}return _},n.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(E(this))return"0";if(T(this))return"-"+S(this).toString(_);for(var g=l(Math.pow(_,6)),y=this,v="";;){var m=P(y,g).g;y=M(y,m.j(g));var x=((0<y.g.length?y.g[0]:y.h)>>>0).toString(_);if(y=m,E(y))return x+v;for(;6>x.length;)x="0"+x;v=x+v}},n.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function E(_){if(_.h!=0)return!1;for(var g=0;g<_.g.length;g++)if(_.g[g]!=0)return!1;return!0}function T(_){return _.h==-1}n.l=function(_){return _=M(this,_),T(_)?-1:E(_)?0:1};function S(_){for(var g=_.g.length,y=[],v=0;v<g;v++)y[v]=~_.g[v];return new o(y,~_.h).add(f)}n.abs=function(){return T(this)?S(this):this},n.add=function(_){for(var g=Math.max(this.g.length,_.g.length),y=[],v=0,m=0;m<=g;m++){var x=v+(this.i(m)&65535)+(_.i(m)&65535),h=(x>>>16)+(this.i(m)>>>16)+(_.i(m)>>>16);v=h>>>16,x&=65535,h&=65535,y[m]=h<<16|x}return new o(y,y[y.length-1]&-2147483648?-1:0)};function M(_,g){return _.add(S(g))}n.j=function(_){if(E(this)||E(_))return u;if(T(this))return T(_)?S(this).j(S(_)):S(S(this).j(_));if(T(_))return S(this.j(S(_)));if(0>this.l(b)&&0>_.l(b))return l(this.m()*_.m());for(var g=this.g.length+_.g.length,y=[],v=0;v<2*g;v++)y[v]=0;for(v=0;v<this.g.length;v++)for(var m=0;m<_.g.length;m++){var x=this.i(v)>>>16,h=this.i(v)&65535,p=_.i(m)>>>16,z=_.i(m)&65535;y[2*v+2*m]+=h*z,I(y,2*v+2*m),y[2*v+2*m+1]+=x*z,I(y,2*v+2*m+1),y[2*v+2*m+1]+=h*p,I(y,2*v+2*m+1),y[2*v+2*m+2]+=x*p,I(y,2*v+2*m+2)}for(v=0;v<g;v++)y[v]=y[2*v+1]<<16|y[2*v];for(v=g;v<2*g;v++)y[v]=0;return new o(y,0)};function I(_,g){for(;(_[g]&65535)!=_[g];)_[g+1]+=_[g]>>>16,_[g]&=65535,g++}function F(_,g){this.g=_,this.h=g}function P(_,g){if(E(g))throw Error("division by zero");if(E(_))return new F(u,u);if(T(_))return g=P(S(_),g),new F(S(g.g),S(g.h));if(T(g))return g=P(_,S(g)),new F(S(g.g),g.h);if(30<_.g.length){if(T(_)||T(g))throw Error("slowDivide_ only works with positive integers.");for(var y=f,v=g;0>=v.l(_);)y=G(y),v=G(v);var m=J(y,1),x=J(v,1);for(v=J(v,2),y=J(y,2);!E(v);){var h=x.add(v);0>=h.l(_)&&(m=m.add(y),x=h),v=J(v,1),y=J(y,1)}return g=M(_,m.j(g)),new F(m,g)}for(m=u;0<=_.l(g);){for(y=Math.max(1,Math.floor(_.m()/g.m())),v=Math.ceil(Math.log(y)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),x=l(y),h=x.j(g);T(h)||0<h.l(_);)y-=v,x=l(y),h=x.j(g);E(x)&&(x=f),m=m.add(x),_=M(_,h)}return new F(m,_)}n.A=function(_){return P(this,_).h},n.and=function(_){for(var g=Math.max(this.g.length,_.g.length),y=[],v=0;v<g;v++)y[v]=this.i(v)&_.i(v);return new o(y,this.h&_.h)},n.or=function(_){for(var g=Math.max(this.g.length,_.g.length),y=[],v=0;v<g;v++)y[v]=this.i(v)|_.i(v);return new o(y,this.h|_.h)},n.xor=function(_){for(var g=Math.max(this.g.length,_.g.length),y=[],v=0;v<g;v++)y[v]=this.i(v)^_.i(v);return new o(y,this.h^_.h)};function G(_){for(var g=_.g.length+1,y=[],v=0;v<g;v++)y[v]=_.i(v)<<1|_.i(v-1)>>>31;return new o(y,_.h)}function J(_,g){var y=g>>5;g%=32;for(var v=_.g.length-y,m=[],x=0;x<v;x++)m[x]=0<g?_.i(x+y)>>>g|_.i(x+y+1)<<32-g:_.i(x+y);return new o(m,_.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,cp=rE.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,sr=rE.Integer=o}).apply(typeof iE<"u"?iE:typeof self<"u"?self:typeof window<"u"?window:{});var Ns=J0(Dk(),1),UI=J0(ib(),1);var Mk="@firebase/firestore",Rk="4.7.3";var yt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};yt.UNAUTHENTICATED=new yt(null);yt.GOOGLE_CREDENTIALS=new yt("google-credentials-uid");yt.FIRST_PARTY=new yt("first-party-uid");yt.MOCK_USER=new yt("mock-user");var Pz="10.14.0";var Pa=Pz;function Lz(n){Pa=n}function Bz(n){return Rz(n,{depth:100})}var zr=new sd("@firebase/firestore");function la(){return zr.logLevel}function jI(n){zr.setLogLevel(n)}function O(n,...e){if(zr.logLevel<=ni.DEBUG){let t=e.map(B_);zr.debug(`Firestore (${Pa}): ${n}`,...t)}}function Qe(n,...e){if(zr.logLevel<=ni.ERROR){let t=e.map(B_);zr.error(`Firestore (${Pa}): ${n}`,...t)}}function Gn(n,...e){if(zr.logLevel<=ni.WARN){let t=e.map(B_);zr.warn(`Firestore (${Pa}): ${n}`,...t)}}function B_(n){if(typeof n=="string")return n;try{return Bz(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${Pa}) INTERNAL ASSERTION FAILED: `+n;throw Qe(e),new Error(e)}function K(n,e){n||U()}function GI(n,e){n||U()}function V(n,e){return n}var k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Dx{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var gt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Oh=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},By=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yt.UNAUTHENTICATED))}shutdown(){}},Vy=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},zy=class{constructor(e){this.authProvider=e,this.currentUser=yt.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){K(this.tokenListener===void 0);let i=this.tokenCounter,r=c=>this.tokenCounter!==i?(i=this.tokenCounter,t(c)):Promise.resolve(),s=new gt;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new gt,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>w(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),o())};this.authProvider.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.authProvider.getImmediate({optional:!0});c?a(c):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gt)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.tokenCounter!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(K(typeof i.accessToken=="string"),new Oh(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new yt(e)}},qy=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i,this.type="FirstParty",this.user=yt.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},Uy=class{constructor(e,t,i){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=i}getToken(){return Promise.resolve(new qy(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},jy=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Gy=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){K(this.tokenListener===void 0);let i=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?r(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(K(typeof t.token=="string"),this.latestAppCheckToken=t.token,new jy(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function Vz(n){if(!n)return new By;switch(n.type){case"firstParty":return new Uy(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new D(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function zz(n){return Fz(n)}var Fh=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="",r=20;for(;i.length<r;){let s=zz(40);for(let o=0;o<s.length;++o)i.length<r&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}};function ne(n,e){return n<e?-1:n>e?1:0}function Os(n,e,t){return n.length!==e.length?!1:n.every((i,r)=>t(i,e[r]))}function HI(n){return n+"\0"}var Nk=-62135596800,Ok=1e6,Ye=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Nk)throw new D(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-t*1e3)*Ok);return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/Ok}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-Nk,t=String(e).padStart(12,"0"),i=String(this.nanoseconds).padStart(9,"0");return t+"."+i}};var X=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ye(0,0))}static max(){return new n(new Ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Fk="__name__",Ph=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&U(),i===void 0?i=e.length-t:i>e.length-t&&U(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},fe=class n extends Ph{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new D(k.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},qz=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ot=class n extends Ph{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return qz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fk}static keyField(){return new n([Fk])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new D(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new D(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(!(c==="\\"||c==="."||c==="`"))throw new D(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a==="."&&!o?(s(),r++):(i+=a,r++)}if(s(),o)throw new D(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(fe.fromString(e))}static fromName(e){return new n(fe.fromString(e).popFirst(5))}static empty(){return new n(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new fe(e.slice()))}};var ya=-1,Uz=0,Hy=(()=>{class n{constructor(t,i,r,s){this.indexId=t,this.collectionGroup=i,this.fields=r,this.indexState=s}}return n.UNKNOWN_ID=-1,n})();function V_(n){return n.fields.find(e=>e.kind===2)}function Fs(n){return n.fields.filter(e=>e.kind!==2)}function jz(n){let e=Fs(n);return e.length===0?0:e[e.length-1].kind}function Gz(n){return`id=${n.indexId}|cg=${n.collectionGroup}|f=${n.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}var pa=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var sl=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(Uz,Dn.min())}};function $I(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=X.fromTimestamp(i===1e9?new Ye(t+1,0):new Ye(t,i));return new Dn(r,B.empty(),e)}function WI(n){return new Dn(n.readTime,n.key,ya)}var Dn=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(X.min(),B.empty(),ya)}static max(){return new n(X.max(),B.empty(),ya)}};function z_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=B.comparator(n.documentKey,e.documentKey),t!==0)?t:ne(n.largestBatchId,e.largestBatchId)}var KI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xr(n){return w(this,null,function*(){if(n.code===k.FAILED_PRECONDITION&&n.message===KI)O("LocalStore","Unexpectedly lost primary lease");else throw n})}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},c=>i(c))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&i(o)},d=>r(d))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};var fn="SimpleDb",Hz=3,Bh=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.completionDeferred=new gt,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{t.error?this.completionDeferred.reject(new Rs(e,t.error)):this.completionDeferred.resolve()},this.transaction.onerror=i=>{let r=q_(i.target.error);this.completionDeferred.reject(new Rs(e,r))}}static open(e,t,i,r){try{return new n(t,e.transaction(r,i))}catch(s){throw new Rs(t,s)}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(O(fn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;!this.aborted&&typeof e.commit=="function"&&e.commit()}store(e){let t=this.transaction.objectStore(e);return new Wy(t)}},qr=class n{constructor(e,t,i){this.name=e,this.version=t,this.schemaConverter=i,n.getIOSVersion(nc())===12.2&&Qe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O(fn,"Removing database:",e),Cs(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!rd())return!1;if(n.isMockPersistence())return!0;let e=nc(),t=n.getIOSVersion(e),i=0<t&&t<10,r=QI(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static isMockPersistence(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,t){return e.store(t)}static getIOSVersion(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}ensureDb(e){return w(this,null,function*(){return this.db||(O(fn,"Opening database:",this.name),this.db=yield new Promise((t,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{i(new Rs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?i(new D(k.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new D(k.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Rs(e,o))},r.onupgradeneeded=s=>{O(fn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.schemaConverter.createOrUpgrade(o,r.transaction,s.oldVersion,this.version).next(()=>{O(fn,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=t=>this.versionchangelistener(t)),this.db})}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){return w(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.ensureDb(e);let a=Bh.open(this.db,e,s?"readonly":"readwrite",i),c=r(a).next(l=>(a.maybeCommit(),l)).catch(l=>(a.abort(l),C.reject(l))).toPromise();return c.catch(()=>{}),yield a.completionPromise,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<Hz;if(O(fn,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function QI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var $y=class{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return Cs(this.dbCursor.delete())}},Rs=class extends D{constructor(e,t){super(k.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Zr(n){return n.name==="IndexedDbTransactionError"}var Wy=class{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(O(fn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(O(fn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Cs(i)}add(e){O(fn,"ADD",this.store.name,e,e);let t=this.store.add(e);return Cs(t)}get(e){let t=this.store.get(e);return Cs(t).next(i=>(i===void 0&&(i=null),O(fn,"GET",this.store.name,e,i),i))}delete(e){O(fn,"DELETE",this.store.name,e);let t=this.store.delete(e);return Cs(t)}count(){O(fn,"COUNT",this.store.name);let e=this.store.count();return Cs(e)}loadAll(e,t){let i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(i.range);return new C((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}else{let s=this.cursor(i),o=[];return this.iterateCursor(s,(a,c)=>{o.push(c)}).next(()=>o)}}loadFirst(e,t){let i=this.store.getAll(e,t===null?void 0:t);return new C((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}deleteAll(e,t){O(fn,"DELETE ALL",this.store.name);let i=this.options(e,t);i.keysOnly=!1;let r=this.cursor(i);return this.iterateCursor(r,(s,o,a)=>a.delete())}iterate(e,t){let i;t?i=e:(i={},t=e);let r=this.cursor(i);return this.iterateCursor(r,t)}iterateSerial(e){let t=this.cursor({});return new C((i,r)=>{t.onerror=s=>{let o=q_(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;if(!o){i();return}e(o.primaryKey,o.value).next(a=>{a?o.continue():i()})}})}iterateCursor(e,t){let i=[];return new C((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a){r();return}let c=new $y(a),l=t(a.primaryKey,a.value,c);if(l instanceof C){let d=l.catch(u=>(c.done(),C.reject(u)));i.push(d)}c.isDone?r():c.skipToKey===null?a.continue():a.continue(c.skipToKey)}}).next(()=>C.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let i=this.store.index(e.index);return e.keysOnly?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}else return this.store.openCursor(e.range,t)}};function Cs(n){return new C((e,t)=>{n.onsuccess=i=>{let r=i.target.result;e(r)},n.onerror=i=>{let r=q_(i.target.error);t(r)}})}var Pk=!1;function q_(n){let e=qr.getIOSVersion(nc());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let i=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Pk||(Pk=!0,setTimeout(()=>{throw i},0)),i}}return n}var Jc="IndexBackfiller",$z=15*1e3,Wz=60*1e3,Kz=50,Ky=class{constructor(e,t){this.asyncQueue=e,this.backfiller=t,this.task=null}start(){this.schedule($z)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}schedule(e){O(Jc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>w(this,null,function*(){this.task=null;try{let t=yield this.backfiller.backfill();O(Jc,`Documents written: ${t}`)}catch(t){Zr(t)?O(Jc,"Ignoring IndexedDB error during index backfill: ",t):yield Xr(t)}yield this.schedule(Wz)}))}},Qy=class{constructor(e,t){this.localStore=e,this.persistence=t}backfill(){return w(this,arguments,function*(e=Kz){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.writeIndexEntries(t,e))})}writeIndexEntries(e,t){let i=new Set,r=t,s=!0;return C.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o===null||i.has(o))s=!1;else return O(Jc,`Processing collection: ${o}`),this.writeEntriesForCollectionGroup(e,o,r).next(a=>{r-=a,i.add(o)})})).next(()=>t-r)}writeEntriesForCollectionGroup(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.getNewOffset(r,s)).next(a=>(O(Jc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}getNewOffset(e,t){let i=e;return t.changes.forEach((r,s)=>{let o=WI(s);z_(o,i)>0&&(i=o)}),new Dn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}};var mn=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>i.writeSequenceNumber(r))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})(),ga="",Yy="",YI="",XI="";function Wt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Lk(e)),e=Qz(n.get(t),e);return Lk(e)}function Qz(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":t+=ga+YI;break;case ga:t+=ga+XI;break;default:t+=s}}return t}function Lk(n){return n+ga+Yy}function wi(n){let e=n.length;if(K(e>=2),e===2)return K(n.charAt(0)===ga&&n.charAt(1)===Yy),fe.emptyPath();let t=e-2,i=[],r="";for(let s=0;s<e;){let o=n.indexOf(ga,s);switch((o<0||o>t)&&U(),n.charAt(o+1)){case Yy:let c=n.substring(s,o),l;r.length===0?l=c:(r+=c,l=r,r=""),i.push(l);break;case YI:r+=n.substring(s,o),r+="\0";break;case XI:r+=n.substring(s,o+1);break;default:U()}s=o+2}return new fe(i)}var Ss="remoteDocuments";var Al="owner",na="owner",Dl="mutationQueues",Yz="userId",jn="mutations",ZI="batchId",Ds="userMutationsIndex",JI=["userId","batchId"];function Xz(n){return[n]}function Ah(n,e){return[n,Wt(e)]}function eA(n,e,t){return[n,Wt(e),t]}var Zz={},La="documentMutations",If="remoteDocumentsV14",Jz=["prefixPath","collectionGroup","readTime","documentId"],Dh="documentKeyIndex",e4=["prefixPath","collectionGroup","documentId"],tA="collectionGroupIndex",t4=["collectionGroup","readTime","prefixPath","documentId"],Ml="remoteDocumentGlobal",Xy="remoteDocumentGlobalKey",Ba="targets",n4="targetId",nA="queryTargetsIndex",i4=["canonicalId","targetId"],Va="targetDocuments",r4=["targetId","path"],U_="documentTargetsIndex",s4=["path","targetId"],Vh="targetGlobalKey",Ks="targetGlobal",ol="collectionParents",o4=["collectionId","parent"],va="clientMetadata",a4="clientId",Af="bundles",c4="bundleId",Df="namedQueries",l4="name",j_="indexConfiguration",d4="indexId",Zy="collectionGroupIndex",u4="collectionGroup",Mf="indexState",h4=["indexId","uid"],iA="sequenceNumberIndex",f4=["uid","sequenceNumber"],Rf="indexEntries",m4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rA="documentKeyIndex",p4=["indexId","uid","orderedDocumentKey"],Nf="documentOverlays",g4=["userId","collectionPath","documentId"],Jy="collectionPathOverlayIndex",b4=["userId","collectionPath","largestBatchId"],sA="collectionGroupOverlayIndex",y4=["userId","collectionGroup","largestBatchId"],G_="globals",v4="name",_4=[Dl,jn,La,Ss,Ba,Al,Ks,Va],x4=_4,w4=[...x4,va],E4=[...w4,Ml],T4=[...E4,ol],oA=[...T4,Af,Df],C4=[...oA,Nf],aA=[Dl,jn,La,If,Ba,Al,Ks,Va,va,Ml,ol,Af,Df,Nf],cA=aA,H_=[...cA,j_,Mf,Rf],S4=H_,k4=[...H_,G_];function I4(n){if(n===17)return k4;if(n===16)return S4;if(n===15)return H_;if(n===14)return cA;if(n===13)return aA;if(n===12)return C4;if(n===11)return oA;U()}var al=class extends Lh{constructor(e,t){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=t}};function Et(n,e){let t=V(n);return qr.getStore(t.simpleDbTransaction,e)}function Bk(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qs(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lA(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Le=class n{constructor(e,t){this.comparator=e,this.root=t||el.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,el.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,el.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fa(this.root,e,this.comparator,!1)}getReverseIterator(){return new fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fa(this.root,e,this.comparator,!0)}},fa=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},el=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,i){let r,s=this;if(i(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,i),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),i(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,i))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let t=this.left.check();if(t!==this.right.check())throw U();return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),ev=class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,i,r,s){return this}insert(e,t,i){return new el(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};el.EMPTY=new ev;var De=class n{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(t!==void 0?i=this.data.getIteratorFrom(t):i=this.data.getIterator();i.hasNext();){let r=i.getNext();if(!e(r.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zh(this.data.getIterator())}getIteratorFrom(e){return new zh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},zh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function A4(n,e,t,i,r){let s=n.getIterator(),o=e.getIterator(),a=ia(s),c=ia(o);for(;a||c;){let l=!1,d=!1;if(a&&c){let u=t(a,c);u<0?d=!0:u>0&&(l=!0)}else a!=null?d=!0:l=!0;l?(i(c),c=ia(o)):d?(r(a),a=ia(s)):(a=ia(s),c=ia(o))}}function ia(n){return n.hasNext()?n.getNext():void 0}var pn=class n{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new n([])}unionWith(e){let t=new De(ot.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Os(this.fields,e.fields,(t,i)=>t.isEqual(i))}};function D4(n){return Buffer.from(n,"base64").toString("binary")}function M4(n){return Buffer.from(n,"binary").toString("base64")}function dA(){return!0}var at=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=D4(e);return new n(t)}static fromUint8Array(e){let t=R4(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return M4(this.binaryString)}toUint8Array(){return N4(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};at.EMPTY_BYTE_STRING=new at("");function R4(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function N4(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var O4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(n){if(K(!!n),typeof n=="string"){let e=0,t=O4.exec(n);if(K(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}else{let e=je(n.seconds),t=je(n.nanos);return{seconds:e,nanos:t}}}function je(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ur(n){return typeof n=="string"?at.fromBase64String(n):at.fromUint8Array(n)}var uA="server_timestamp",hA="__type__",fA="__previous_value__",mA="__local_write_time__";function Of(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[hA])===null||t===void 0?void 0:t.stringValue)===uA}function F4(n,e){let t={fields:{[hA]:{stringValue:uA},[mA]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&Of(e)&&(e=$_(e)),e&&(t.fields[fA]=e),{mapValue:t}}function $_(n){let e=n.mapValue.fields[fA];return Of(e)?$_(e):e}function cl(n){let e=zi(n.mapValue.fields[mA].timestampValue);return new Ye(e.seconds,e.nanos)}var tv=class{constructor(e,t,i,r,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Vk="(default)",jr=class n{constructor(e,t){this.projectId=e,this.database=t||Vk}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Vk}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function P4(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new D(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jr(n.options.projectId,e)}var Vr=-1;function Rl(n){return n==null}function ll(n){return n===0&&1/n===-1/0}function pA(n){return typeof n=="number"&&Number.isInteger(n)&&!ll(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var W_="__type__",gA="__max__",Lr={mapValue:{fields:{__type__:{stringValue:gA}}}},K_="__vector__",_a="value",Mh={nullValue:"NULL_VALUE"};function Ps(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Of(n)?4:yA(n)?9007199254740991:Ff(n)?10:11:U()}function Hn(n,e){if(n===e)return!0;let t=Ps(n),i=Ps(e);if(t!==i)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cl(n).isEqual(cl(e));case 3:return L4(n,e);case 5:return n.stringValue===e.stringValue;case 6:return V4(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return B4(n,e);case 2:return z4(n,e);case 9:return Os(n.arrayValue.values||[],e.arrayValue.values||[],Hn);case 10:case 11:return q4(n,e);case 9007199254740991:return!0;default:return U()}}function L4(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=zi(n.timestampValue),i=zi(e.timestampValue);return t.seconds===i.seconds&&t.nanos===i.nanos}function B4(n,e){return je(n.geoPointValue.latitude)===je(e.geoPointValue.latitude)&&je(n.geoPointValue.longitude)===je(e.geoPointValue.longitude)}function V4(n,e){return Ur(n.bytesValue).isEqual(Ur(e.bytesValue))}function z4(n,e){if("integerValue"in n&&"integerValue"in e)return je(n.integerValue)===je(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=je(n.doubleValue),i=je(e.doubleValue);return t===i?ll(t)===ll(i):isNaN(t)&&isNaN(i)}return!1}function q4(n,e){let t=n.mapValue.fields||{},i=e.mapValue.fields||{};if(Bk(t)!==Bk(i))return!1;for(let r in t)if(t.hasOwnProperty(r)&&(i[r]===void 0||!Hn(t[r],i[r])))return!1;return!0}function dl(n,e){return(n.values||[]).find(t=>Hn(t,e))!==void 0}function Gr(n,e){if(n===e)return 0;let t=Ps(n),i=Ps(e);if(t!==i)return ne(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return U4(n,e);case 3:return zk(n.timestampValue,e.timestampValue);case 4:return zk(cl(n),cl(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return H4(n.bytesValue,e.bytesValue);case 7:return j4(n.referenceValue,e.referenceValue);case 8:return G4(n.geoPointValue,e.geoPointValue);case 9:return bA(n.arrayValue,e.arrayValue);case 10:return $4(n.mapValue,e.mapValue);case 11:return W4(n.mapValue,e.mapValue);default:throw U()}}function U4(n,e){let t=je(n.integerValue||n.doubleValue),i=je(e.integerValue||e.doubleValue);return t<i?-1:t>i?1:t===i?0:isNaN(t)?isNaN(i)?0:-1:1}function zk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);let t=zi(n),i=zi(e),r=ne(t.seconds,i.seconds);return r!==0?r:ne(t.nanos,i.nanos)}function j4(n,e){let t=n.split("/"),i=e.split("/");for(let r=0;r<t.length&&r<i.length;r++){let s=ne(t[r],i[r]);if(s!==0)return s}return ne(t.length,i.length)}function G4(n,e){let t=ne(je(n.latitude),je(e.latitude));return t!==0?t:ne(je(n.longitude),je(e.longitude))}function H4(n,e){let t=Ur(n),i=Ur(e);return t.compareTo(i)}function bA(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=Gr(t[r],i[r]);if(s)return s}return ne(t.length,i.length)}function $4(n,e){var t,i,r,s;let o=n.fields||{},a=e.fields||{},c=(t=o[_a])===null||t===void 0?void 0:t.arrayValue,l=(i=a[_a])===null||i===void 0?void 0:i.arrayValue,d=ne(((r=c?.values)===null||r===void 0?void 0:r.length)||0,((s=l?.values)===null||s===void 0?void 0:s.length)||0);return d!==0?d:bA(c,l)}function W4(n,e){if(n===Lr.mapValue&&e===Lr.mapValue)return 0;if(n===Lr.mapValue)return 1;if(e===Lr.mapValue)return-1;let t=n.fields||{},i=Object.keys(t),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){let a=ne(i[o],s[o]);if(a!==0)return a;let c=Gr(t[i[o]],r[s[o]]);if(c!==0)return c}return ne(i.length,s.length)}function xa(n){return Q_(n)}function Q_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?Q4(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?K4(n.bytesValue):"referenceValue"in n?X4(n.referenceValue):"geoPointValue"in n?Y4(n.geoPointValue):"arrayValue"in n?J4(n.arrayValue):"mapValue"in n?Z4(n.mapValue):U()}function K4(n){return Ur(n).toBase64()}function Q4(n){let e=zi(n);return`time(${e.seconds},${e.nanos})`}function Y4(n){return`geo(${n.latitude},${n.longitude})`}function X4(n){return B.fromName(n).toString()}function Z4(n){let e=Object.keys(n.fields||{}).sort(),t="{",i=!0;for(let r of e)i?i=!1:t+=",",t+=`${r}:${Q_(n.fields[r])}`;return t+"}"}function J4(n){let e="[",t=!0;for(let i of n.values||[])t?t=!1:e+=",",e+=Q_(i);return e+"]"}function Ls(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function nv(n){return!!n&&"integerValue"in n}function eq(n){return!!n&&"doubleValue"in n}function tq(n){return nv(n)||eq(n)}function ul(n){return!!n&&"arrayValue"in n}function qk(n){return!!n&&"nullValue"in n}function Uk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Rh(n){return!!n&&"mapValue"in n}function Ff(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[W_])===null||t===void 0?void 0:t.stringValue)===K_}function tl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Qs(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=tl(i)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=tl(n.arrayValue.values[t]);return e}else return Object.assign({},n)}function yA(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===gA}var vA={mapValue:{fields:{[W_]:{stringValue:K_},[_a]:{arrayValue:{}}}}};function nq(n){return"nullValue"in n?Mh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ls(jr.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ff(n)?vA:{mapValue:{}}:U()}function iq(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ls(jr.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?vA:"mapValue"in n?Ff(n)?{mapValue:{}}:Lr:U()}function jk(n,e){let t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Gk(n,e){let t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Lt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let i=this.getFieldsMap(e.popLast());i[e.lastSegment()]=tl(t)}setAll(e){let t=ot.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=tl(o):r.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());Rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];(!Rh(r)||!r.mapValue.fields)&&(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Qs(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(tl(this.value))}};function _A(n){let e=[];return Qs(n.fields,(t,i)=>{let r=new ot([t]);if(Rh(i)){let o=_A(i.mapValue).fields;if(o.length===0)e.push(r);else for(let a of o)e.push(r.child(a))}else e.push(r)}),new pn(e)}var bt=class n{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,X.min(),X.min(),X.min(),Lt.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,X.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,X.min(),X.min(),Lt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,X.min(),X.min(),Lt.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(X.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function rq(n,e,t){let i=e.data.field(n),r=t.data.field(n);return i!==null&&r!==null?Gr(i,r):U()}var Si=class{constructor(e,t){this.position=e,this.inclusive=t}};function xA(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField())i=B.comparator(B.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);i=Gr(o,a)}if(s.dir==="desc"&&(i=i*-1),i!==0)break}return i}function sq(n,e,t){let i=xA(n,e,t);return n.inclusive?i>=0:i>0}function oq(n,e,t){let i=xA(n,e,t);return n.inclusive?i<=0:i<0}function Hk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let i=n.position[t],r=e.position[t];if(!Hn(i,r))return!1}return!0}var Bs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function aq(n){return n.field.canonicalString()+n.dir}function cq(n){return`${n.field.canonicalString()} (${n.dir})`}function lq(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var qh=class{},ue=class n extends qh{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new sv(e,t,i):t==="array-contains"?new cv(e,i):t==="in"?new Uh(e,i):t==="not-in"?new lv(e,i):t==="array-contains-any"?new dv(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new ov(e,i):new av(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Gr(t,this.value)):t!==null&&Ps(this.value)===Ps(t)&&this.matchesComparison(Gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Te=class n extends qh{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return wa(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function wa(n){return n.op==="and"}function iv(n){return n.op==="or"}function Y_(n){return wA(n)&&wa(n)}function wA(n){for(let e of n.filters)if(e instanceof Te)return!1;return!0}function rv(n){if(n instanceof ue)return n.field.canonicalString()+n.op.toString()+xa(n.value);if(Y_(n))return n.filters.map(e=>rv(e)).join(",");{let e=n.filters.map(t=>rv(t)).join(",");return`${n.op}(${e})`}}function EA(n,e){if(n instanceof ue)return dq(n,e);if(n instanceof Te)return uq(n,e);U()}function dq(n,e){return e instanceof ue&&n.op===e.op&&n.field.isEqual(e.field)&&Hn(n.value,e.value)}function uq(n,e){return e instanceof Te&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((i,r,s)=>i&&EA(r,e.filters[s]),!0):!1}function TA(n,e){let t=n.filters.concat(e);return Te.create(t,n.op)}function CA(n){return n instanceof ue?fq(n):n instanceof Te?hq(n):"Filter"}function hq(n){return n.op.toString()+" {"+n.getFilters().map(CA).join(" ,")+"}"}function fq(n){return`${n.field.canonicalString()} ${n.op} ${xa(n.value)}`}var sv=class extends ue{constructor(e,t,i){super(e,t,i),this.key=B.fromName(i.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},ov=class extends ue{constructor(e,t){super(e,"in",t),this.keys=SA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},av=class extends ue{constructor(e,t){super(e,"not-in",t),this.keys=SA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function SA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>B.fromName(i.referenceValue))}var cv=class extends ue{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ul(t)&&dl(t.arrayValue,this.value)}},Uh=class extends ue{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&dl(this.value.arrayValue,t)}},lv=class extends ue{constructor(e,t){super(e,"not-in",t)}matches(e){if(dl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!dl(this.value.arrayValue,t)}},dv=class extends ue{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!ul(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(i=>dl(this.value.arrayValue,i))}};var uv=class{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function hv(n,e=null,t=[],i=[],r=null,s=null,o=null){return new uv(n,e,t,i,r,s,o)}function Vs(n){let e=V(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>rv(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>aq(i)).join(","),Rl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>xa(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>xa(i)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function mq(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>CA(t)).join(", ")}]`),Rl(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>cq(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>xa(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>xa(t)).join(",")),`Target(${e})`}function Nl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lq(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!EA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!Hk(n.startAt,e.startAt)?!1:Hk(n.endAt,e.endAt)}function jh(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Pf(n,e){return n.filters.filter(t=>t instanceof ue&&t.field.isEqual(e))}function pq(n,e){let t=V_(e);if(t===void 0)return null;for(let i of Pf(n,t.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}function gq(n,e){let t=new Map;for(let i of Fs(e))for(let r of Pf(n,i.fieldPath))switch(r.op){case"==":case"in":t.set(i.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return t.set(i.fieldPath.canonicalString(),r.value),Array.from(t.values())}return null}function bq(n,e){let t=[],i=!0;for(let r of Fs(e)){let s=r.kind===0?kA(n,r.fieldPath,n.startAt):IA(n,r.fieldPath,n.startAt);t.push(s.value),i&&(i=s.inclusive)}return new Si(t,i)}function yq(n,e){let t=[],i=!0;for(let r of Fs(e)){let s=r.kind===0?IA(n,r.fieldPath,n.endAt):kA(n,r.fieldPath,n.endAt);t.push(s.value),i&&(i=s.inclusive)}return new Si(t,i)}function kA(n,e,t){let i=Mh,r=!0;for(let s of Pf(n,e)){let o=Mh,a=!0;switch(s.op){case"<":case"<=":o=nq(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Mh;break}jk({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];jk({value:i,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function IA(n,e,t){let i=Lr,r=!0;for(let s of Pf(n,e)){let o=Lr,a=!0;switch(s.op){case">=":case">":o=iq(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Lr;break}Gk({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let a=t.position[s];Gk({value:i,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(i=a,r=t.inclusive);break}}return{value:i,inclusive:r}}function vq(n){let e=new De(ot.comparator),t=!1;for(let i of n.filters)for(let r of i.getFlattenedFilters())r.field.isKeyField()||(r.op==="array-contains"||r.op==="array-contains-any"?t=!0:e=e.add(r.field));for(let i of n.orderBy)i.field.isKeyField()||(e=e.add(i.field));return e.size+(t?1:0)}function _q(n){return n.limit!==null}var $n=class{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function AA(n,e,t,i,r,s,o,a){return new $n(n,e,t,i,r,s,o,a)}function za(n){return new $n(n)}function xq(n,e){return new $n(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function $k(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function wq(n){let e=new De(ot.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(r=>{r.isInequality()&&(e=e.add(r.field))})}),e}function Eq(n){return new $n(fe.emptyPath(),n)}function Tq(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function X_(n){return n.collectionGroup!==null}function Ea(n){let e=V(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";wq(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new Bs(s,i))}),t.has(ot.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new Bs(ot.keyField(),i))}return e.memoizedNormalizedOrderBy}function Kt(n){let e=V(n);return e.memoizedTarget||(e.memoizedTarget=Cq(e,Ea(n))),e.memoizedTarget}function Cq(n,e){if(n.limitType==="F")return hv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Bs(r.field,s)});let t=n.endAt?new Si(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Si(n.startAt.position,n.startAt.inclusive):null;return hv(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Z_(n,e){let t=n.filters.concat([e]);return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sq(n,e){let t=n.explicitOrderBy.concat([e]);return new $n(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Gh(n,e,t){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kq(n,e){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Iq(n,e){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function Ol(n,e){return Nl(Kt(n),Kt(e))&&n.limitType===e.limitType}function DA(n){return`${Vs(Kt(n))}|lt:${n.limitType}`}function da(n){return`Query(target=${mq(Kt(n))}; limitType=${n.limitType})`}function Fl(n,e){return e.isFoundDocument()&&Aq(n,e)&&Dq(n,e)&&Mq(n,e)&&Rq(n,e)}function Aq(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):B.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function Dq(n,e){for(let t of Ea(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function Mq(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function Rq(n,e){return!(n.startAt&&!oq(n.startAt,Ea(n),e)||n.endAt&&!sq(n.endAt,Ea(n),e))}function MA(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function RA(n){return(e,t)=>{let i=!1;for(let r of Ea(n)){let s=Nq(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Nq(n,e,t){let i=n.field.isKeyField()?B.comparator(e.key,t.key):rq(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return U()}}var ki=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0){this.inner[i]=[[e,t]],this.innerSize++;return}for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e)){r[s]=[e,t];return}r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qs(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return lA(this.inner)}size(){return this.innerSize}};var Oq=new Le(B.comparator);function rn(){return Oq}var NA=new Le(B.comparator);function Xc(...n){let e=NA;for(let t of n)e=e.insert(t.key,t);return e}function Fq(){return hl()}function OA(n){let e=NA;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ei(){return hl()}function FA(){return hl()}function hl(){return new ki(n=>n.toString(),(n,e)=>n.isEqual(e))}var Pq=new Le(B.comparator);function Lq(){return Pq}var Bq=new De(B.comparator);function ie(...n){let e=Bq;for(let t of n)e=e.add(t);return e}var Vq=new De(ne);function J_(){return Vq}function e0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ll(e)?"-0":e}}function PA(n){return{integerValue:""+n}}function LA(n,e){return pA(e)?PA(e):e0(n,e)}var Ta=class{constructor(){this._=void 0}};function zq(n,e,t){return n instanceof Hr?F4(t,e):n instanceof qi?VA(n,e):n instanceof Ui?zA(n,e):jq(n,e)}function qq(n,e,t){return n instanceof qi?VA(n,e):n instanceof Ui?zA(n,e):t}function BA(n,e){return n instanceof $r?tq(e)?e:{integerValue:0}:null}function Uq(n,e){return n instanceof qi&&e instanceof qi||n instanceof Ui&&e instanceof Ui?Os(n.elements,e.elements,Hn):n instanceof $r&&e instanceof $r?Hn(n.operand,e.operand):n instanceof Hr&&e instanceof Hr}var Hr=class extends Ta{},qi=class extends Ta{constructor(e){super(),this.elements=e}};function VA(n,e){let t=qA(e);for(let i of n.elements)t.some(r=>Hn(r,i))||t.push(i);return{arrayValue:{values:t}}}var Ui=class extends Ta{constructor(e){super(),this.elements=e}};function zA(n,e){let t=qA(e);for(let i of n.elements)t=t.filter(r=>!Hn(r,i));return{arrayValue:{values:t}}}var $r=class extends Ta{constructor(e,t){super(),this.serializer=e,this.operand=t}};function jq(n,e){let t=BA(n,e),i=Wk(t)+Wk(n.operand);return nv(t)&&nv(n.operand)?PA(i):e0(n.serializer,i)}function Wk(n){return je(n.integerValue||n.doubleValue)}function qA(n){return ul(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var zs=class{constructor(e,t){this.field=e,this.transform=t}};function Gq(n,e){return n.field.isEqual(e.field)&&Uq(n.transform,e.transform)}function Hq(n,e){return n===void 0&&e===void 0?!0:n&&e?Os(n,e,(t,i)=>Gq(t,i)):!1}var fv=class{constructor(e,t){this.version=e,this.transformResults=t}},et=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Lf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var Ca=class{};function UA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Kr(n.key,et.none()):new Wr(n.key,n.data,et.none());{let t=n.data,i=Lt.empty(),r=new De(ot.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Wn(n.key,i,new pn(r.toArray()),et.none())}}function $q(n,e,t){n instanceof Wr?Kq(n,e,t):n instanceof Wn?Yq(n,e,t):Zq(n,e,t)}function nl(n,e,t,i){return n instanceof Wr?Qq(n,e,t,i):n instanceof Wn?Xq(n,e,t,i):Jq(n,e,t)}function Wq(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=BA(i.transform,r||null);s!=null&&(t===null&&(t=Lt.empty()),t.set(i.field,s))}return t||null}function Kk(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!Hq(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var Wr=class extends Ca{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}};function Kq(n,e,t){let i=n.value.clone(),r=GA(n.fieldTransforms,e,t.transformResults);i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function Qq(n,e,t,i){if(!Lf(n.precondition,e))return t;let r=n.value.clone(),s=HA(n.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}var Wn=class extends Ca{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Yq(n,e,t){if(!Lf(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let i=GA(n.fieldTransforms,e,t.transformResults),r=e.data;r.setAll(jA(n)),r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function Xq(n,e,t,i){if(!Lf(n.precondition,e))return t;let r=HA(n.fieldTransforms,i,e),s=e.data;return s.setAll(jA(n)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function jA(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function GA(n,e,t){let i=new Map;K(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,qq(o,a,t[r]))}return i}function HA(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,zq(s,o,e))}return i}var Kr=class extends Ca{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function Zq(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function Jq(n,e,t){return Lf(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var fl=class extends Ca{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ml=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];if(s.key.isEqual(e.key)){let o=i[r];$q(s,e,o)}}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=nl(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=nl(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=FA();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;let c=UA(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(X.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&Os(this.mutations,e.mutations,(t,i)=>Kk(t,i))&&Os(this.baseMutations,e.baseMutations,(t,i)=>Kk(t,i))}},mv=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){K(e.mutations.length===i.length);let r=Lq(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var pl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var pv=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var kt=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n}(kt||{});function $A(n){switch(n){case k.OK:return U();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0;default:return U()}}function e3(n){return $A(n)&&n!==k.ABORTED}function Nh(n){if(n===void 0)return Qe("GRPC error has no .code"),k.UNKNOWN;switch(n){case kt.OK:return k.OK;case kt.CANCELLED:return k.CANCELLED;case kt.UNKNOWN:return k.UNKNOWN;case kt.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case kt.INTERNAL:return k.INTERNAL;case kt.UNAVAILABLE:return k.UNAVAILABLE;case kt.UNAUTHENTICATED:return k.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case kt.NOT_FOUND:return k.NOT_FOUND;case kt.ALREADY_EXISTS:return k.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return k.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case kt.ABORTED:return k.ABORTED;case kt.OUT_OF_RANGE:return k.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return k.UNIMPLEMENTED;case kt.DATA_LOSS:return k.DATA_LOSS;default:return U()}}var gv=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ky=null;function WA(){return new Nz}function t3(){return new Oz("utf-8")}var n3=new sr([4294967295,4294967295],0);function Qk(n){let e=WA().encode(n),t=new cp;return t.update(e),new Uint8Array(t.digest())}function Yk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new sr([t,i],0),a=new sr([r,s],0);return[o,a]}var bv=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ms(`Invalid padding: ${t}`);if(i<0)throw new Ms(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ms(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ms(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=sr.fromNumber(this.bitCount)}getBitIndex(e,t,i){let r=e.add(t.multiply(sr.fromNumber(i)));return r.compare(n3)===1&&(r=new sr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],i=e%8;return(t&1<<i)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=Qk(e),[i,r]=Yk(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,i){let r=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=Qk(e),[i,r]=Yk(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(i,r,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Ms=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var gl=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,bl.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(X.min(),r,new Le(ne),rn(),ie())}},bl=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,ie(),ie(),ie())}};var ba=class{constructor(e,t,i,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=i,this.newDoc=r}},Hh=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},$h=class{constructor(e,t,i=at.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Wh=class{constructor(){this.pendingResponses=0,this.documentChanges=Zk(),this._resumeToken=at.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=ie(),t=ie(),i=ie();return this.documentChanges.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:U()}}),new bl(this._resumeToken,this._current,e,t,i)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=Zk()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,K(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},i3="WatchChangeAggregator",yv=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=rn(),this.pendingDocumentTargetMapping=Xk(),this.pendingTargetResets=new Le(ne)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let i=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&i.updateResumeToken(e.resumeToken);break;case 1:i.recordTargetResponse(),i.isPending||i.clearPendingChanges(),i.updateResumeToken(e.resumeToken);break;case 2:i.recordTargetResponse(),i.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(i.markCurrent(),i.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),i.updateResumeToken(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((i,r)=>{this.isActiveTarget(r)&&t(r)})}handleExistenceFilter(e){let t=e.targetId,i=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){let s=r.target;if(jh(s))if(i===0){let o=new B(s.path);this.removeDocumentFromTarget(t,o,bt.newNoDocument(o,X.min()))}else K(i===1);else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==i){let a=this.parseBloomFilter(e),c=a?this.applyBloomFilter(a,e,o):1;if(c!==0){this.resetTarget(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,l)}ky?.notifyOnExistenceFilterMismatch(r3(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,c))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o;try{o=Ur(i).toUint8Array()}catch(c){if(c instanceof gv)return Gn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}let a;try{a=new bv(o,r,s)}catch(c){return c instanceof Ms?Gn("BloomFilter error: ",c):Gn("Applying bloom filter failed: ",c),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,i){let r=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return r===i-s?0:2}filterRemovedDocuments(e,t){let i=this.metadataProvider.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),r++)}),r}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&jh(a.target)){let c=new B(a.target.path);this.pendingDocumentUpdates.get(c)===null&&!this.targetContainsDocument(o,c)&&this.removeDocumentFromTarget(o,c,bt.newNoDocument(c,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let i=ie();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.targetDataForActiveTarget(c);return l&&l.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(i=i.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let r=new gl(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,i);return this.pendingDocumentUpdates=rn(),this.pendingDocumentTargetMapping=Xk(),this.pendingTargetResets=new Le(ne),r}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let i=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,i),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,i){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,1):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),i&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,i))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let i=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new Wh,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new De(ne),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||O(i3,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new Wh),this.metadataProvider.getRemoteKeysForTarget(e).forEach(i=>{this.removeDocumentFromTarget(e,i,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function Xk(){return new Le(B.comparator)}function Zk(){return new Le(B.comparator)}function r3(n,e,t,i,r){var s,o,a,c,l,d;let u={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},f=e.unchangedNames;return f&&(u.bloomFilter={applied:r===0,hashCount:(s=f?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(c=(a=(o=f?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&c!==void 0?c:0,padding:(d=(l=f?.bits)===null||l===void 0?void 0:l.padding)!==null&&d!==void 0?d:0,mightContain:b=>{var E;return(E=i?.mightContain(b))!==null&&E!==void 0?E:!1}}),u}var s3=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),o3=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),a3=(()=>{let n={};return n.and="AND",n.or="OR",n})();var vv=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function c3(n){let e=n.code===void 0?k.UNKNOWN:Nh(n.code);return new D(e,n.message||"")}function _v(n,e){return n.useProto3Json||Rl(e)?e:{value:e}}function l3(n){let e;return typeof n=="object"?e=n.value:e=n,Rl(e)?null:e}function Sa(n,e){if(n.useProto3Json){let i=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+e.nanoseconds).slice(-9);return`${i}.${r}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function d3(n){let e=zi(n);return new Ye(e.seconds,e.nanos)}function KA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function u3(n,e){return n.useProto3Json?(K(e===void 0||typeof e=="string"),at.fromBase64String(e||"")):(K(e===void 0||e instanceof Buffer||e instanceof Uint8Array),at.fromUint8Array(e||new Uint8Array))}function h3(n,e){return Sa(n,e.toTimestamp())}function st(n){return K(!!n),X.fromTimestamp(d3(n))}function t0(n,e){return xv(n,e).canonicalString()}function xv(n,e){let t=f3(n).child("documents");return e===void 0?t:t.child(e)}function QA(n){let e=fe.fromString(n);return K(sD(e)),e}function yl(n,e){return t0(n.databaseId,e.path)}function Ti(n,e){let t=QA(e);if(t.get(1)!==n.databaseId.projectId)throw new D(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(ZA(t))}function YA(n,e){return t0(n.databaseId,e)}function XA(n){let e=QA(n);return e.length===4?fe.emptyPath():ZA(e)}function wv(n){return new fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function f3(n){return new fe(["projects",n.projectId,"databases",n.database])}function ZA(n){return K(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Jk(n,e,t){return{name:yl(n,e),fields:t.value.mapValue.fields}}function m3(n,e){return{name:yl(n,e.key),fields:e.data.value.mapValue.fields,updateTime:Sa(n,e.version.toTimestamp()),createTime:Sa(n,e.createTime.toTimestamp())}}function JA(n,e,t){let i=Ti(n,e.name),r=st(e.updateTime),s=e.createTime?st(e.createTime):X.min(),o=new Lt({mapValue:{fields:e.fields}}),a=bt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function p3(n,e){K(!!e.found),e.found.name,e.found.updateTime;let t=Ti(n,e.found.name),i=st(e.found.updateTime),r=e.found.createTime?st(e.found.createTime):X.min(),s=new Lt({mapValue:{fields:e.found.fields}});return bt.newFoundDocument(t,i,r,s)}function g3(n,e){K(!!e.missing),K(!!e.readTime);let t=Ti(n,e.missing),i=st(e.readTime);return bt.newNoDocument(t,i)}function b3(n,e){return"found"in e?p3(n,e):"missing"in e?g3(n,e):U()}function y3(n,e){let t;if("targetChange"in e){e.targetChange;let i=v3(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=u3(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&c3(o);t=new $h(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Ti(n,i.document.name),s=st(i.document.updateTime),o=i.document.createTime?st(i.document.createTime):X.min(),a=new Lt({mapValue:{fields:i.document.fields}}),c=bt.newFoundDocument(r,s,o,a),l=i.targetIds||[],d=i.removedTargetIds||[];t=new ba(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Ti(n,i.document),s=i.readTime?st(i.readTime):X.min(),o=bt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new ba([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Ti(n,i.document),s=i.removedTargetIds||[];t=new ba([],s,r,null)}else if("filter"in e){e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new pv(r,s),a=i.targetId;t=new Hh(a,o)}else return U();return t}function v3(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:U()}function _3(n){if(!("targetChange"in n))return X.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?X.min():st(e.readTime)}function vl(n,e){let t;if(e instanceof Wr)t={update:Jk(n,e.key,e.value)};else if(e instanceof Kr)t={delete:yl(n,e.key)};else if(e instanceof Wn)t={update:Jk(n,e.key,e.data),updateMask:J3(e.fieldMask)};else if(e instanceof fl)t={verify:yl(n,e.key)};else return U();return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>C3(n,i))),e.precondition.isNone||(t.currentDocument=x3(n,e.precondition)),t}function Ev(n,e){let t=e.currentDocument?w3(e.currentDocument):et.none(),i=e.updateTransforms?e.updateTransforms.map(r=>S3(n,r)):[];if(e.update){e.update.name;let r=Ti(n,e.update.name),s=new Lt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=eU(e.updateMask);return new Wn(r,s,o,t,i)}else return new Wr(r,s,t,i)}else if(e.delete){let r=Ti(n,e.delete);return new Kr(r,t)}else if(e.verify){let r=Ti(n,e.verify);return new fl(r,t)}else return U()}function x3(n,e){return e.updateTime!==void 0?{updateTime:h3(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:U()}function w3(n){return n.updateTime!==void 0?et.updateTime(st(n.updateTime)):n.exists!==void 0?et.exists(n.exists):et.none()}function E3(n,e){let t=n.updateTime?st(n.updateTime):st(e);return t.isEqual(X.min())&&(t=st(e)),new fv(t,n.transformResults||[])}function T3(n,e){return n&&n.length>0?(K(e!==void 0),n.map(t=>E3(t,e))):[]}function C3(n,e){let t=e.transform;if(t instanceof Hr)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof qi)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Ui)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof $r)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw U()}function S3(n,e){let t=null;if("setToServerValue"in e)K(e.setToServerValue==="REQUEST_TIME"),t=new Hr;else if("appendMissingElements"in e){let r=e.appendMissingElements.values||[];t=new qi(r)}else if("removeAllFromArray"in e){let r=e.removeAllFromArray.values||[];t=new Ui(r)}else"increment"in e?t=new $r(n,e.increment):U();let i=ot.fromServerFormat(e.fieldPath);return new zs(i,t)}function eD(n,e){return{documents:[YA(n,e.path)]}}function k3(n){let e=n.documents.length;K(e===1);let t=n.documents[0];return Kt(za(XA(t)))}function tD(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=YA(n,r);let s=R3(e.filters);s&&(t.structuredQuery.where=s);let o=O3(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=_v(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=P3(e.startAt)),e.endAt&&(t.structuredQuery.endAt=L3(e.endAt)),{queryTarget:t,parent:r}}function nD(n){let e=XA(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){K(i===1);let d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=N3(t.where));let o=[];t.orderBy&&(o=F3(t.orderBy));let a=null;t.limit&&(a=l3(t.limit));let c=null;t.startAt&&(c=B3(t.startAt));let l=null;return t.endAt&&(l=V3(t.endAt)),AA(e,r,o,s,a,"F",c,l)}function I3(n){return Kt(nD(n))}function A3(n,e){let t=D3(e.purpose);return t==null?null:{"goog-listen-tags":t}}function D3(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}function M3(n,e){let t,i=e.target;if(jh(i)?t={documents:eD(n,i)}:t={query:tD(n,i).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=KA(n,e.resumeToken);let r=_v(n,e.expectedCount);r!==null&&(t.expectedCount=r)}else if(e.snapshotVersion.compareTo(X.min())>0){t.readTime=Sa(n,e.snapshotVersion.toTimestamp());let r=_v(n,e.expectedCount);r!==null&&(t.expectedCount=r)}return t}function R3(n){if(n.length!==0)return rD(Te.create(n,"and"))}function N3(n){let e=iD(n);return e instanceof Te&&Y_(e)?e.getFilters():[e]}function iD(n){return n.unaryFilter!==void 0?Y3(n):n.fieldFilter!==void 0?X3(n):n.compositeFilter!==void 0?Z3(n):U()}function O3(n){if(n.length!==0)return n.map(e=>$3(e))}function F3(n){return n.map(e=>W3(e))}function P3(n){return{before:n.inclusive,values:n.position}}function L3(n){return{before:!n.inclusive,values:n.position}}function B3(n){let e=!!n.before,t=n.values||[];return new Si(t,e)}function V3(n){let e=!n.before,t=n.values||[];return new Si(t,e)}function z3(n){return s3[n]}function q3(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function U3(n){return o3[n]}function j3(n){return a3[n]}function G3(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U();default:return U()}}function H3(n){switch(n){case"AND":return"and";case"OR":return"or";default:return U()}}function ua(n){return{fieldPath:n.canonicalString()}}function ma(n){return ot.fromServerFormat(n.fieldPath)}function $3(n){return{field:ua(n.field),direction:z3(n.dir)}}function W3(n){return new Bs(ma(n.field),q3(n.direction))}function rD(n){return n instanceof ue?Q3(n):n instanceof Te?K3(n):U()}function K3(n){let e=n.getFilters().map(t=>rD(t));return e.length===1?e[0]:{compositeFilter:{op:j3(n.op),filters:e}}}function Q3(n){if(n.op==="=="){if(Uk(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NAN"}};if(qk(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Uk(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NOT_NAN"}};if(qk(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ua(n.field),op:U3(n.op),value:n.value}}}function Y3(n){switch(n.unaryFilter.op){case"IS_NAN":let e=ma(n.unaryFilter.field);return ue.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=ma(n.unaryFilter.field);return ue.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=ma(n.unaryFilter.field);return ue.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let r=ma(n.unaryFilter.field);return ue.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U();default:return U()}}function X3(n){return ue.create(ma(n.fieldFilter.field),G3(n.fieldFilter.op),n.fieldFilter.value)}function Z3(n){return Te.create(n.compositeFilter.filters.map(e=>iD(e)),H3(n.compositeFilter.op))}function J3(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function eU(n){let e=n.fieldPaths||[];return new pn(e.map(t=>ot.fromServerFormat(t)))}function sD(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ka=class n{constructor(e,t,i,r,s=X.min(),o=X.min(),a=at.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Kh=class{constructor(e){this.remoteSerializer=e}};function tU(n,e){let t;if(e.document)t=JA(n.remoteSerializer,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let i=B.fromSegments(e.noDocument.path),r=Us(e.noDocument.readTime);t=bt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else if(e.unknownDocument){let i=B.fromSegments(e.unknownDocument.path),r=Us(e.unknownDocument.version);t=bt.newUnknownDocument(i,r)}else return U();return e.readTime&&t.setReadTime(nU(e.readTime)),t}function eI(n,e){let t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Bf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=m3(n.remoteSerializer,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:qs(e.version)};else if(e.isUnknownDocument())i.unknownDocument={path:t.path.toArray(),version:qs(e.version)};else return U();return i}function Bf(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function nU(n){let e=new Ye(n[0],n[1]);return X.fromTimestamp(e)}function qs(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Us(n){let e=new Ye(n.seconds,n.nanoseconds);return X.fromTimestamp(e)}function iU(n,e,t){let i=t.baseMutations.map(s=>vl(n.remoteSerializer,s)),r=t.mutations.map(s=>vl(n.remoteSerializer,s));return{userId:e,batchId:t.batchId,localWriteTimeMs:t.localWriteTime.toMillis(),baseMutations:i,mutations:r}}function ks(n,e){let t=(e.baseMutations||[]).map(s=>Ev(n.remoteSerializer,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let i=e.mutations.map(s=>Ev(n.remoteSerializer,s)),r=Ye.fromMillis(e.localWriteTimeMs);return new ml(e.batchId,r,t,i)}function Zc(n){let e=Us(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Us(n.lastLimboFreeSnapshotVersion):X.min(),i;return rU(n.query)?i=k3(n.query):i=I3(n.query),new ka(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,at.fromBase64String(n.resumeToken))}function oD(n,e){let t=qs(e.snapshotVersion),i=qs(e.lastLimboFreeSnapshotVersion),r;jh(e.target)?r=eD(n.remoteSerializer,e.target):r=tD(n.remoteSerializer,e.target).queryTarget;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vs(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function rU(n){return n.documents!==void 0}function sU(n){return{id:n.bundleId,createTime:Us(n.createTime),version:n.version}}function oU(n){return{bundleId:n.id,createTime:qs(st(n.createTime)),version:n.version}}function aU(n){return{name:n.name,query:n0(n.bundledQuery),readTime:Us(n.readTime)}}function cU(n){return{name:n.name,readTime:qs(st(n.readTime)),bundledQuery:n.bundledQuery}}function n0(n){let e=nD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Gh(e,e.limit,"L"):e}function lU(n){return{name:n.name,query:n0(n.bundledQuery),readTime:st(n.readTime)}}function dU(n){return{id:n.id,version:n.version,createTime:st(n.createTime)}}function Iy(n,e){return new pl(e.largestBatchId,Ev(n.remoteSerializer,e.overlayMutation))}function uU(n,e,t){let[i,r,s]=aD(e,t.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:t.mutation.key.getCollectionGroup(),largestBatchId:t.largestBatchId,overlayMutation:vl(n.remoteSerializer,t.mutation)}}function aD(n,e){let t=e.path.lastSegment(),i=Wt(e.path.popLast());return[n,i,t]}function hU(n){return{indexId:n.indexId,collectionGroup:n.collectionGroup,fields:n.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function fU(n,e){let t=e?new sl(e.sequenceNumber,new Dn(Us(e.readTime),new B(wi(e.documentKey)),e.largestBatchId)):sl.empty(),i=n.fields.map(([r,s])=>new pa(ot.fromServerFormat(r),s));return new Hy(n.indexId,n.collectionGroup,i,t)}function tI(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:qs(i.readTime),documentKey:Wt(i.documentKey.path),largestBatchId:i.largestBatchId}}var Tv=class{getBundleMetadata(e,t){return nI(e).get(t).next(i=>{if(i)return sU(i)})}saveBundleMetadata(e,t){return nI(e).put(oU(t))}getNamedQuery(e,t){return iI(e).get(t).next(i=>{if(i)return aU(i)})}saveNamedQuery(e,t){return iI(e).put(cU(t))}};function nI(n){return Et(n,Af)}function iI(n){return Et(n,Df)}var Qh=class n{constructor(e,t){this.serializer=e,this.userId=t}static forUser(e,t){let i=t.uid||"";return new n(e,i)}getOverlay(e,t){return Wc(e).get(aD(this.userId,t)).next(i=>i?Iy(this.serializer,i):null)}getOverlays(e,t){let i=Ei();return C.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){let r=[];return i.forEach((s,o)=>{let a=new pl(t,o);r.push(this.saveOverlay(e,a))}),C.waitFor(r)}removeOverlaysForBatchId(e,t,i){let r=new Set;t.forEach(o=>r.add(Wt(o.getCollectionPath())));let s=[];return r.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Wc(e).deleteAll(Jy,a))}),C.waitFor(s)}getOverlaysForCollection(e,t,i){let r=Ei(),s=Wt(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wc(e).loadAll(Jy,o).next(a=>{for(let c of a){let l=Iy(this.serializer,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,t,i,r){let s=Ei(),o,a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wc(e).iterate({index:sA,range:a},(c,l,d)=>{let u=Iy(this.serializer,l);s.size()<r||u.largestBatchId===o?(s.set(u.getKey(),u),o=u.largestBatchId):d.done()}).next(()=>s)}saveOverlay(e,t){return Wc(e).put(uU(this.serializer,this.userId,t))}};function Wc(n){return Et(n,Nf)}var Cv=class{globalsStore(e){return Et(e,G_)}getSessionToken(e){return this.globalsStore(e).get("sessionToken").next(i=>{let r=i?.value;return r?at.fromUint8Array(r):at.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.globalsStore(e).put({name:"sessionToken",value:t.toUint8Array()})}};var mU=5,pU=10,gU=13,Ay=15,bU=20,yU=25,vU=30,_U=37,xU=45,wU=50,EU=53,TU=55,CU=60,SU=2,Vi=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,mU);else if("booleanValue"in e)this.writeValueTypeLabel(t,pU),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,Ay),t.writeNumber(je(e.integerValue));else if("doubleValue"in e){let i=je(e.doubleValue);isNaN(i)?this.writeValueTypeLabel(t,gU):(this.writeValueTypeLabel(t,Ay),ll(i)?t.writeNumber(0):t.writeNumber(i))}else if("timestampValue"in e){let i=e.timestampValue;this.writeValueTypeLabel(t,bU),typeof i=="string"&&(i=zi(i)),t.writeString(`${i.seconds||""}`),t.writeNumber(i.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,vU),t.writeBytes(Ur(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.writeValueTypeLabel(t,xU),t.writeNumber(i.latitude||0),t.writeNumber(i.longitude||0)}else"mapValue"in e?yA(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):Ff(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):U()}writeIndexString(e,t){this.writeValueTypeLabel(t,yU),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let i=e.fields||{};this.writeValueTypeLabel(t,TU);for(let r of Object.keys(i))this.writeIndexString(r,t),this.writeIndexValueAux(i[r],t)}writeIndexVector(e,t){var i,r;let s=e.fields||{};this.writeValueTypeLabel(t,EU);let o=_a,a=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.writeValueTypeLabel(t,Ay),t.writeNumber(je(a)),this.writeIndexString(o,t),this.writeIndexValueAux(s[o],t)}writeIndexArray(e,t){let i=e.values||[];this.writeValueTypeLabel(t,wU);for(let r of i)this.writeIndexValueAux(r,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,_U),B.fromName(e).path.forEach(r=>{this.writeValueTypeLabel(t,CU),this.writeUnlabeledIndexString(r,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(SU)}};Vi.INSTANCE=new Vi;var rI="\uD800",sI="\uDBFF",ra=0,oI=255,aI=1,sa=255,cI=255,lI=0,kU=64,IU=8,AU=1024;function DU(n){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,!1),new Uint8Array(e.buffer)}function MU(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n=n<<4),n>>6||(e+=2,n=n<<2),n>>7||(e+=1),e}function RU(n){let e=0;for(let t=0;t<8;++t){let i=MU(n[t]&255);if(e+=i,i!==8)break}return e}function dI(n){let e=kU-RU(n);return Math.ceil(e/IU)}var Sv=class{constructor(){this.buffer=new Uint8Array(AU),this.position=0}writeBytesAscending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteAscending(i.value),i=t.next();this.writeSeparatorAscending()}writeBytesDescending(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.writeByteDescending(i.value),i=t.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteAscending(i);else if(i<2048)this.writeByteAscending(960|i>>>6),this.writeByteAscending(128|63&i);else if(t<rI||sI<t)this.writeByteAscending(480|i>>>12),this.writeByteAscending(128|63&i>>>6),this.writeByteAscending(128|63&i);else{let r=t.codePointAt(0);this.writeByteAscending(240|r>>>18),this.writeByteAscending(128|63&r>>>12),this.writeByteAscending(128|63&r>>>6),this.writeByteAscending(128|63&r)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.writeByteDescending(i);else if(i<2048)this.writeByteDescending(960|i>>>6),this.writeByteDescending(128|63&i);else if(t<rI||sI<t)this.writeByteDescending(480|i>>>12),this.writeByteDescending(128|63&i>>>6),this.writeByteDescending(128|63&i);else{let r=t.codePointAt(0);this.writeByteDescending(240|r>>>18),this.writeByteDescending(128|63&r>>>12),this.writeByteDescending(128|63&r>>>6),this.writeByteDescending(128|63&r)}}this.writeSeparatorDescending()}writeNumberAscending(e){let t=this.toOrderedBits(e),i=dI(t);this.ensureAvailable(1+i),this.buffer[this.position++]=i&255;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=t[r]&255}writeNumberDescending(e){let t=this.toOrderedBits(e),i=dI(t);this.ensureAvailable(1+i),this.buffer[this.position++]=~(i&255);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(t[r]&255)}writeInfinityAscending(){this.writeEscapedByteAscending(sa),this.writeEscapedByteAscending(cI)}writeInfinityDescending(){this.writeEscapedByteDescending(sa),this.writeEscapedByteDescending(cI)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let t=DU(e),i=(t[0]&128)!==0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}writeByteAscending(e){let t=e&255;t===ra?(this.writeEscapedByteAscending(ra),this.writeEscapedByteAscending(oI)):t===sa?(this.writeEscapedByteAscending(sa),this.writeEscapedByteAscending(lI)):this.writeEscapedByteAscending(t)}writeByteDescending(e){let t=e&255;t===ra?(this.writeEscapedByteDescending(ra),this.writeEscapedByteDescending(oI)):t===sa?(this.writeEscapedByteDescending(sa),this.writeEscapedByteDescending(lI)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(ra),this.writeEscapedByteAscending(aI)}writeSeparatorDescending(){this.writeEscapedByteDescending(ra),this.writeEscapedByteDescending(aI)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let t=e+this.position;if(t<=this.buffer.length)return;let i=this.buffer.length*2;i<t&&(i=t);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},kv=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}},Iv=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}},Is=class{constructor(){this.orderedCode=new Sv,this.ascending=new kv(this.orderedCode),this.descending=new Iv(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return e===0?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}};var As=class n{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}successor(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function Nr(n,e){let t=n.indexId-e.indexId;return t!==0||(t=uI(n.arrayValue,e.arrayValue),t!==0)||(t=uI(n.directionalValue,e.directionalValue),t!==0)?t:B.comparator(n.documentKey,e.documentKey)}function uI(n,e){for(let t=0;t<n.length&&t<e.length;++t){let i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}var Yh=class{constructor(e){this.inequalityFilters=new De((t,i)=>ot.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[];for(let t of e.filters){let i=t;i.isInequality()?this.inequalityFilters=this.inequalityFilters.add(i):this.equalityFilters.push(i)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(K(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let t=V_(e);if(t!==void 0&&!this.hasMatchingEqualityFilter(t))return!1;let i=Fs(e),r=new Set,s=0,o=0;for(;s<i.length&&this.hasMatchingEqualityFilter(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!r.has(a.field.canonicalString())){let c=i[s];if(!this.matchesFilter(a,c)||!this.matchesOrderBy(this.orderBys[o++],c))return!1}++s}for(;s<i.length;++s){let a=i[s];if(o>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[o++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new De(ot.comparator),t=[];for(let i of this.equalityFilters){if(i.field.isKeyField())continue;if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new pa(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new pa(i.field,0))}}for(let i of this.orderBys)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new pa(i.field,i.dir==="asc"?0:1)));return new Hy(Hy.UNKNOWN_ID,this.collectionId,t,sl.empty())}hasMatchingEqualityFilter(e){for(let t of this.equalityFilters)if(this.matchesFilter(t,e))return!0;return!1}matchesFilter(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}matchesOrderBy(e,t){return e.field.isEqual(t.fieldPath)?t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc":!1}};function cD(n){var e,t;if(K(n instanceof ue||n instanceof Te),n instanceof ue)if(n instanceof Uh){let r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ue.create(n.field,"==",s)))||[];return Te.create(r,"or")}else return n;let i=n.filters.map(r=>cD(r));return Te.create(i,n.op)}function NU(n){if(n.getFilters().length===0)return[];let e=Av(cD(n));return K(lD(e)),i0(e)||r0(e)?[e]:e.getFilters()}function i0(n){return n instanceof ue}function r0(n){return n instanceof Te&&Y_(n)}function lD(n){return i0(n)||r0(n)||OU(n)}function OU(n){if(n instanceof Te&&iv(n)){for(let e of n.getFilters())if(!i0(e)&&!r0(e))return!1;return!0}return!1}function Av(n){if(K(n instanceof ue||n instanceof Te),n instanceof ue)return n;if(n.filters.length===1)return Av(n.filters[0]);let e=n.filters.map(i=>Av(i)),t=Te.create(e,n.op);return t=Xh(t),lD(t)?t:(K(t instanceof Te),K(wa(t)),K(t.filters.length>1),t.filters.reduce((i,r)=>s0(i,r)))}function s0(n,e){K(n instanceof ue||n instanceof Te),K(e instanceof ue||e instanceof Te);let t;return n instanceof ue?e instanceof ue?t=FU(n,e):t=hI(n,e):e instanceof ue?t=hI(e,n):t=PU(n,e),Xh(t)}function FU(n,e){return Te.create([n,e],"and")}function PU(n,e){if(K(n.filters.length>0&&e.filters.length>0),wa(n)&&wa(e))return TA(n,e.getFilters());let t=iv(n)?n:e,i=iv(n)?e:n,r=t.filters.map(s=>s0(s,i));return Te.create(r,"or")}function hI(n,e){if(wa(e))return TA(e,n.getFilters());{let t=e.filters.map(i=>s0(n,i));return Te.create(t,"or")}}function Xh(n){if(K(n instanceof ue||n instanceof Te),n instanceof ue)return n;let e=n.getFilters();if(e.length===1)return Xh(e[0]);if(wA(n))return n;let t=e.map(r=>Xh(r)),i=[];return t.forEach(r=>{r instanceof ue?i.push(r):r instanceof Te&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:Te.create(i,n.op)}var Dv=class{constructor(){this.collectionParentIndex=new _l}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(Dn.min())}updateCollectionGroup(e,t,i){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},_l=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new De(fe.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new De(fe.comparator)).toArray()}};var fI="IndexedDbIndexManager",Ch=new Uint8Array(0),Mv=class{constructor(e,t){this.databaseId=t,this.collectionParentsCache=new _l,this.targetToDnfSubTargets=new ki(i=>Vs(i),(i,r)=>Nl(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.collectionParentsCache.has(t)){let i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(t)});let s={collectionId:i,parent:Wt(r)};return mI(e).put(s)}return C.resolve()}getCollectionParents(e,t){let i=[],r=IDBKeyRange.bound([t,""],[HI(t),""],!1,!0);return mI(e).loadAll(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;i.push(wi(o.parent))}return i})}addFieldIndex(e,t){let i=Kc(e),r=hU(t);delete r.indexId;let s=i.add(r);if(t.indexState){let o=aa(e);return s.next(a=>{o.put(tI(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}else return s.next()}deleteFieldIndex(e,t){let i=Kc(e),r=aa(e),s=oa(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Kc(e),i=oa(e),r=aa(e);return t.deleteAll().next(()=>i.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,t){return C.forEach(this.getSubTargets(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){let o=new Yh(i).buildTargetIndex();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let i=oa(e),r=!0,s=new Map;return C.forEach(this.getSubTargets(t),o=>this.getFieldIndex(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=ie(),a=[];return C.forEach(s,(c,l)=>{O(fI,`Using index ${Gz(c)} to execute ${Vs(t)}`);let d=pq(l,c),u=gq(l,c),f=bq(l,c),b=yq(l,c),E=this.encodeBound(c,l,f),T=this.encodeBound(c,l,b),S=this.encodeValues(c,l,u),M=this.generateIndexRanges(c.indexId,d,E,f.inclusive,T,b.inclusive,S);return C.forEach(M,I=>i.loadFirst(I,t.limit).next(F=>{F.forEach(P=>{let G=B.fromSegments(P.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}else return C.resolve(null)})}getSubTargets(e){let t=this.targetToDnfSubTargets.get(e);return t||(e.filters.length===0?t=[e]:t=NU(Te.create(e.filters,"and")).map(r=>hv(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,t),t)}generateIndexRanges(e,t,i,r,s,o,a){let c=(t!=null?t.length:1)*Math.max(i.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let u=0;u<c;++u){let f=t?this.encodeSingleElement(t[u/l]):Ch,b=this.generateLowerBound(e,f,i[u%l],r),E=this.generateUpperBound(e,f,s[u%l],o),T=a.map(S=>this.generateLowerBound(e,f,S,!0));d.push(...this.createRange(b,E,T))}return d}generateLowerBound(e,t,i,r){let s=new As(e,B.empty(),t,i);return r?s:s.successor()}generateUpperBound(e,t,i,r){let s=new As(e,B.empty(),t,i);return r?s.successor():s}getFieldIndex(e,t){let i=new Yh(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let a of s)i.servedByIndex(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2,r=this.getSubTargets(t);return C.forEach(r,s=>this.getFieldIndex(e,s).next(o=>{o?i!==0&&o.fields.length<vq(s)&&(i=1):i=0})).next(()=>_q(t)&&r.length>1&&i===2?1:i)}encodeDirectionalElements(e,t){let i=new Is;for(let r of Fs(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=i.forKind(r.kind);Vi.INSTANCE.writeIndexValue(s,o)}return i.encodedBytes()}encodeSingleElement(e){let t=new Is;return Vi.INSTANCE.writeIndexValue(e,t.forKind(0)),t.encodedBytes()}encodeDirectionalKey(e,t){let i=new Is;return Vi.INSTANCE.writeIndexValue(Ls(this.databaseId,t),i.forKind(jz(e))),i.encodedBytes()}encodeValues(e,t,i){if(i===null)return[];let r=[];r.push(new Is);let s=0;for(let o of Fs(e)){let a=i[s++];for(let c of r)if(this.isInFilter(t,o.fieldPath)&&ul(a))r=this.expandIndexValues(r,o,a);else{let l=c.forKind(o.kind);Vi.INSTANCE.writeIndexValue(a,l)}}return this.getEncodedBytes(r)}encodeBound(e,t,i){return this.encodeValues(e,t,i.position)}getEncodedBytes(e){let t=[];for(let i=0;i<e.length;++i)t[i]=e[i].encodedBytes();return t}expandIndexValues(e,t,i){let r=[...e],s=[];for(let o of i.arrayValue.values||[])for(let a of r){let c=new Is;c.seed(a.encodedBytes()),Vi.INSTANCE.writeIndexValue(o,c.forKind(t.kind)),s.push(c)}return s}isInFilter(e,t){return!!e.filters.find(i=>i instanceof ue&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){let i=Kc(e),r=aa(e);return(t?i.loadAll(Zy,IDBKeyRange.bound(t,t)):i.loadAll()).next(s=>{let o=[];return C.forEach(s,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(fU(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{let s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:ne(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){let r=Kc(e),s=aa(e);return this.getNextSequenceNumber(e).next(o=>r.loadAll(Zy,IDBKeyRange.bound(t,t)).next(a=>C.forEach(a,c=>s.put(tI(c.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){let i=new Map;return C.forEach(t,(r,s)=>{let o=i.get(r.collectionGroup);return(o?C.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(i.set(r.collectionGroup,c),C.forEach(c,l=>this.getExistingIndexEntries(e,r,l).next(d=>{let u=this.computeIndexEntries(s,l);return d.isEqual(u)?C.resolve():this.updateEntries(e,s,l,d,u)}))))})}addIndexEntry(e,t,i,r){return oa(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(i,t.key),documentKey:t.key.path.toArray()})}deleteIndexEntry(e,t,i,r){return oa(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(i,t.key),t.key.path.toArray()])}getExistingIndexEntries(e,t,i){let r=oa(e),s=new De(Nr);return r.iterate({index:rA,range:IDBKeyRange.only([i.indexId,this.uid,this.encodeDirectionalKey(i,t)])},(o,a)=>{s=s.add(new As(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}computeIndexEntries(e,t){let i=new De(Nr),r=this.encodeDirectionalElements(t,e);if(r==null)return i;let s=V_(t);if(s!=null){let o=e.data.field(s.fieldPath);if(ul(o))for(let a of o.arrayValue.values||[])i=i.add(new As(t.indexId,e.key,this.encodeSingleElement(a),r))}else i=i.add(new As(t.indexId,e.key,Ch,r));return i}updateEntries(e,t,i,r,s){O(fI,"Updating index entries for document '%s'",t.key);let o=[];return A4(r,s,Nr,a=>{o.push(this.addIndexEntry(e,t,i,a))},a=>{o.push(this.deleteIndexEntry(e,t,i,a))}),C.waitFor(o)}getNextSequenceNumber(e){let t=1;return aa(e).iterate({index:iA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>Nr(o,a)).filter((o,a,c)=>!a||Nr(o,c[a-1])!==0);let r=[];r.push(e);for(let o of i){let a=Nr(o,e),c=Nr(o,t);if(a===0)r[0]=e.successor();else if(a>0&&c<0)r.push(o),r.push(o.successor());else if(c>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.isRangeMatchable(r[o],r[o+1]))return[];let a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ch,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ch,[]];s.push(IDBKeyRange.bound(a,c))}return s}isRangeMatchable(e,t){return Nr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(pI)}getMinOffset(e,t){return C.mapArray(this.getSubTargets(t),i=>this.getFieldIndex(e,i).next(r=>r||U())).next(pI)}};function mI(n){return Et(n,ol)}function oa(n){return Et(n,Rf)}function Kc(n){return Et(n,j_)}function aa(n){return Et(n,Mf)}function pI(n){K(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;z_(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Dn(e.readTime,e.documentKey,t)}function dD(n,e,t){let i=n.store(jn),r=n.store(La),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=i.iterate({range:o},(d,u,f)=>(a++,f.delete()));s.push(c.next(()=>{K(a===1)}));let l=[];for(let d of t.mutations){let u=eA(e,d.key.path,t.batchId);s.push(r.delete(u)),l.push(d.key)}return C.waitFor(s).next(()=>l)}function Zh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else if(n.noDocument)e=n.noDocument;else throw U();return JSON.stringify(e).length}var Jh=class n{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,t,i,r){K(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,i,r)}checkEmpty(e){let t=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).iterate({index:Ds,range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){let s=ha(e),o=Or(e);return o.add({}).next(a=>{K(typeof a=="number");let c=new ml(a,t,i,r),l=iU(this.serializer,this.userId,c),d=[],u=new De((f,b)=>ne(f.canonicalString(),b.canonicalString()));for(let f of r){let b=eA(this.userId,f.key.path,a);u=u.add(f.key.path.popLast()),d.push(o.put(l)),d.push(s.put(b,Zz))}return u.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[a]=c.keys()}),C.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Or(e).get(t).next(i=>i?(K(i.userId===this.userId),ks(this.serializer,i)):null)}lookupMutationKeys(e,t){return this.documentKeysByBatchId[t]?C.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){let r=i.keys();return this.documentKeysByBatchId[t]=r,r}else return null})}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return Or(e).iterate({index:Ds,range:r},(o,a,c)=>{a.userId===this.userId&&(K(a.batchId>=i),s=ks(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=Vr;return Or(e).iterate({index:Ds,range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Vr],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).loadAll(Ds,t).next(i=>i.map(r=>ks(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let i=Ah(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return ha(e).iterate({range:r},(o,a,c)=>{let[l,d,u]=o,f=wi(d);if(l!==this.userId||!t.path.isEqual(f)){c.done();return}return Or(e).get(u).next(b=>{if(!b)throw U();K(b.userId===this.userId),s.push(ks(this.serializer,b))})}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new De(ne),r=[];return t.forEach(s=>{let o=Ah(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=ha(e).iterate({range:a},(l,d,u)=>{let[f,b,E]=l,T=wi(b);if(f!==this.userId||!s.path.isEqual(T)){u.done();return}i=i.add(E)});r.push(c)}),C.waitFor(r).next(()=>this.lookupMutationBatches(e,i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=Ah(this.userId,i),o=IDBKeyRange.lowerBound(s),a=new De(ne);return ha(e).iterate({range:o},(c,l,d)=>{let[u,f,b]=c,E=wi(f);if(u!==this.userId||!i.isPrefixOf(E)){d.done();return}E.length===r&&(a=a.add(b))}).next(()=>this.lookupMutationBatches(e,a))}lookupMutationBatches(e,t){let i=[],r=[];return t.forEach(s=>{r.push(Or(e).get(s).next(o=>{if(o===null)throw U();K(o.userId===this.userId),i.push(ks(this.serializer,o))}))}),C.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return dD(e.simpleDbTransaction,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(t.batchId)}),C.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();let i=IDBKeyRange.lowerBound(Xz(this.userId)),r=[];return ha(e).iterate({range:i},(s,o,a)=>{if(s[0]!==this.userId){a.done();return}else{let l=wi(s[1]);r.push(l)}}).next(()=>{K(r.length===0)})})}containsKey(e,t){return uD(e,this.userId,t)}getMutationQueueMetadata(e){return hD(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Vr,lastStreamToken:""})}};function uD(n,e,t){let i=Ah(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return ha(n).iterate({range:s,keysOnly:!0},(a,c,l)=>{let[d,u,f]=a;d===e&&u===r&&(o=!0),l.done()}).next(()=>o)}function LU(n,e){let t=!1;return hD(n).iterateSerial(i=>uD(n,i,e).next(r=>(r&&(t=!0),C.resolve(!r)))).next(()=>t)}function Or(n){return Et(n,jn)}function ha(n){return Et(n,La)}function hD(n){return Et(n,Dl)}var Dy=2,Ia=class n{constructor(e){this.lastId=e}next(){return this.lastId+=Dy,this.lastId}static forTargetCache(){return new n(2-Dy)}static forSyncEngine(){return new n(1-Dy)}};var Rv=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.retrieveMetadata(e).next(t=>{let i=new Ia(t.highestTargetId);return t.highestTargetId=i.next(),this.saveMetadata(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(t=>X.fromTimestamp(new Ye(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.saveMetadata(e,r)))}addTargetData(e,t){return this.saveTargetData(e,t).next(()=>this.retrieveMetadata(e).next(i=>(i.targetCount+=1,this.updateMetadataFromTargetData(t,i),this.saveMetadata(e,i))))}updateTargetData(e,t){return this.saveTargetData(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ca(e).delete(t.targetId)).next(()=>this.retrieveMetadata(e)).next(i=>(K(i.targetCount>0),i.targetCount-=1,this.saveMetadata(e,i)))}removeTargets(e,t,i){let r=0,s=[];return ca(e).iterate((o,a)=>{let c=Zc(a);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))}).next(()=>C.waitFor(s)).next(()=>r)}forEachTarget(e,t){return ca(e).iterate((i,r)=>{let s=Zc(r);t(s)})}retrieveMetadata(e){return gI(e).get(Vh).next(t=>(K(t!==null),t))}saveMetadata(e,t){return gI(e).put(Vh,t)}saveTargetData(e,t){return ca(e).put(oD(this.serializer,t))}updateMetadataFromTargetData(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.retrieveMetadata(e).next(t=>t.targetCount)}getTargetData(e,t){let i=Vs(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),s=null;return ca(e).iterate({range:r,index:nA},(o,a,c)=>{let l=Zc(a);Nl(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,i){let r=[],s=Pr(e);return t.forEach(o=>{let a=Wt(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),C.waitFor(r)}removeMatchingKeys(e,t,i){let r=Pr(e);return C.forEach(t,s=>{let o=Wt(s.path);return C.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){let i=Pr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){let i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Pr(e),s=ie();return r.iterate({range:i,keysOnly:!0},(o,a,c)=>{let l=wi(o[1]),d=new B(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let i=Wt(t.path),r=IDBKeyRange.bound([i],[HI(i)],!1,!0),s=0;return Pr(e).iterate({index:U_,keysOnly:!0,range:r},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}getTargetDataForTarget(e,t){return ca(e).get(t).next(i=>i?Zc(i):null)}};function ca(n){return Et(n,Ba)}function gI(n){return Et(n,Ks)}function Pr(n){return Et(n,Va)}var bI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Pl=-1,fD=40*1024*1024,An=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};An.DEFAULT_COLLECTION_PERCENTILE=10;An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;An.DEFAULT=new An(fD,An.DEFAULT_COLLECTION_PERCENTILE,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);An.DISABLED=new An(Pl,0,0);var yI="LruGarbageCollector",vI=1*1024*1024,BU=1*60*1e3,VU=5*60*1e3;function _I([n,e],[t,i]){let r=ne(n,t);return r===0?ne(e,i):r}var Nv=class{constructor(e){this.maxElements=e,this.buffer=new De(_I),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();_I(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ov=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==Pl&&this.scheduleGC(BU)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){O(yI,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>w(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zr(t)?O(yI,"Ignoring IndexedDB error during garbage collection: ",t):yield Xr(t)}yield this.scheduleGC(VU)}))}},Fv=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return C.resolve(mn.INVALID);let i=new Nv(t);return this.delegate.forEachTarget(e,r=>i.addElement(r.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,r=>i.addElement(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.delegate.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===Pl?(O("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(bI)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bI):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let i,r,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),r=this.params.maximumSequenceNumbersToCollect):r=u,o=Date.now(),this.nthSequenceNumber(e,r))).next(u=>(i=u,a=Date.now(),this.removeTargets(e,i,t))).next(u=>(s=u,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(u=>{if(l=Date.now(),la()<=ni.DEBUG){let f=`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in ${a-o}ms
	Removed ${s} targets in ${c-a}ms
	Removed ${u} documents in ${l-c}ms
Total Duration: ${l-d}ms`;O("LruGarbageCollector",f)}return C.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:u})})}};function zU(n,e){return new Fv(n,e)}var Pv=class{constructor(e,t){this.db=e,this.garbageCollector=zU(this,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}forEachOrphanedDocumentSequenceNumber(e,t){return this.forEachOrphanedDocument(e,(i,r)=>t(r))}addReference(e,t,i){return Sh(e,i)}removeReference(e,t,i){return Sh(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Sh(e,t)}isPinned(e,t){return LU(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],o=0;return this.forEachOrphanedDocument(e,(c,l)=>{if(l<=t){let d=this.isPinned(e,c).next(u=>{if(!u)return o++,r.getEntry(e,c).next(()=>(r.removeEntry(c,X.min()),Pr(e).delete(qU(c))))});s.push(d)}}).next(()=>C.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Sh(e,t)}forEachOrphanedDocument(e,t){let i=Pr(e),r=mn.INVALID,s;return i.iterate({index:U_},([o,a],{path:c,sequenceNumber:l})=>{o===0?(r!==mn.INVALID&&t(new B(wi(s)),r),r=l,s=c):r=mn.INVALID}).next(()=>{r!==mn.INVALID&&t(new B(wi(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function qU(n){return[0,Wt(n.path)]}function UU(n,e){return{targetId:0,path:Wt(n.path),sequenceNumber:e}}function Sh(n,e){return Pr(n).put(UU(e,n.currentSequenceNumber))}var ef=class{constructor(){this.changes=new ki(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?C.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Lv=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Ts(e).put(i)}removeEntry(e,t,i){return Ts(e).delete(jU(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.setMetadata(e,i)))}getEntry(e,t){let i=bt.newInvalidDocument(t);return Ts(e).iterate({index:Dh,range:IDBKeyRange.only(Qc(t))},(r,s)=>{i=this.maybeDecodeDocument(t,s)}).next(()=>i)}getSizedEntry(e,t){let i={size:0,document:bt.newInvalidDocument(t)};return Ts(e).iterate({index:Dh,range:IDBKeyRange.only(Qc(t))},(r,s)=>{i={document:this.maybeDecodeDocument(t,s),size:Zh(s)}}).next(()=>i)}getEntries(e,t){let i=rn();return this.forEachDbEntry(e,t,(r,s)=>{let o=this.maybeDecodeDocument(r,s);i=i.insert(r,o)}).next(()=>i)}getSizedEntries(e,t){let i=rn(),r=new Le(B.comparator);return this.forEachDbEntry(e,t,(s,o)=>{let a=this.maybeDecodeDocument(s,o);i=i.insert(s,a),r=r.insert(s,Zh(o))}).next(()=>({documents:i,sizeMap:r}))}forEachDbEntry(e,t,i){if(t.isEmpty())return C.resolve();let r=new De(EI);t.forEach(c=>r=r.add(c));let s=IDBKeyRange.bound(Qc(r.first()),Qc(r.last())),o=r.getIterator(),a=o.getNext();return Ts(e).iterate({index:Dh,range:s},(c,l,d)=>{let u=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&EI(a,u)<0;)i(a,null),a=o.getNext();a&&a.isEqual(u)&&(i(a,l),a=o.hasNext()?o.getNext():null),a?d.skip(Qc(a)):d.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Bf(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ts(e).loadAll(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=rn();for(let u of l){let f=this.maybeDecodeDocument(B.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);f.isFoundDocument()&&(Fl(t,f)||r.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,t,i,r){let s=rn(),o=wI(t,i),a=wI(t,Dn.max());return Ts(e).iterate({index:tA,range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let u=this.maybeDecodeDocument(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(u.key,u),s.size===r&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Bv(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return xI(e).get(Xy).next(t=>(K(!!t),t))}setMetadata(e,t){return xI(e).put(Xy,t)}maybeDecodeDocument(e,t){if(t){let i=tU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(X.min())))return i}return bt.newInvalidDocument(e)}};function mD(n){return new Lv(n)}var Bv=class extends ef{constructor(e,t){super(),this.documentCache=e,this.trackRemovals=t,this.documentStates=new ki(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){let t=[],i=0,r=new De((s,o)=>ne(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.documentStates.get(s);if(t.push(this.documentCache.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=eI(this.documentCache.serializer,o);r=r.add(s.path.popLast());let l=Zh(c);i+=l-a.size,t.push(this.documentCache.addEntry(e,s,c))}else if(i-=a.size,this.trackRemovals){let c=eI(this.documentCache.serializer,o.convertToNoDocument(X.min()));t.push(this.documentCache.addEntry(e,s,c))}}),r.forEach(s=>{t.push(this.documentCache.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.documentCache.updateMetadata(e,i)),C.waitFor(t)}getFromCache(e,t){return this.documentCache.getSizedEntry(e,t).next(i=>(this.documentStates.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.documentCache.getSizedEntries(e,t).next(({documents:i,sizeMap:r})=>(r.forEach((s,o)=>{this.documentStates.set(s,{size:o,readTime:i.get(s).readTime})}),i))}};function xI(n){return Et(n,Ml)}function Ts(n){return Et(n,If)}function Qc(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function jU(n,e){let t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],Bf(e),t[t.length-1]]}function wI(n,e){let t=e.documentKey.path.toArray();return[n,Bf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function EI(n,e){let t=n.path.toArray(),i=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=ne(t[s],i[s]),r)return r;return r=ne(t.length,i.length),r||(r=ne(t[t.length-2],i[i.length-2]),r)?r:ne(t[t.length-1],i[i.length-1])}var GU=17;var Vv=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var tf=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&nl(i.mutation,r,pn.empty(),Ye.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ie()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ie()){let r=Ei();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Xc();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=Ei();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ie()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=rn(),o=hl(),a=Fq();return t.forEach((c,l)=>{let d=i.get(l.key);r.has(l.key)&&(d===void 0||d.mutation instanceof Wn)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),nl(d.mutation,l,d.mutation.getFieldMask(),Ye.now())):o.set(l.key,pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var u;return a.set(l,new Vv(d,(u=o.get(l))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(e,t){let i=hl(),r=new Le((o,a)=>o-a),s=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=i.get(c)||pn.empty();d=a.applyToLocalView(l,d),i.set(c,d);let u=(r.get(a.batchId)||ie()).add(c);r=r.insert(a.batchId,u)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,u=FA();d.forEach(f=>{if(!s.has(f)){let b=UA(t.get(f),i.get(f));b!==null&&u.set(f,b),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,u))}return C.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return Tq(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):X_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):C.resolve(Ei()),a=ya,c=s;return o.next(l=>C.forEach(l,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),s.get(d)?C.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ie())).next(d=>({batchId:a,changes:OA(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(i=>{let r=Xc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=Xc();return this.indexManager.getCollectionParents(e,s).next(a=>C.forEach(a,c=>{let l=xq(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,i,r).next(d=>{d.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,bt.newInvalidDocument(d)))});let a=Xc();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&nl(d.mutation,l,pn.empty(),Ye.now()),Fl(t,l)&&(a=a.insert(c,l))}),a})}};var zv=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return C.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,dU(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,lU(t)),C.resolve()}};var qv=class{constructor(){this.overlays=new Le(B.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ei();return C.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.saveOverlay(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.overlayByBatchId.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(i)),C.resolve()}getOverlaysForCollection(e,t,i){let r=Ei(),s=t.length+1,o=new B(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return C.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Le((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>i){let f=s.get(d.largestBatchId);f===null&&(f=Ei(),s=s.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}let a=Ei(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=r)););return C.resolve(a)}saveOverlay(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.overlayByBatchId.get(r.largestBatchId).delete(i.key);this.overlayByBatchId.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new pl(t,i));let s=this.overlayByBatchId.get(t);s===void 0&&(s=ie(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(i.key))}};var Uv=class{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var xl=class{constructor(){this.refsByKey=new De(pt.compareByKey),this.refsByTarget=new De(pt.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let i=new pt(e,t);this.refsByKey=this.refsByKey.add(i),this.refsByTarget=this.refsByTarget.add(i)}addReferences(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.removeRef(new pt(e,t))}removeReferences(e,t){e.forEach(i=>this.removeReference(i,t))}removeReferencesForId(e){let t=new B(new fe([])),i=new pt(t,e),r=new pt(t,e+1),s=[];return this.refsByTarget.forEachInRange([i,r],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new B(new fe([])),i=new pt(t,e),r=new pt(t,e+1),s=ie();return this.refsByTarget.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new pt(e,0),i=this.refsByKey.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},pt=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return B.comparator(e.key,t.key)||ne(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return ne(e.targetOrBatchId,t.targetOrBatchId)||B.comparator(e.key,t.key)}};var jv=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new De(pt.compareByKey)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ml(s,t,i,r);this.mutationQueue.push(o);for(let a of r)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new pt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.indexOfBatchId(i),s=r<0?0:r;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?Vr:this.nextBatchId-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new pt(t,0),r=new pt(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([i,r],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new De(ne);return t.forEach(r=>{let s=new pt(r,0),o=new pt(r,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{i=i.add(a.targetOrBatchId)})}),C.resolve(this.findMutationBatches(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;B.isDocumentKey(s)||(s=s.child(""));let o=new pt(new B(s),0),a=new De(ne);return this.batchesByDocumentKey.forEachWhile(c=>{let l=c.key.path;return i.isPrefixOf(l)?(l.length===r&&(a=a.add(c.targetOrBatchId)),!0):!1},o),C.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(i=>{let r=this.findMutationBatch(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){let i=this.indexOfExistingBatchId(t.batchId,"removed");K(i===0),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return C.forEach(t.mutations,s=>{let o=new pt(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let i=new pt(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(i);return C.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};function HU(){return new Le(B.comparator)}var Gv=class{constructor(e){this.sizer=e,this.docs=HU(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.sizer(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return C.resolve(i?i.document.mutableCopy():bt.newInvalidDocument(t))}getEntries(e,t){let i=rn();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():bt.newInvalidDocument(r))}),C.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rn(),o=t.path,a=new B(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||z_(WI(d),i)<=0||!r.has(d.key)&&!Fl(t,d)||(s=s.insert(d.key,d.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,i,r){U()}forEachDocumentKey(e,t){return C.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Hv(this)}getSize(e){return C.resolve(this.size)}};function $U(n){return new Gv(n)}var Hv=class extends ef{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(i)}),C.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var $v=class{constructor(e){this.persistence=e,this.targets=new ki(t=>Vs(t),Nl),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new xl,this.targetCount=0,this.targetIdGenerator=Ia.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((i,r)=>t(r)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),C.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new Ia(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.saveTargetData(t),C.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),C.waitFor(s).next(()=>r)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let i=this.targets.get(t)||null;return C.resolve(i)}addMatchingKeys(e,t,i){return this.references.addReferences(t,i),C.resolve()}removeMatchingKeys(e,t,i){this.references.removeReferences(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),C.resolve()}getMatchingKeysForTargetId(e,t){let i=this.references.referencesForId(t);return C.resolve(i)}containsKey(e,t){return C.resolve(this.references.containsKey(t))}};var WU="MemoryPersistence",nf=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new mn(0),this._started=!1,this._started=!0,this.globalsCache=new Uv,this.referenceDelegate=e(this),this.targetCache=new $v(this);let i=r=>this.referenceDelegate.documentSize(r);this.indexManager=new Dv,this.remoteDocumentCache=$U(i),this.serializer=new Kh(t),this.bundleCache=new zv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.mutationQueues[e.toKey()];return i||(i=new jv(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=i),i}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){O(WU,"Starting transaction:",e);let r=new Wv(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),i(r).next(s=>this.referenceDelegate.onTransactionCommitted(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return C.or(Object.values(this.mutationQueues).map(i=>()=>i.containsKey(e,t)))}},Wv=class extends Lh{constructor(e){super(),this.currentSequenceNumber=e}},rf=class n{constructor(e){this.persistence=e,this.localViewReferences=new xl,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw U()}addReference(e,t,i){return this.localViewReferences.addReference(i,t),this.orphanedDocuments.delete(i.toString()),C.resolve()}removeReference(e,t,i){return this.localViewReferences.removeReference(i,t),this.orphanedDocuments.add(i.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),C.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.orphanedDocuments,r=>{let s=B.fromPath(r);return this.isReferenced(e,s).next(o=>{o||i.removeEntry(s,X.min())})}).next(()=>(this._orphanedDocuments=null,i.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(i=>{i?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return C.or([()=>C.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}};var Kv=class{constructor(e){this.serializer=e}createOrUpgrade(e,t,i,r){let s=new Bh("createOrUpgrade",t);i<1&&r>=1&&(QU(e),YU(e),TI(e),ZU(e));let o=C.resolve();return i<3&&r>=3&&(i!==0&&(tj(e),TI(e)),o=o.next(()=>ij(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>XU(e,s))),o=o.next(()=>{rj(e)})),i<5&&r>=5&&(o=o.next(()=>this.removeAcknowledgedMutations(s))),i<6&&r>=6&&(o=o.next(()=>(ej(e),this.addDocumentGlobal(s)))),i<7&&r>=7&&(o=o.next(()=>this.ensureSequenceNumbers(s))),i<8&&r>=8&&(o=o.next(()=>this.createCollectionParentIndex(e,s))),i<9&&r>=9&&(o=o.next(()=>{nj(e)})),i<10&&r>=10&&(o=o.next(()=>this.rewriteCanonicalIds(s))),i<11&&r>=11&&(o=o.next(()=>{sj(e),oj(e)})),i<12&&r>=12&&(o=o.next(()=>{cj(e)})),i<13&&r>=13&&(o=o.next(()=>JU(e)).next(()=>this.rewriteRemoteDocumentCache(e,s)).next(()=>e.deleteObjectStore(Ss))),i<14&&r>=14&&(o=o.next(()=>this.runOverlayMigration(e,s))),i<15&&r>=15&&(o=o.next(()=>aj(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore(Mf).clear()}).next(()=>{t.objectStore(Rf).clear()})),i<17&&r>=17&&(o=o.next(()=>{lj(e)})),o}addDocumentGlobal(e){let t=0;return e.store(Ss).iterate((i,r)=>{t+=Zh(r)}).next(()=>{let i={byteSize:t};return e.store(Ml).put(Xy,i)})}removeAcknowledgedMutations(e){let t=e.store(Dl),i=e.store(jn);return t.loadAll().next(r=>C.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,Vr],[s.userId,s.lastAcknowledgedBatchId]);return i.loadAll(Ds,o).next(a=>C.forEach(a,c=>{K(c.userId===s.userId);let l=ks(this.serializer,c);return dD(e,s.userId,l).next(()=>{})}))}))}ensureSequenceNumbers(e){let t=e.store(Va),i=e.store(Ss);return e.store(Ks).get(Vh).next(s=>{let o=c=>t.put({targetId:0,path:Wt(c),sequenceNumber:s.highestListenSequenceNumber}),a=[];return i.iterate((c,l)=>{let d=new fe(c),u=KU(d);a.push(t.get(u).next(f=>f?C.resolve():o(d)))}).next(()=>C.waitFor(a))})}createCollectionParentIndex(e,t){e.createObjectStore(ol,{keyPath:o4});let i=t.store(ol),r=new _l,s=o=>{if(r.add(o)){let a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:Wt(c)})}};return t.store(Ss).iterate({keysOnly:!0},(o,a)=>{let c=new fe(o);return s(c.popLast())}).next(()=>t.store(La).iterate({keysOnly:!0},([o,a,c],l)=>{let d=wi(a);return s(d.popLast())}))}rewriteCanonicalIds(e){let t=e.store(Ba);return t.iterate((i,r)=>{let s=Zc(r),o=oD(this.serializer,s);return t.put(o)})}rewriteRemoteDocumentCache(e,t){let i=t.store(Ss),r=[];return i.iterate((s,o)=>{let a=t.store(If),c=dj(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>C.waitFor(r))}runOverlayMigration(e,t){let i=t.store(jn),r=mD(this.serializer),s=new nf(rf.factory,this.serializer.remoteSerializer);return i.loadAll().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();ks(this.serializer,c).keys().forEach(f=>d=d.add(f)),a.set(c.userId,d)}),C.forEach(a,(c,l)=>{let d=new yt(l),u=Qh.forUser(this.serializer,d),f=s.getIndexManager(d),b=Jh.forUser(d,this.serializer,f,s.referenceDelegate);return new tf(r,b,u,f).recalculateAndSaveOverlaysForDocumentKeys(new al(t,mn.INVALID),c).next()})})}};function KU(n){return[0,Wt(n)]}function QU(n){n.createObjectStore(Al)}function YU(n){n.createObjectStore(Dl,{keyPath:Yz}),n.createObjectStore(jn,{keyPath:ZI,autoIncrement:!0}).createIndex(Ds,JI,{unique:!0}),n.createObjectStore(La)}function XU(n,e){return e.store(jn).loadAll().next(i=>{n.deleteObjectStore(jn),n.createObjectStore(jn,{keyPath:ZI,autoIncrement:!0}).createIndex(Ds,JI,{unique:!0});let s=e.store(jn),o=i.map(a=>s.put(a));return C.waitFor(o)})}function ZU(n){n.createObjectStore(Ss)}function JU(n){let e=n.createObjectStore(If,{keyPath:Jz});e.createIndex(Dh,e4),e.createIndex(tA,t4)}function ej(n){n.createObjectStore(Ml)}function TI(n){n.createObjectStore(Va,{keyPath:r4}).createIndex(U_,s4,{unique:!0}),n.createObjectStore(Ba,{keyPath:n4}).createIndex(nA,i4,{unique:!0}),n.createObjectStore(Ks)}function tj(n){n.deleteObjectStore(Va),n.deleteObjectStore(Ba),n.deleteObjectStore(Ks)}function nj(n){n.objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges")}function ij(n){let e=n.store(Ks),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return e.put(Vh,t)}function rj(n){n.createObjectStore(va,{keyPath:a4})}function sj(n){n.createObjectStore(Af,{keyPath:c4})}function oj(n){n.createObjectStore(Df,{keyPath:l4})}function aj(n){n.createObjectStore(j_,{keyPath:d4,autoIncrement:!0}).createIndex(Zy,u4,{unique:!1}),n.createObjectStore(Mf,{keyPath:h4}).createIndex(iA,f4,{unique:!1}),n.createObjectStore(Rf,{keyPath:m4}).createIndex(rA,p4,{unique:!1})}function cj(n){let e=n.createObjectStore(Nf,{keyPath:g4});e.createIndex(Jy,b4,{unique:!1}),e.createIndex(sA,y4,{unique:!1})}function lj(n){n.createObjectStore(G_,{keyPath:v4})}function dj(n){return n.document?new B(fe.fromString(n.document.name).popFirst(5)):n.noDocument?B.fromSegments(n.noDocument.path):n.unknownDocument?B.fromSegments(n.unknownDocument.path):U()}var Fr="IndexedDbPersistence",My=30*60*1e3,Ry=5e3,uj=4e3,Ny="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hj="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",fj="firestore_zombie",pD="main",Qv=class n{constructor(e,t,i,r,s,o,a,c,l,d,u=GU){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.queue=s,this.window=o,this.document=a,this.sequenceNumberSyncer=l,this.forceOwningTab=d,this.schemaVersion=u,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=f=>Promise.resolve(),!n.isAvailable())throw new D(k.UNIMPLEMENTED,hj);this.referenceDelegate=new Pv(this,r),this.dbName=t+pD,this.serializer=new Kh(c),this.simpleDb=new qr(this.dbName,this.schemaVersion,new Kv(this.serializer)),this.globalsCache=new Cv,this.targetCache=new Rv(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mD(this.serializer),this.bundleCache=new Tv,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,d===!1&&Qe(Fr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(k.FAILED_PRECONDITION,Ny);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new mn(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=t=>w(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(t=>w(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(()=>w(this,null,function*(){this.started&&(yield this.updateClientMetadataAndTryBecomePrimary())})))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>kh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(i=>{i||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(i=>this.isPrimary&&!i?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):i?this.acquireOrExtendPrimaryLease(e).next(()=>!0):!1)).catch(e=>{if(Zr(e))return O(Fr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O(Fr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return Yc(e).get(na).next(i=>C.resolve(this.isLocalClient(i)))}removeClientMetadata(e){return kh(e).delete(this.clientId)}maybeGarbageCollectMultiClientState(){return w(this,null,function*(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,My)){this.lastGarbageCollectionTime=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let i=Et(t,va);return i.loadAll().next(r=>{let s=this.filterActiveClients(r,My),o=r.filter(a=>s.indexOf(a)===-1);return C.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.webStorage)for(let t of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(t.clientId))}})}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",uj,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return e?e.ownerId===this.clientId:!1}canActAsPrimary(e){return this.forceOwningTab?C.resolve(!0):Yc(e).get(na).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,Ry)&&!this.isClientZombied(i.ownerId)){if(this.isLocalClient(i)&&this.networkEnabled)return!0;if(!this.isLocalClient(i)){if(!i.allowTabSynchronization)throw new D(k.FAILED_PRECONDITION,Ny);return!1}}return this.networkEnabled&&this.inForeground?!0:kh(e).loadAll().next(s=>this.filterActiveClients(s,Ry).find(a=>{if(this.clientId!==a.clientId){let c=!this.networkEnabled&&a.networkEnabled,l=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(c||l&&d)return!0}return!1})===void 0)}).next(i=>(this.isPrimary!==i&&O(Fr,`Client ${i?"is":"is not"} eligible for a primary lease.`),i))}shutdown(){return w(this,null,function*(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),yield this.simpleDb.runTransaction("shutdown","readwrite",[Al,va],e=>{let t=new al(e,mn.INVALID);return this.releasePrimaryLeaseIfHeld(t).next(()=>this.removeClientMetadata(t))}),this.simpleDb.close(),this.removeClientZombiedEntry()})}filterActiveClients(e,t){return e.filter(i=>this.isWithinAge(i.updateTimeMs,t)&&!this.isClientZombied(i.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>kh(e).loadAll().next(t=>this.filterActiveClients(t,My).map(i=>i.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(e,t){return Jh.forUser(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Mv(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return Qh.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,t,i){O(Fr,"Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=I4(this.schemaVersion),o;return this.simpleDb.runTransaction(e,r,s,a=>(o=new al(a,this.listenSequence?this.listenSequence.next():mn.INVALID),t==="readwrite-primary"?this.verifyPrimaryLease(o).next(c=>c?!0:this.canActAsPrimary(o)).next(c=>{if(!c)throw Qe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new D(k.FAILED_PRECONDITION,KI);return i(o)}).next(c=>this.acquireOrExtendPrimaryLease(o).next(()=>c)):this.verifyAllowTabSynchronization(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(e){return Yc(e).get(na).next(i=>{if(i!==null&&this.isWithinAge(i.leaseTimestampMs,Ry)&&!this.isClientZombied(i.ownerId)&&!this.isLocalClient(i)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!i.allowTabSynchronization))throw new D(k.FAILED_PRECONDITION,Ny)})}acquireOrExtendPrimaryLease(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Yc(e).put(na,t)}static isAvailable(){return qr.isAvailable()}releasePrimaryLeaseIfHeld(e){let t=Yc(e);return t.get(na).next(i=>this.isLocalClient(i)?(O(Fr,"Releasing primary lease."),t.delete(na)):C.resolve())}isWithinAge(e,t){let i=Date.now(),r=i-t,s=i;return e<r?!1:e>s?(Qe(`Detected an update time that is in the future: ${e} > ${s}`),!1):!0}attachVisibilityHandler(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground=this.document.visibilityState==="visible")}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.windowUnloadHandler=()=>{this.markClientZombied();let t=/(?:Version|Mobile)\/1[456]/;wm()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var t;try{let i=((t=this.webStorage)===null||t===void 0?void 0:t.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return O(Fr,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Qe(Fr,"Failed to get zombied client id.",i),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){Qe("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch{}}zombiedClientLocalStorageKey(e){return`${fj}_${this.persistenceKey}_${e}`}};function Yc(n){return Et(n,Al)}function kh(n){return Et(n,va)}function o0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}function mj(n){return w(this,null,function*(){if(!qr.isAvailable())return Promise.resolve();let e=n+pD;yield qr.delete(e)})}function pj(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var a0="LocalStore",gj=5*60*1e6,wl=class{constructor(e,t,i,r){this.persistence=e,this.queryEngine=t,this.serializer=r,this.targetDataByTarget=new Le(ne),this.targetIdByTarget=new ki(s=>Vs(s),Nl),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(i)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tf(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function gD(n,e,t,i){return new wl(n,e,t,i)}function bD(n,e){return w(this,null,function*(){let t=V(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],c=[],l=ie();for(let d of s){a.push(d.batchId);for(let u of d.mutations)l=l.add(u.key)}for(let d of o){c.push(d.batchId);for(let u of d.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(d=>({affectedDocuments:d,removedBatchIds:a,addedBatchIds:c}))})})})}function bj(n,e){let t=V(n),i=Ye.now(),r=e.reduce((a,c)=>a.add(c.key),ie()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let c=rn(),l=ie();return t.remoteDocuments.getEntries(a,r).next(d=>{c=d,c.forEach((u,f)=>{f.isValidDocument()||(l=l.add(u))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,c)).next(d=>{s=d;let u=[];for(let f of e){let b=Wq(f,s.get(f.key).overlayedDocument);b!=null&&u.push(new Wn(f.key,b,_A(b.value.mapValue),et.exists(!0)))}return t.mutationQueue.addMutationBatch(a,i,u,e)}).next(d=>{o=d;let u=d.applyToLocalDocumentSet(s,l);return t.documentOverlayCache.saveOverlays(a,d.batchId,u)})}).then(()=>({batchId:o.batchId,changes:OA(s)}))}function yj(n,e){let t=V(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return Ij(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,vj(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function vj(n){let e=ie();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function _j(n,e){let t=V(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",i=>{let r;return t.mutationQueue.lookupMutationBatch(i,e).next(s=>(K(s!==null),r=s.keys(),t.mutationQueue.removeMutationBatch(i,s))).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,r)).next(()=>t.localDocuments.getDocuments(i,r))})}function xj(n){let e=V(n);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.mutationQueue.getHighestUnacknowledgedBatchId(t))}function yD(n){let e=V(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function wj(n,e){let t=V(n),i=e.snapshotVersion,r=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=t.targetDataByTarget;let a=[];e.targetChanges.forEach((d,u)=>{let f=r.get(u);if(!f)return;a.push(t.targetCache.removeMatchingKeys(s,d.removedDocuments,u).next(()=>t.targetCache.addMatchingKeys(s,d.addedDocuments,u)));let b=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(u)!==null?b=b.withResumeToken(at.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):d.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(d.resumeToken,i)),r=r.insert(u,b),Ej(f,b,d)&&a.push(t.targetCache.updateTargetData(s,b))});let c=rn(),l=ie();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(vD(s,o,e.documentUpdates).next(d=>{c=d.changedDocuments,l=d.existenceChangedKeys})),!i.isEqual(X.min())){let d=t.targetCache.getLastRemoteSnapshotVersion(s).next(u=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(d)}return C.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.targetDataByTarget=r,s))}function vD(n,e,t){let i=ie(),r=ie();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=rn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(X.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):O(a0,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{changedDocuments:o,existenceChangedKeys:r}})}function Ej(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=gj?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function Tj(n,e){return w(this,null,function*(){let t=V(n);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",i=>C.forEach(e,r=>C.forEach(r.addedKeys,s=>t.persistence.referenceDelegate.addReference(i,r.targetId,s)).next(()=>C.forEach(r.removedKeys,s=>t.persistence.referenceDelegate.removeReference(i,r.targetId,s)))))}catch(i){if(Zr(i))O(a0,"Failed to update sequence numbers: "+i);else throw i}for(let i of e){let r=i.targetId;if(!i.fromCache){let s=t.targetDataByTarget.get(r),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(r,a)}}})}function Cj(n,e){let t=V(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Vr),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Sj(n,e){let t=V(n);return t.persistence.runTransaction("read document","readonly",i=>t.localDocuments.getDocument(i,e))}function Aa(n,e){let t=V(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.targetCache.getTargetData(i,e).next(s=>s?(r=s,C.resolve(r)):t.targetCache.allocateTargetId(i).next(o=>(r=new ka(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.targetCache.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.targetDataByTarget.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(i.targetId,i),t.targetIdByTarget.set(e,i.targetId)),i})}function kj(n,e,t){let i=V(n),r=i.targetIdByTarget.get(t);return r!==void 0?C.resolve(i.targetDataByTarget.get(r)):i.targetCache.getTargetData(e,t)}function Da(n,e,t){return w(this,null,function*(){let i=V(n),r=i.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(Zr(o))O(a0,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}i.targetDataByTarget=i.targetDataByTarget.remove(e),i.targetIdByTarget.delete(r.target)})}function Vf(n,e,t){let i=V(n),r=X.min(),s=ie();return i.persistence.runTransaction("Execute query","readwrite",o=>kj(i,o,Kt(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.queryEngine.getDocumentsMatchingQuery(o,e,t?r:X.min(),t?s:ie())).next(a=>(wD(i,MA(e),a),{documents:a,remoteKeys:s})))}function Ij(n,e,t,i){let r=t.batch,s=r.keys(),o=C.resolve();return s.forEach(a=>{o=o.next(()=>i.getEntry(e,a)).next(c=>{let l=t.docVersions.get(a);K(l!==null),c.version.compareTo(l)<0&&(r.applyToRemoteDocument(c,t),c.isValidDocument()&&(c.setReadTime(t.commitVersion),i.addEntry(c)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,r))}function Aj(n,e){let t=V(n),i=V(t.mutationQueue);return t.persistence.runTransaction("Lookup mutation documents","readonly",r=>i.lookupMutationKeys(r,e).next(s=>s?t.localDocuments.getDocuments(r,s):C.resolve(null)))}function Dj(n,e){V(V(n,wl).mutationQueue).removeCachedMutationKeys(e)}function Mj(n){return V(V(n,wl).persistence).getActiveClients()}function _D(n,e){let t=V(n),i=V(t.targetCache),r=t.targetDataByTarget.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.getTargetDataForTarget(s,e).next(o=>o?o.target:null))}function xD(n,e){let t=V(n),i=t.collectionGroupReadTime.get(e)||X.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.remoteDocuments.getAllFromCollectionGroup(r,e,$I(i,ya),Number.MAX_SAFE_INTEGER)).then(r=>(wD(t,e,r),r))}function wD(n,e,t){let i=n.collectionGroupReadTime.get(e)||X.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.collectionGroupReadTime.set(e,i)}function Rj(n){return Kt(za(fe.fromString(`__bundle__/docs/${n}`)))}function Nj(n,e,t,i){return w(this,null,function*(){let r=V(n),s=ie(),o=rn();for(let l of t){let d=e.toDocumentKey(l.metadata.name);l.document&&(s=s.add(d));let u=e.toMutableDocument(l);u.setReadTime(e.toSnapshotVersion(l.metadata.readTime)),o=o.insert(d,u)}let a=r.remoteDocuments.newChangeBuffer({trackRemovals:!0}),c=yield Aa(r,Rj(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>vD(l,a,o).next(d=>(a.apply(l),d)).next(d=>r.targetCache.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.targetCache.addMatchingKeys(l,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,d.changedDocuments,d.existenceChangedKeys)).next(()=>d.changedDocuments)))})}function Oj(n,e){let t=V(n),i=st(e.createTime);return t.persistence.runTransaction("hasNewerBundle","readonly",r=>t.bundleCache.getBundleMetadata(r,e.id)).then(r=>!!r&&r.createTime.compareTo(i)>=0)}function Fj(n,e){let t=V(n);return t.persistence.runTransaction("Save bundle","readwrite",i=>t.bundleCache.saveBundleMetadata(i,e))}function Pj(n,e){let t=V(n);return t.persistence.runTransaction("Get named query","readonly",i=>t.bundleCache.getNamedQuery(i,e))}function Lj(i,r){return w(this,arguments,function*(n,e,t=ie()){let s=yield Aa(n,Kt(n0(e.bundledQuery))),o=V(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=st(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.bundleCache.saveNamedQuery(a,e);let l=s.withResumeToken(at.EMPTY_BYTE_STRING,c);return o.targetDataByTarget=o.targetDataByTarget.insert(l.targetId,l),o.targetCache.updateTargetData(a,l).next(()=>o.targetCache.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.targetCache.addMatchingKeys(a,t,s.targetId)).next(()=>o.bundleCache.saveNamedQuery(a,e))})})}var Yv=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Bj=100;function Vj(){return wm()?8:QI(nc())>0?6:4}var sf=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=Bj,this.relativeIndexReadCostPerDocument=Vj()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Yv;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,i,r){return i.documentReadCount<this.indexAutoCreationMinCollectionSize?(la()<=ni.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",da(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),C.resolve()):(la()<=ni.DEBUG&&O("QueryEngine","Query:",da(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.relativeIndexReadCostPerDocument*r?(la()<=ni.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",da(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kt(t))):C.resolve())}performQueryUsingIndex(e,t){if($k(t))return C.resolve(null);let i=Kt(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Gh(t,null,"F"),i=Kt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=ie(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{let l=this.applyQuery(t,a);return this.needsRefill(t,l,o,c.readTime)?this.performQueryUsingIndex(e,Gh(t,null,"F")):this.appendRemainingResults(e,l,t,c)}))})))}performQueryUsingRemoteKeys(e,t,i,r){return $k(t)||r.isEqual(X.min())?C.resolve(null):this.localDocumentsView.getDocuments(e,i).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,i,r)?C.resolve(null):(la()<=ni.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),da(t)),this.appendRemainingResults(e,o,t,$I(r,ya)).next(a=>a))})}applyQuery(e,t){let i=new De(RA(e));return t.forEach((r,s)=>{Fl(e,s)&&(i=i.add(s))}),i}needsRefill(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(r)>0:!1}executeFullCollectionScan(e,t,i){return la()<=ni.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",da(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Dn.min(),i)}appendRemainingResults(e,t,i,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var ED="firestore_clients";function CI(n,e){return`${ED}_${n}_${e}`}var TD="firestore_mutations";function SI(n,e,t){let i=`${TD}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}var CD="firestore_targets";function Oy(n,e){return`${CD}_${n}_${e}`}var zj="firestore_online_state";function qj(n){return`${zj}_${n}`}var Uj="firestore_bundle_loaded_v2";function jj(n){return`${Uj}_${n}`}var Gj="firestore_sequence_number";function Hj(n){return`${Gj}_${n}`}var xi="SharedClientState",of=class n{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static fromWebStorageEntry(e,t,i){let r=JSON.parse(i),s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object"),o;return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(o=new D(r.error.code,r.error.message))),s?new n(e,t,r.state,o):(Qe(xi,`Failed to parse mutation state for ID '${t}': ${i}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},il=class n{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object"),s;return r&&i.error&&(r=typeof i.error.message=="string"&&typeof i.error.code=="string",r&&(s=new D(i.error.code,i.error.message))),r?new n(e,i.state,s):(Qe(xi,`Failed to parse target state for ID '${e}': ${t}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},af=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fromWebStorageEntry(e,t){let i=JSON.parse(t),r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=J_();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=pA(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new n(e,s):(Qe(xi,`Failed to parse client data for instance '${e}': ${t}`),null)}},Xv=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fromWebStorageEntry(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Qe(xi,`Failed to parse online state: ${e}`),null)}},El=class{constructor(){this.activeTargetIds=J_()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},rl=class{constructor(e,t,i,r,s){this.window=e,this.queue=t,this.persistenceKey=i,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new Le(ne),this.started=!1,this.earlyEvents=[];let o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.localClientStorageKey=CI(this.persistenceKey,this.localClientId),this.sequenceNumberKey=Hj(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new El),this.clientStateKeyRe=new RegExp(`^${ED}_${o}_([^_]*)$`),this.mutationBatchKeyRe=new RegExp(`^${TD}_${o}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=new RegExp(`^${CD}_${o}_(\\d+)$`),this.onlineStateKey=qj(this.persistenceKey),this.bundleLoadedKey=jj(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}start(){return w(this,null,function*(){let e=yield this.syncEngine.getActiveClients();for(let i of e){if(i===this.localClientId)continue;let r=this.getItem(CI(this.persistenceKey,i));if(r){let s=af.fromWebStorageEntry(i,r);s&&(this.activeClients=this.activeClients.insert(s.clientId,s))}}this.persistClientState();let t=this.storage.getItem(this.onlineStateKey);if(t){let i=this.fromWebStorageOnlineState(t);i&&this.handleOnlineStateEvent(i)}for(let i of this.earlyEvents)this.handleWebStorageEvent(i);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let t=!1;return this.activeClients.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,t,i){this.persistMutationState(e,t,i),this.removeMutationState(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Oy(this.persistenceKey,e));if(r){let s=il.fromWebStorageEntry(e,r);s&&(i=s.state)}}return t&&this.localClientState.addQueryTarget(e),this.persistClientState(),i}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Oy(this.persistenceKey,e))}updateQueryState(e,t,i){this.persistQueryTargetState(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.removeMutationState(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O(xi,"READ",e,t),t}setItem(e,t){O(xi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){O(xi,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let t=e;if(t.storageArea===this.storage){if(O(xi,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey){Qe("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(()=>w(this,null,function*(){if(!this.started){this.earlyEvents.push(t);return}if(t.key!==null){if(this.clientStateKeyRe.test(t.key))if(t.newValue!=null){let i=this.fromWebStorageClientState(t.key,t.newValue);if(i)return this.handleClientStateEvent(i.clientId,i)}else{let i=this.fromWebStorageClientStateKey(t.key);return this.handleClientStateEvent(i,null)}else if(this.mutationBatchKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageMutationMetadata(t.key,t.newValue);if(i)return this.handleMutationBatchEvent(i)}}else if(this.queryTargetKeyRe.test(t.key)){if(t.newValue!==null){let i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue);if(i)return this.handleQueryTargetEvent(i)}}else if(t.key===this.onlineStateKey){if(t.newValue!==null){let i=this.fromWebStorageOnlineState(t.newValue);if(i)return this.handleOnlineStateEvent(i)}}else if(t.key===this.sequenceNumberKey){let i=$j(t.newValue);i!==mn.INVALID&&this.sequenceNumberHandler(i)}else if(t.key===this.bundleLoadedKey){let i=this.fromWebStoreBundleLoadedState(t.newValue);yield Promise.all(i.map(r=>this.syncEngine.synchronizeWithChangedDocuments(r)))}}}))}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,t,i){let r=new of(this.currentUser,e,t,i),s=SI(this.persistenceKey,this.currentUser,e);this.setItem(s,r.toWebStorageJSON())}removeMutationState(e){let t=SI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}persistOnlineState(e){let t={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))}persistQueryTargetState(e,t,i){let r=Oy(this.persistenceKey,e),s=new il(e,t,i);this.setItem(r,s.toWebStorageJSON())}persistBundleLoadedState(e){let t=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,t)}fromWebStorageClientStateKey(e){let t=this.clientStateKeyRe.exec(e);return t?t[1]:null}fromWebStorageClientState(e,t){let i=this.fromWebStorageClientStateKey(e);return af.fromWebStorageEntry(i,t)}fromWebStorageMutationMetadata(e,t){let i=this.mutationBatchKeyRe.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return of.fromWebStorageEntry(new yt(s),r,t)}fromWebStorageQueryTargetMetadata(e,t){let i=this.queryTargetKeyRe.exec(e),r=Number(i[1]);return il.fromWebStorageEntry(r,t)}fromWebStorageOnlineState(e){return Xv.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}handleMutationBatchEvent(e){return w(this,null,function*(){if(e.user.uid!==this.currentUser.uid){O(xi,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)})}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,t){let i=t?this.activeClients.insert(e,t):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),s=this.extractActiveQueryTargets(i),o=[],a=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.applyActiveTargetsChange(o,a).then(()=>{this.activeClients=i})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let t=J_();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}};function $j(n){let e=mn.INVALID;if(n!=null)try{let t=JSON.parse(n);K(typeof t=="number"),e=t}catch(t){Qe(xi,"Failed to read sequence number from WebStorage",t)}return e}var cf=class{constructor(){this.localState=new El,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,i){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new El,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Zv=class{addCallback(e){}shutdown(){}};var Jv=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var Ih=null;function Wj(){return 268435456+Math.round(2147483648*Math.random())}function Fy(){return Ih===null?Ih=Wj():Ih++,"0x"+Ih.toString(16)}function Kj(n){return new Promise((e,t)=>{n((i,r)=>{i?t(i):e(r)})})}var Qj="1.9.1",$t="GrpcConnection",Yj=`gl-node/${process.versions.node} fire/${Pa} grpc/${Qj}`;function Py(n,e,t,i){K(e===null||e.type==="OAuth");let r=new Ns.Metadata;return e&&e.headers.forEach((s,o)=>r.set(o,s)),t&&t.headers.forEach((s,o)=>r.set(o,s)),i&&r.set("X-Firebase-GMPID",i),r.set("X-Goog-Api-Client",Yj),r.set("Google-Cloud-Resource-Prefix",n),r.set("x-goog-request-params",n),r}var e_=class{constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){O($t,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Ns.credentials.createSsl():Ns.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,i,r,s){let o=Fy(),a=this.ensureActiveStub(),c=Py(this.databasePath,r,s,this.databaseInfo.appId),l=Object.assign({database:this.databasePath},i);return Kj(d=>(O($t,`RPC '${e}' ${o} invoked with request:`,i),a[e](l,c,(u,f)=>{u?(O($t,`RPC '${e}' ${o} failed with error:`,u),d(new D(Nh(u.code),u.message))):(O($t,`RPC '${e}' ${o} completed with response:`,f),d(void 0,f))})))}invokeStreamingRPC(e,t,i,r,s,o){let a=Fy(),c=[],l=new gt;O($t,`RPC '${e}' ${a} invoked (streaming) with request:`,i);let d=this.ensureActiveStub(),u=Py(this.databasePath,r,s,this.databaseInfo.appId),f=Object.assign(Object.assign({},i),{database:this.databasePath}),b=d[e](f,u),E=!1;return b.on("data",T=>{O($t,`RPC ${e} ${a} received result:`,T),c.push(T),o!==void 0&&c.length===o&&(E=!0,l.resolve(c))}),b.on("end",()=>{O($t,`RPC '${e}' ${a} completed.`),E||(E=!0,l.resolve(c))}),b.on("error",T=>{O($t,`RPC '${e}' ${a} failed with error:`,T);let S=Nh(T.code);l.reject(new D(S,T.message))}),l.promise}openStream(e,t,i){let r=Fy(),s=this.ensureActiveStub(),o=Py(this.databasePath,t,i,this.databaseInfo.appId),a=s[e](o),c=!1,l=f=>{c||(c=!0,d.callOnClose(f),a.end())},d=new Jv({sendFn:f=>{if(c)O($t,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,f);else{O($t,`RPC '${e}' stream ${r} sending:`,f);try{a.write(f)}catch(b){throw Qe("Failure sending:",f),Qe("Error:",b),b}}},closeFn:()=>{O($t,`RPC '${e}' stream ${r} closed locally via close().`),l()}}),u=!1;return a.on("data",f=>{c||(O($t,`RPC '${e}' stream ${r} received:`,f),u||(d.callOnConnected(),u=!0),d.callOnMessage(f))}),a.on("end",()=>{O($t,`RPC '${e}' stream ${r} ended.`),l()}),a.on("error",f=>{if(!c){Gn($t,`RPC '${e}' stream ${r} error. Code:`,f.code,"Message:",f.message);let b=Nh(f.code);l(new D(b,f.message))}}),O($t,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{d.callOnOpen()},0),d}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},SD={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},Xj={nested:SD},Zj=Object.freeze({__proto__:null,nested:SD,default:Xj});var Jj={longs:String,enums:String,defaults:!0,oneofs:!1};function e6(){let n=UI.fromJSON(Zj,Jj);return Ns.loadPackageDefinition(n)}function t6(n){let e=e6();return new e_(e,n)}function n6(){return new Zv}function kD(){return process.env.USE_MOCK_PERSISTENCE==="YES"?window:null}function i6(){return null}function Ll(n){return new vv(n,!1)}var r6="ExponentialBackoff",s6=1e3,o6=1.5,a6=60*1e3,Tl=class{constructor(e,t,i=s6,r=o6,s=a6){this.queue=e,this.timerId=t,this.initialDelayMs=i,this.backoffFactor=r,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),i=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,t-i);r>0&&O(r6,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var kI="PersistentStream",c6=60*1e3,l6=10*1e3,lf=class{constructor(e,t,i,r,s,o,a,c){this.queue=e,this.idleTimerId=i,this.healthTimerId=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new Tl(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}stop(){return w(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,c6,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return w(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return w(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===k.RESOURCE_EXHAUSTED?(Qe(t.toString()),Qe("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.closeCount===t&&this.startStream(i,r)},i=>{e(()=>{let r=new D(k.UNKNOWN,"Fetching auth token failed: "+i.message);return this.handleStreamClose(r)})})}startStream(e,t){let i=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{i(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{i(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,l6,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(r=>{i(()=>this.handleStreamClose(r))}),this.stream.onMessage(r=>{i(()=>++this.responseCount===1?this.onFirst(r):this.onNext(r))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>w(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return O(kI,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(O(kI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},t_=class extends lf{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=y3(this.serializer,e),i=_3(e);return this.listener.onWatchChange(t,i)}watch(e){let t={};t.database=wv(this.serializer),t.addTarget=M3(this.serializer,e);let i=A3(this.serializer,e);i&&(t.labels=i),this.sendRequest(t)}unwatch(e){let t={};t.database=wv(this.serializer),t.removeTarget=e,this.sendRequest(t)}},n_=class extends lf{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return K(!!e.streamToken),this.lastStreamToken=e.streamToken,K(!e.writeResults||e.writeResults.length===0),this.listener.onHandshakeComplete()}onNext(e){K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=T3(e.writeResults,e.commitTime),i=st(e.commitTime);return this.listener.onMutationResult(i,t)}writeHandshake(){let e={};e.database=wv(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>vl(this.serializer,i))};this.sendRequest(t)}};var i_=class{},r_=class extends i_{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new D(k.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,i,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,xv(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(k.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,i,r,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,xv(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(k.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function d6(n,e,t,i){return new r_(n,e,t,i)}function u6(n,e){return w(this,null,function*(){let t=V(n),i={writes:e.map(r=>vl(t.serializer,r))};yield t.invokeRPC("Commit",t.serializer.databaseId,fe.emptyPath(),i)})}function h6(n,e){return w(this,null,function*(){let t=V(n),i={documents:e.map(a=>yl(t.serializer,a))},r=yield t.invokeStreamingRPC("BatchGetDocuments",t.serializer.databaseId,fe.emptyPath(),i,e.length),s=new Map;r.forEach(a=>{let c=b3(t.serializer,a);s.set(c.key.toString(),c)});let o=[];return e.forEach(a=>{let c=s.get(a.toString());K(!!c),o.push(c)}),o})}function f6(n,e,t){let i=V(n);return i.verifyInitialized(),new n_(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}function m6(n,e,t){let i=V(n);return i.verifyInitialized(),new t_(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,t)}var p6="OnlineStateTracker",II=1,AI=10*1e3,s_=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",AI,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${AI/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=II&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${II} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(Qe(t),this.shouldWarnClientIsOffline=!1):O(p6,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var js="RemoteStore",g6=10,o_=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{i.enqueueAndForget(()=>w(this,null,function*(){Jr(this)&&(O(js,"Restarting streams for network reachability change."),yield O6(this))}))}),this.onlineStateTracker=new s_(i,r)}};function b6(n,e,t,i,r){return new o_(n,e,t,i,r)}function y6(n){let e=V(n);return e.offlineCauses.delete(0),Bl(e)}function Bl(n){return w(this,null,function*(){if(Jr(n))for(let e of n.onNetworkStatusChange)yield e(!0)})}function v6(n){return w(this,null,function*(){let e=V(n);e.offlineCauses.add(0),yield qa(e),e.onlineStateTracker.set("Offline")})}function qa(n){return w(this,null,function*(){for(let e of n.onNetworkStatusChange)yield e(!1)})}function _6(n){return w(this,null,function*(){let e=V(n);O(js,"RemoteStore shutting down."),e.offlineCauses.add(5),yield qa(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function zf(n,e){let t=V(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),d0(t)?l0(t):Ga(t).isOpen()&&c0(t,e))}function Ua(n,e){let t=V(n),i=Ga(t);t.listenTargets.delete(e),i.isOpen()&&ID(t,e),t.listenTargets.size===0&&(i.isOpen()?i.markIdle():Jr(t)&&t.onlineStateTracker.set("Unknown"))}function c0(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ga(n).watch(e)}function ID(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),Ga(n).unwatch(e)}function l0(n){n.watchChangeAggregator=new yv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),Ga(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function d0(n){return Jr(n)&&!Ga(n).isStarted()&&n.listenTargets.size>0}function Jr(n){return V(n).offlineCauses.size===0}function AD(n){n.watchChangeAggregator=void 0}function x6(n){return w(this,null,function*(){n.onlineStateTracker.set("Online")})}function w6(n){return w(this,null,function*(){n.listenTargets.forEach((e,t)=>{c0(n,e)})})}function E6(n,e){return w(this,null,function*(){AD(n),d0(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),l0(n)):n.onlineStateTracker.set("Unknown")})}function T6(n,e,t){return w(this,null,function*(){if(n.onlineStateTracker.set("Online"),e instanceof $h&&e.state===2&&e.cause){try{yield S6(n,e)}catch(i){O(js,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield df(n,i)}return}if(e instanceof ba?n.watchChangeAggregator.handleDocumentChange(e):e instanceof Hh?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(X.min()))try{let i=yield yD(n.localStore);t.compareTo(i)>=0&&(yield C6(n,t))}catch(i){O(js,"Failed to raise snapshot:",i),yield df(n,i)}})}function df(n,e,t){return w(this,null,function*(){if(Zr(e))n.offlineCauses.add(1),yield qa(n),n.onlineStateTracker.set("Offline"),t||(t=()=>yD(n.localStore)),n.asyncQueue.enqueueRetryable(()=>w(this,null,function*(){O(js,"Retrying IndexedDB access"),yield t(),n.offlineCauses.delete(1),yield Bl(n)}));else throw e})}function DD(n,e){return e().catch(t=>df(n,t,e))}function C6(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((i,r)=>{if(i.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(r);s&&n.listenTargets.set(r,s.withResumeToken(i.resumeToken,e))}}),t.targetMismatches.forEach((i,r)=>{let s=n.listenTargets.get(i);if(!s)return;n.listenTargets.set(i,s.withResumeToken(at.EMPTY_BYTE_STRING,s.snapshotVersion)),ID(n,i);let o=new ka(s.target,i,r,s.sequenceNumber);c0(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}function S6(n,e){return w(this,null,function*(){let t=e.cause;for(let i of e.targetIds)n.listenTargets.has(i)&&(yield n.remoteSyncer.rejectListen(i,t),n.listenTargets.delete(i),n.watchChangeAggregator.removeTarget(i))})}function ja(n){return w(this,null,function*(){let e=V(n),t=es(e),i=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:Vr;for(;k6(e);)try{let r=yield Cj(e.localStore,i);if(r===null){e.writePipeline.length===0&&t.markIdle();break}else i=r.batchId,I6(e,r)}catch(r){yield df(e,r)}MD(e)&&RD(e)})}function k6(n){return Jr(n)&&n.writePipeline.length<g6}function I6(n,e){n.writePipeline.push(e);let t=es(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function MD(n){return Jr(n)&&!es(n).isStarted()&&n.writePipeline.length>0}function RD(n){es(n).start()}function A6(n){return w(this,null,function*(){es(n).writeHandshake()})}function D6(n){return w(this,null,function*(){let e=es(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)})}function M6(n,e,t){return w(this,null,function*(){let i=n.writePipeline.shift(),r=mv.from(i,e,t);yield DD(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield ja(n)})}function R6(n,e){return w(this,null,function*(){e&&es(n).handshakeComplete&&(yield N6(n,e)),MD(n)&&RD(n)})}function N6(n,e){return w(this,null,function*(){if(e3(e.code)){let t=n.writePipeline.shift();es(n).inhibitBackoff(),yield DD(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield ja(n)}})}function O6(n){return w(this,null,function*(){let e=V(n);e.offlineCauses.add(4),yield qa(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield Bl(e)})}function DI(n,e){return w(this,null,function*(){let t=V(n);t.asyncQueue.verifyOperationInProgress(),O(js,"RemoteStore received new credentials");let i=Jr(t);t.offlineCauses.add(3),yield qa(t),i&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield Bl(t)})}function a_(n,e){return w(this,null,function*(){let t=V(n);e?(t.offlineCauses.delete(2),yield Bl(t)):e||(t.offlineCauses.add(2),yield qa(t),t.onlineStateTracker.set("Unknown"))})}function Ga(n){return n.watchStream||(n.watchStream=m6(n.datastore,n.asyncQueue,{onConnected:x6.bind(null,n),onOpen:w6.bind(null,n),onClose:E6.bind(null,n),onWatchChange:T6.bind(null,n)}),n.onNetworkStatusChange.push(e=>w(this,null,function*(){e?(n.watchStream.inhibitBackoff(),d0(n)?l0(n):n.onlineStateTracker.set("Unknown")):(yield n.watchStream.stop(),AD(n))}))),n.watchStream}function es(n){return n.writeStream||(n.writeStream=f6(n.datastore,n.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:A6.bind(null,n),onClose:R6.bind(null,n),onHandshakeComplete:D6.bind(null,n),onMutationResult:M6.bind(null,n)}),n.onNetworkStatusChange.push(e=>w(this,null,function*(){e?(n.writeStream.inhibitBackoff(),yield ja(n)):(yield n.writeStream.stop(),n.writePipeline.length>0&&(O(js,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))}))),n.writeStream}var F6="AsyncQueue",c_=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new gt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,a=new n(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ha(n,e){if(Qe(F6,`${e}: ${n}`),Zr(n))return new D(k.UNAVAILABLE,`${e}: ${n}`);throw n}var uf=class n{constructor(e){e?this.comparator=(t,i)=>e(t,i)||B.comparator(t.key,i.key):this.comparator=(t,i)=>B.comparator(t.key,i.key),this.keyedMap=Xc(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var hf=class{constructor(){this.changeMap=new Le(B.comparator)}track(e){let t=e.doc.key,i=this.changeMap.get(t);if(!i){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&i.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&i.type!==1?this.changeMap=this.changeMap.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&i.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):U()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,i)=>{e.push(i)}),e}},Ma=class n{constructor(e,t,i,r,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,uf.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!Ol(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var l_=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function P6(){return new d_}var d_=class{constructor(){this.queries=ND(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){U6(this,new D(k.ABORTED,"Firestore shutting down"))}};function ND(){return new ki(n=>DA(n),Ol)}function u0(n,e){return w(this,null,function*(){let t=V(n),i=3,r=e.query,s=t.queries.get(r);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2):(s=new l_,i=e.listensToRemoteStore()?0:1);try{switch(i){case 0:s.viewSnap=yield t.onListen(r,!0);break;case 1:s.viewSnap=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r);break;default:break}}catch(o){let a=Ha(o,`Initialization of query '${da(e.query)}' failed`);e.onError(a);return}t.queries.set(r,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&f0(t)})}function h0(n,e){return w(this,null,function*(){let t=V(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?r=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function L6(n,e){let t=V(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(r)&&(i=!0);o.viewSnap=r}}i&&f0(t)}function B6(n,e,t){let i=V(n),r=i.queries.get(e);if(r)for(let s of r.listeners)s.onError(t);i.queries.delete(e)}function V6(n,e){let t=V(n);t.onlineState=e;let i=!1;t.queries.forEach((r,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(i=!0)}),i&&f0(t)}function z6(n,e){V(n).snapshotsInSyncListeners.add(e),e.next()}function q6(n,e){V(n).snapshotsInSyncListeners.delete(e)}function U6(n,e){let t=V(n),i=t.queries;t.queries=ND(),i.forEach((r,s)=>{for(let o of s.listeners)o.onError(e)})}function f0(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var OD=function(n){return n.Default="default",n.Cache="cache",n}(OD||{}),Cl=class{constructor(e,t,i){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=i||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ma(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let i=t!=="Offline";return this.options.waitForSyncWhenOnline&&i?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Ma.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==OD.Cache}};var u_=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.addedKeys=i,this.removedKeys=r}static fromSnapshot(e,t){let i=ie(),r=ie();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key);break}return new n(e,t.fromCache,i,r)}};var ff=class{constructor(e){this.serializer=e}toDocumentKey(e){return Ti(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?JA(this.serializer,e.document,!1):bt.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return st(e)}},h_=class{constructor(e,t,i){this.bundleMetadata=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=FD(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;let i=fe.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let t=new Map,i=new ff(this.serializer);for(let r of e)if(r.metadata.queries){let s=i.toDocumentKey(r.metadata.name);for(let o of r.metadata.queries){let a=(t.get(o)||ie()).add(s);t.set(o,a)}}return t}complete(){return w(this,null,function*(){let e=yield Nj(this.localStore,new ff(this.serializer),this.documents,this.bundleMetadata.id),t=this.getQueryDocumentMapping(this.documents);for(let i of this.queries)yield Lj(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}})}};function FD(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}function j6(n){return{taskState:"Success",documentsLoaded:n.totalDocuments,bytesLoaded:n.totalBytes,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var mf=class{constructor(e){this.key=e}},pf=class{constructor(e){this.key=e}},gf=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=ie(),this.mutatedKeys=ie(),this.docComparator=RA(e),this.documentSet=new uf(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let i=t?t.changeSet:new hf,r=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,u)=>{let f=r.get(d),b=Fl(this.query,u)?u:null,E=f?this.mutatedKeys.has(f.key):!1,T=b?b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations:!1,S=!1;f&&b?f.data.isEqual(b.data)?E!==T&&(i.track({type:3,doc:b}),S=!0):this.shouldWaitForSyncedDocument(f,b)||(i.track({type:2,doc:b}),S=!0,(c&&this.docComparator(b,c)>0||l&&this.docComparator(b,l)<0)&&(a=!0)):!f&&b?(i.track({type:0,doc:b}),S=!0):f&&!b&&(i.track({type:1,doc:f}),S=!0,(c||l)&&(a=!0)),S&&(b?(o=o.add(b),T?s=s.add(d):s=s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{documentSet:o,changeSet:i,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((u,f)=>G6(u.type,f.type)||this.docComparator(u.doc,f.doc)),this.applyTargetChange(i),r=r??!1;let a=t&&!r?this.updateLimboDocuments():[],l=this.limboDocuments.size===0&&this.current&&!r?1:0,d=l!==this.syncState;return this.syncState=l,o.length===0&&!d?{limboChanges:a}:{snapshot:new Ma(this.query,e.documentSet,s,o,e.mutatedKeys,l===0,d,!1,i?i.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new hf,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=ie(),this.documentSet.forEach(i=>{this.shouldBeInLimbo(i.key)&&(this.limboDocuments=this.limboDocuments.add(i.key))});let t=[];return e.forEach(i=>{this.limboDocuments.has(i)||t.push(new pf(i))}),this.limboDocuments.forEach(i=>{e.has(i)||t.push(new mf(i))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=ie();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Ma.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function G6(n,e){let t=i=>{switch(i){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return U()}};return t(n)-t(e)}var ts="SyncEngine",f_=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},m_=class{constructor(e){this.key=e,this.receivedDocument=!1}},p_=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new ki(a=>DA(a),Ol),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Le(B.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new xl,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Ia.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function H6(n,e,t,i,r,s,o){let a=new p_(n,e,t,i,r,s);return o&&(a._isPrimaryClient=!0),a}function $6(n,e,t=!0){return w(this,null,function*(){let i=qf(n),r,s=i.queryViewsByQuery.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.computeInitialSnapshot()):r=yield PD(i,e,t,!0),r})}function W6(n,e){return w(this,null,function*(){let t=qf(n);yield PD(t,e,!0,!1)})}function PD(n,e,t,i){return w(this,null,function*(){let r=yield Aa(n.localStore,Kt(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return i&&(a=yield m0(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&zf(n.remoteStore,r),a})}function m0(n,e,t,i,r){return w(this,null,function*(){n.applyDocChanges=(u,f,b)=>r5(n,u,f,b);let s=yield Vf(n.localStore,e,!0),o=new gf(e,s.remoteKeys),a=o.computeDocChanges(s.documents),c=bl.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),l=o.applyChanges(a,n.isPrimaryClient,c);b0(n,t,l.limboChanges);let d=new f_(e,t,o);return n.queryViewsByQuery.set(e,d),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),l.snapshot})}function K6(n,e,t){return w(this,null,function*(){let i=V(n),r=i.queryViewsByQuery.get(e),s=i.queriesByTarget.get(r.targetId);if(s.length>1){i.queriesByTarget.set(r.targetId,s.filter(o=>!Ol(o,e))),i.queryViewsByQuery.delete(e);return}i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Da(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Ua(i.remoteStore,r.targetId),Ra(i,r.targetId)}).catch(Xr))):(Ra(i,r.targetId),yield Da(i.localStore,r.targetId,!0))})}function Q6(n,e){return w(this,null,function*(){let t=V(n),i=t.queryViewsByQuery.get(e),r=t.queriesByTarget.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ua(t.remoteStore,i.targetId))})}function Y6(n,e,t){return w(this,null,function*(){let i=v0(n);try{let r=yield bj(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),n5(i,r.batchId,t),yield $i(i,r.changes),yield ja(i.remoteStore)}catch(r){let s=Ha(r,"Failed to persist write");t.reject(s)}})}function LD(n,e){return w(this,null,function*(){let t=V(n);try{let i=yield wj(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(K(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.receivedDocument=!0:r.modifiedDocuments.size>0?K(o.receivedDocument):r.removedDocuments.size>0&&(K(o.receivedDocument),o.receivedDocument=!1))}),yield $i(t,i,e)}catch(i){yield Xr(i)}})}function MI(n,e,t){let i=V(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&r.push(a.snapshot)}),V6(i.eventManager,e),r.length&&i.syncEngineListener.onWatchChange(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function X6(n,e,t){return w(this,null,function*(){let i=V(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.activeLimboResolutionsByTarget.get(e),s=r&&r.key;if(s){let o=new Le(B.comparator);o=o.insert(s,bt.newNoDocument(s,X.min()));let a=ie().add(s),c=new gl(X.min(),new Map,new Le(ne),o,a);yield LD(i,c),i.activeLimboTargetsByKey=i.activeLimboTargetsByKey.remove(s),i.activeLimboResolutionsByTarget.delete(e),y0(i)}else yield Da(i.localStore,e,!1).then(()=>Ra(i,e,t)).catch(Xr)})}function Z6(n,e){return w(this,null,function*(){let t=V(n),i=e.batch.batchId;try{let r=yield yj(t.localStore,e);g0(t,i,null),p0(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield $i(t,r)}catch(r){yield Xr(r)}})}function J6(n,e,t){return w(this,null,function*(){let i=V(n);try{let r=yield _j(i.localStore,e);g0(i,e,t),p0(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield $i(i,r)}catch(r){yield Xr(r)}})}function e5(n,e){return w(this,null,function*(){let t=V(n);Jr(t.remoteStore)||O(ts,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield xj(t.localStore);if(i===Vr){e.resolve();return}let r=t.pendingWritesCallbacks.get(i)||[];r.push(e),t.pendingWritesCallbacks.set(i,r)}catch(i){let r=Ha(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function p0(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function t5(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(i=>{i.reject(new D(k.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function n5(n,e,t){let i=n.mutationUserCallbacks[n.currentUser.toKey()];i||(i=new Le(ne)),i=i.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=i}function g0(n,e,t){let i=V(n),r=i.mutationUserCallbacks[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.mutationUserCallbacks[i.currentUser.toKey()]=r}}function Ra(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(i),t&&n.syncEngineListener.onWatchError(i,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(r=>{n.limboDocumentRefs.containsKey(r)||BD(n,r)})}function BD(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(Ua(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),y0(n))}function b0(n,e,t){for(let i of t)i instanceof mf?(n.limboDocumentRefs.addReference(i.key,e),i5(n,i)):i instanceof pf?(O(ts,"Document no longer in limbo: "+i.key),n.limboDocumentRefs.removeReference(i.key,e),n.limboDocumentRefs.containsKey(i.key)||BD(n,i.key)):U()}function i5(n,e){let t=e.key,i=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(i)&&(O(ts,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(i),y0(n))}function y0(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new B(fe.fromString(e)),i=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(i,new m_(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,i),zf(n.remoteStore,new ka(Kt(za(t.path)),i,"TargetPurposeLimboResolution",mn.INVALID))}}function $i(n,e,t){return w(this,null,function*(){let i=V(n),r=[],s=[],o=[];i.queryViewsByQuery.isEmpty()||(i.queryViewsByQuery.forEach((a,c)=>{o.push(i.applyDocChanges(c,e,t).then(l=>{var d;if((l||t)&&i.isPrimaryClient){let u=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;i.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(l){r.push(l);let u=u_.fromSnapshot(c.targetId,l);s.push(u)}}))}),yield Promise.all(o),i.syncEngineListener.onWatchChange(r),yield Tj(i.localStore,s))})}function r5(n,e,t,i){return w(this,null,function*(){let r=e.view.computeDocChanges(t);r.needsRefill&&(r=yield Vf(n.localStore,e.query,!1).then(({documents:c})=>e.view.computeDocChanges(c,r)));let s=i&&i.targetChanges.get(e.targetId),o=i&&i.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(r,n.isPrimaryClient,s,o);return b0(n,e.targetId,a.limboChanges),a.snapshot})}function s5(n,e){return w(this,null,function*(){let t=V(n);if(!t.currentUser.isEqual(e)){O(ts,"User change. New user:",e.toKey());let r=yield bD(t.localStore,e);t.currentUser=e,t5(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield $i(t,r.affectedDocuments)}})}function o5(n,e){let t=V(n),i=t.activeLimboResolutionsByTarget.get(e);if(i&&i.receivedDocument)return ie().add(i.key);{let r=ie(),s=t.queriesByTarget.get(e);if(!s)return r;for(let o of s){let a=t.queryViewsByQuery.get(o);r=r.unionWith(a.view.syncedDocuments)}return r}}function a5(n,e){return w(this,null,function*(){let t=V(n),i=yield Vf(t.localStore,e.query,!0),r=e.view.synchronizeWithPersistedState(i);return t.isPrimaryClient&&b0(t,e.targetId,r.limboChanges),r})}function c5(n,e){return w(this,null,function*(){let t=V(n);return xD(t.localStore,e).then(i=>$i(t,i))})}function l5(n,e,t,i){return w(this,null,function*(){let r=V(n),s=yield Aj(r.localStore,e);if(s===null){O(ts,"Cannot apply mutation batch with id: "+e);return}t==="pending"?yield ja(r.remoteStore):t==="acknowledged"||t==="rejected"?(g0(r,e,i||null),p0(r,e),Dj(r.localStore,e)):U(),yield $i(r,s)})}function d5(n,e){return w(this,null,function*(){let t=V(n);if(qf(t),v0(t),e===!0&&t._isPrimaryClient!==!0){let i=t.sharedClientState.getAllActiveQueryTargets(),r=yield RI(t,i.toArray());t._isPrimaryClient=!0,yield a_(t.remoteStore,!0);for(let s of r)zf(t.remoteStore,s)}else if(e===!1&&t._isPrimaryClient!==!1){let i=[],r=Promise.resolve();t.queriesByTarget.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(Ra(t,o),Da(t.localStore,o,!0))),Ua(t.remoteStore,o)}),yield r,yield RI(t,i),u5(t),t._isPrimaryClient=!1,yield a_(t.remoteStore,!1)}})}function u5(n){let e=V(n);e.activeLimboResolutionsByTarget.forEach((t,i)=>{Ua(e.remoteStore,i)}),e.limboDocumentRefs.removeAllReferences(),e.activeLimboResolutionsByTarget=new Map,e.activeLimboTargetsByKey=new Le(B.comparator)}function RI(n,e,t){return w(this,null,function*(){let i=V(n),r=[],s=[];for(let o of e){let a,c=i.queriesByTarget.get(o);if(c&&c.length!==0){a=yield Aa(i.localStore,Kt(c[0]));for(let l of c){let d=i.queryViewsByQuery.get(l),u=yield a5(i,d);u.snapshot&&s.push(u.snapshot)}}else{let l=yield _D(i.localStore,o);a=yield Aa(i.localStore,l),yield m0(i,VD(l),o,!1,a.resumeToken)}r.push(a)}return i.syncEngineListener.onWatchChange(s),r})}function VD(n){return AA(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function h5(n){let e=V(n);return Mj(e.localStore)}function f5(n,e,t,i){return w(this,null,function*(){let r=V(n);if(r._isPrimaryClient){O(ts,"Ignoring unexpected query state notification.");return}let s=r.queriesByTarget.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield xD(r.localStore,MA(s[0])),a=gl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",at.EMPTY_BYTE_STRING);yield $i(r,o,a);break}case"rejected":{yield Da(r.localStore,e,!0),Ra(r,e,i);break}default:U()}})}function m5(n,e,t){return w(this,null,function*(){let i=qf(n);if(i._isPrimaryClient){for(let r of e){if(i.queriesByTarget.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){O(ts,"Adding an already active target "+r);continue}let o=yield _D(i.localStore,r),a=yield Aa(i.localStore,o);yield m0(i,VD(o),a.targetId,!1,a.resumeToken),zf(i.remoteStore,a)}for(let r of t)i.queriesByTarget.has(r)&&(yield Da(i.localStore,r,!1).then(()=>{Ua(i.remoteStore,r),Ra(i,r)}).catch(Xr))}})}function qf(n){let e=V(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=LD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=o5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X6.bind(null,e),e.syncEngineListener.onWatchChange=L6.bind(null,e.eventManager),e.syncEngineListener.onWatchError=B6.bind(null,e.eventManager),e}function v0(n){let e=V(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=J6.bind(null,e),e}function p5(n,e,t){let i=V(n);g5(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}function g5(n,e,t){return w(this,null,function*(){try{let i=yield e.getMetadata();if(yield Oj(n.localStore,i))return yield e.close(),t._completeWith(j6(i)),Promise.resolve(new Set);t._updateProgress(FD(i));let s=new h_(i,n.localStore,e.serializer),o=yield e.nextElement();for(;o;){let c=yield s.addSizedElement(o);c&&t._updateProgress(c),o=yield e.nextElement()}let a=yield s.complete();return yield $i(n,a.changedDocs,void 0),yield Fj(n.localStore,i),t._completeWith(a.progress),Promise.resolve(a.changedCollectionGroups)}catch(i){return Gn(ts,`Loading bundle failed with ${i}`),t._failWith(i),Promise.resolve(new Set)}})}var g_=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return w(this,null,function*(){this.serializer=Ll(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,i){return null}createIndexBackfillerScheduler(t,i){return null}createLocalStore(t){return gD(this.persistence,new sf,t.initialUser,this.serializer)}createPersistence(t){return new nf(rf.factory,this.serializer)}createSharedClientState(t){return new cf}terminate(){return w(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var bf=class n extends g_{constructor(e,t,i){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return w(this,null,function*(){yield am(n.prototype,this,"initialize").call(this,e),yield this.onlineComponentProvider.initialize(this,e),yield v0(this.onlineComponentProvider.syncEngine),yield ja(this.onlineComponentProvider.remoteStore),yield this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return gD(this.persistence,new sf,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let i=this.persistence.referenceDelegate.garbageCollector;return new Ov(i,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let i=new Qy(t,this.persistence);return new Ky(e.asyncQueue,i)}createPersistence(e){let t=o0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?An.withCacheSize(this.cacheSizeBytes):An.DEFAULT;return new Qv(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,kD(),i6(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new cf}},b_=class n extends bf{constructor(e,t){super(e,t,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return w(this,null,function*(){yield am(n.prototype,this,"initialize").call(this,e);let t=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof rl&&(this.sharedClientState.syncEngine={applyBatchState:l5.bind(null,t),applyTargetState:f5.bind(null,t),applyActiveTargetsChange:m5.bind(null,t),getActiveClients:h5.bind(null,t),synchronizeWithChangedDocuments:c5.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.setPrimaryStateListener(i=>w(this,null,function*(){yield d5(this.onlineComponentProvider.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=kD();if(!rl.isAvailable(t))throw new D(k.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=o0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rl(t,e.asyncQueue,i,e.clientId,e.initialUser)}},_0=(()=>{class n{initialize(t,i){return w(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>MI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=s5.bind(null,this.syncEngine),yield a_(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return P6()}createDatastore(t){let i=Ll(t.databaseInfo.databaseId),r=t6(t.databaseInfo);return d6(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return b6(this.localStore,this.datastore,t.asyncQueue,i=>MI(this.syncEngine,i,0),n6())}createSyncEngine(t,i){return H6(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return w(this,null,function*(){var t,i;yield _6(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}n.provider={build:()=>new n};return n})(),b5=10240;function y5(n,e=b5){let t=0;return{read(){return w(this,null,function*(){if(t<n.byteLength){let s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})},cancel(){return w(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}function x0(n,e,t){if(!t)throw new D(k.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function w0(n,e,t,i){if(e===!0&&i===!0)throw new D(k.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NI(n){if(!B.isDocumentKey(n))throw new D(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function OI(n){if(B.isDocumentKey(n))throw new D(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function v5(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=_5(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":U()}function _5(n){return n.constructor?n.constructor.name:null}function be(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vl(n);throw new D(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function zD(n,e){if(e<=0)throw new D(k.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function x5(n,e){if(!(n instanceof Uint8Array))throw new D(k.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${Vl(n)}`);return y5(n,e)}var Na=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):Qe("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var y_=class{constructor(e,t){this.payload=e,this.byteLength=t}isBundleMetadata(){return"metadata"in this.payload}};var v_=class{constructor(e,t){this.reader=e,this.serializer=t,this.metadata=new gt,this.buffer=new Uint8Array,this.textDecoder=t3(),this.nextElementImpl().then(i=>{i&&i.isBundleMetadata()?this.metadata.resolve(i.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.payload)}`))},i=>this.metadata.reject(i))}close(){return this.reader.cancel()}getMetadata(){return w(this,null,function*(){return this.metadata.promise})}nextElement(){return w(this,null,function*(){return yield this.getMetadata(),this.nextElementImpl()})}nextElementImpl(){return w(this,null,function*(){let e=yield this.readLength();if(e===null)return null;let t=this.textDecoder.decode(e),i=Number(t);isNaN(i)&&this.raiseError(`length string (${t}) is not valid number`);let r=yield this.readJsonString(i);return new y_(JSON.parse(r),e.length+i)})}indexOfOpenBracket(){return this.buffer.findIndex(e=>e===123)}readLength(){return w(this,null,function*(){for(;this.indexOfOpenBracket()<0&&!(yield this.pullMoreDataToBuffer()););if(this.buffer.length===0)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}readJsonString(e){return w(this,null,function*(){for(;this.buffer.length<e;)(yield this.pullMoreDataToBuffer())&&this.raiseError("Reached the end of bundle when more is expected.");let t=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}raiseError(e){throw this.reader.cancel(),new Error(`Invalid bundle format: ${e}`)}pullMoreDataToBuffer(){return w(this,null,function*(){let e=yield this.reader.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};function w5(n,e){return new v_(n,e)}var __=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return w(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new D(k.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield h6(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Kr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return w(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{let r=B.fromPath(i);this.mutations.push(new fl(r,this.precondition(r)))}),yield u6(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=X.min();else throw U();let i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new D(k.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?et.exists(!1):et.updateTime(t):et.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new D(k.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return et.updateTime(t)}else return et.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var x_=class{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.attemptsRemaining=i.maxAttempts,this.backoff=new Tl(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(()=>w(this,null,function*(){let e=new __(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.handleTransactionError(r)}))}).catch(i=>{this.handleTransactionError(i)})}))}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);return Rl(t)||!t.catch||!t.then?(this.deferred.reject(Error("Transaction callback must return a Promise")),null):t}catch(t){return this.deferred.reject(t),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!$A(t)}return!1}};var Qr="FirestoreClient",E5=100,T5=11,C5=20,S5=22,w_=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=yt.UNAUTHENTICATED,this.clientId=Fh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>w(this,null,function*(){O(Qr,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(O(Qr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:E5}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new gt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Ha(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Ly(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O(Qr,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>w(this,null,function*(){i.isEqual(r)||(yield bD(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function FI(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield E0(n);O(Qr,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>DI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>DI(e.remoteStore,r)),n._onlineComponents=e})}function k5(n){return n.name==="FirebaseError"?n.code===k.FAILED_PRECONDITION||n.code===k.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===S5||n.code===C5||n.code===T5:!0}function E0(n){return w(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(Qr,"Using user provided OfflineComponentProvider");try{yield Ly(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!k5(t))throw t;Gn("Error using user provided cache. Falling back to memory cache: "+t),yield Ly(n,new g_)}}else O(Qr,"Using default OfflineComponentProvider"),yield Ly(n,new g_);return n._offlineComponents})}function Uf(n){return w(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(Qr,"Using user provided OnlineComponentProvider"),yield FI(n,n._uninitializedComponentsProvider._online)):(O(Qr,"Using default OnlineComponentProvider"),yield FI(n,new _0))),n._onlineComponents})}function qD(n){return E0(n).then(e=>e.persistence)}function T0(n){return E0(n).then(e=>e.localStore)}function UD(n){return Uf(n).then(e=>e.remoteStore)}function C0(n){return Uf(n).then(e=>e.syncEngine)}function I5(n){return Uf(n).then(e=>e.datastore)}function Oa(n){return w(this,null,function*(){let e=yield Uf(n),t=e.eventManager;return t.onListen=$6.bind(null,e.syncEngine),t.onUnlisten=K6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=W6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Q6.bind(null,e.syncEngine),t})}function A5(n){return n.asyncQueue.enqueue(()=>w(this,null,function*(){let e=yield qD(n),t=yield UD(n);return e.setNetworkEnabled(!0),y6(t)}))}function D5(n){return n.asyncQueue.enqueue(()=>w(this,null,function*(){let e=yield qD(n),t=yield UD(n);return e.setNetworkEnabled(!1),v6(t)}))}function M5(n){let e=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let t=yield C0(n);return e5(t,e)})),e.promise}function R5(n,e,t,i){let r=new Na(i),s=new Cl(e,r,t);return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let o=yield Oa(n);return u0(o,s)})),()=>{r.mute(),n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let o=yield Oa(n);return h0(o,s)}))}}function N5(n,e){let t=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let i=yield T0(n);return B5(i,e,t)})),t.promise}function jD(n,e,t={}){let i=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let r=yield Oa(n);return V5(r,n.asyncQueue,e,t,i)})),i.promise}function O5(n,e){let t=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let i=yield T0(n);return z5(i,e,t)})),t.promise}function GD(n,e,t={}){let i=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let r=yield Oa(n);return q5(r,n.asyncQueue,e,t,i)})),i.promise}function F5(n,e){let t=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let i=yield C0(n);return Y6(i,e,t)})),t.promise}function P5(n,e){let t=new Na(e);return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let i=yield Oa(n);return z6(i,t)})),()=>{t.mute(),n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let i=yield Oa(n);return q6(i,t)}))}}function L5(n,e,t){let i=new gt;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let r=yield I5(n);new x_(n.asyncQueue,r,t,e,i).run()})),i.promise}function B5(n,e,t){return w(this,null,function*(){try{let i=yield Sj(n,e);i.isFoundDocument()?t.resolve(i):i.isNoDocument()?t.resolve(null):t.reject(new D(k.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){let r=Ha(i,`Failed to get document '${e} from cache`);t.reject(r)}})}function V5(n,e,t,i,r){let s=new Na({next:a=>{s.mute(),e.enqueueAndForget(()=>h0(n,o));let c=a.docs.has(t);!c&&a.fromCache?r.reject(new D(k.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&i&&i.source==="server"?r.reject(new D(k.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new Cl(za(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return u0(n,o)}function z5(n,e,t){return w(this,null,function*(){try{let i=yield Vf(n,e,!0),r=new gf(e,i.remoteKeys),s=r.computeDocChanges(i.documents),o=r.applyChanges(s,!1);t.resolve(o.snapshot)}catch(i){let r=Ha(i,`Failed to execute query '${e} against cache`);t.reject(r)}})}function q5(n,e,t,i,r){let s=new Na({next:a=>{s.mute(),e.enqueueAndForget(()=>h0(n,o)),a.fromCache&&i.source==="server"?r.reject(new D(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(a)},error:a=>r.reject(a)}),o=new Cl(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return u0(n,o)}function U5(n,e,t,i){let r=G5(t,Ll(e));n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){p5(yield C0(n),r,i)}))}function j5(n,e){return n.asyncQueue.enqueue(()=>w(this,null,function*(){return Pj(yield T0(n),e)}))}function G5(n,e){let t;return typeof n=="string"?t=WA().encode(n):t=n,w5(x5(t),e)}function H5(n,e){return n.timeoutSeconds===e.timeoutSeconds}function HD(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var $5="ComponentProvider",PI=new Map;function W5(n){let e=PI.get(n);e&&(O($5,"Removing Datastore"),PI.delete(n),e.terminate())}function K5(n,e,t,i){return new tv(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,HD(i.experimentalLongPollingOptions),i.useFetchStreams)}var $D="firestore.googleapis.com",LI=!0,BI=5,VI=30,Q5=!0,yf=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new D(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$D,this.ssl=LI}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:LI;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=fD;else{if(e.cacheSizeBytes!==Pl&&e.cacheSizeBytes<vI)throw new D(k.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${vI}`);this.cacheSizeBytes=e.cacheSizeBytes}w0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=Q5:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HD((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),Y5(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&H5(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function Y5(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<BI)throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${BI})`);if(n.timeoutSeconds>VI)throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${VI})`)}}var Gs=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yf({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yf(e),e.credentials!==void 0&&(this._authCredentials=Vz(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return w(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return W5(this),Promise.resolve()}};function WD(n,e,t,i={}){var r;n=be(n,Gs);let s=n._getSettings(),o=`${e}:${t}`;if(s.host!==$D&&s.host!==o&&Gn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=yt.MOCK_USER;else{a=Ax(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new D(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new yt(l)}n._authCredentials=new Vy(new Oh(a,c))}}var At=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Fe=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ci=class n extends At{constructor(e,t,i){super(e,t,za(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function S0(n,e,...t){if(n=Ke(n),x0("collection","path",e),n instanceof Gs){let i=fe.fromString(e,...t);return OI(i),new Ci(n,null,i)}else{if(!(n instanceof Fe)&&!(n instanceof Ci))throw new D(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(fe.fromString(e,...t));return OI(i),new Ci(n.firestore,null,i)}}function KD(n,e){if(n=be(n,Gs),x0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(k.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(n,null,Eq(e))}function zl(n,e,...t){if(n=Ke(n),arguments.length===1&&(e=Fh.newId()),x0("doc","path",e),n instanceof Gs){let i=fe.fromString(e,...t);return NI(i),new Fe(n,null,new B(i))}else{if(!(n instanceof Fe)&&!(n instanceof Ci))throw new D(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(fe.fromString(e,...t));return NI(i),new Fe(n.firestore,n instanceof Ci?n.converter:null,new B(i))}}function k0(n,e){return n=Ke(n),e=Ke(e),(n instanceof Fe||n instanceof Ci)&&(e instanceof Fe||e instanceof Ci)?n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter:!1}function I0(n,e){return n=Ke(n),e=Ke(e),n instanceof At&&e instanceof At?n.firestore===e.firestore&&Ol(n._query,e._query)&&n.converter===e.converter:!1}var X5="AsyncQueue",vf=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Tl(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new gt;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return w(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Zr(e))O(X5,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(i=>{this.failure=i,this.operationInProgress=!1;let r=Z5(i);throw Qe("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.operationInProgress=!1,i))));return this.tail=t,t}enqueueAfterDelay(e,t,i){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let r=c_.createAndSchedule(this,e,t,i,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&U()}verifyOperationInProgress(){}drain(){return w(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function Z5(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var E_=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new gt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var QD=Pl,Xe=class extends Gs{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new vf,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return w(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new vf(e),this._firestoreClient=void 0,yield e}})}};function Dt(n){if(n._terminated)throw new D(k.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||YD(n),n._firestoreClient}function YD(n){var e,t,i;let r=n._freezeSettings(),s=K5(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new w_(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&J5(n._componentsProvider))}function J5(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function XD(n,e){Gn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return JD(n,_0.provider,{build:i=>new bf(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function ZD(n){return w(this,null,function*(){Gn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();JD(n,_0.provider,{build:t=>new b_(t,e.cacheSizeBytes)})})}function JD(n,e,t){if(n=be(n,Xe),n._firestoreClient||n._terminated)throw new D(k.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new D(k.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},YD(n)}function e1(n){if(n._initialized&&!n._terminated)throw new D(k.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new gt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{yield mj(o0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function t1(n){n=be(n,Xe);let e=Dt(n);return M5(e)}function n1(n){n=be(n,Xe);let e=Dt(n);return A5(e)}function i1(n){n=be(n,Xe);let e=Dt(n);return D5(e)}function r1(n,e){n=be(n,Xe);let t=Dt(n),i=new E_;return U5(t,n._databaseId,e,i),i}function s1(n,e){n=be(n,Xe);let t=Dt(n);return j5(t,e).then(i=>i?new At(n,null,i.query):null)}function e9(n,e=!0){Lz(Rx),ic(new as("firestore",(t,{instanceIdentifier:i,options:r})=>{let s=t.getProvider("app").getImmediate(),o=new Xe(new zy(t.getProvider("auth-internal")),new Gy(t.getProvider("app-check-internal")),P4(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),er(Mk,Rk,n),er(Mk,Rk,"esm2017")}var Ii=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(at.fromBase64String(e))}catch(t){throw new D(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Kn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ji=class{constructor(e){this._methodName=e}};var Hs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}};var Sl=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return pj(this._values,e._values)}};var t9=/^__.*__$/,T_=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Wn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wr(e,this.data,t,this.fieldTransforms)}},_f=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Wn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function o1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var xf=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return wf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(o1(this.dataSource)&&t9.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},C_=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Ll(e)}createContext(e,t,i,r=!1){return new xf({dataSource:e,methodName:t,targetDoc:i,path:ot.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ys(n){let e=n._freezeSettings(),t=Ll(n._databaseId);return new C_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jf(n,e,t,i,r,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,r);M0("Data must be an object, but it was:",o,i);let a=l1(i,o),c,l;if(s.merge)c=new pn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let u of s.mergeFields){let f=D_(e,u,t);if(!o.contains(f))throw new D(k.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);u1(d,f)||d.push(f)}c=new pn(d),l=o.fieldTransforms.filter(u=>c.covers(u.field))}else c=null,l=o.fieldTransforms;return new T_(new Lt(a),c,l)}var kl=class n extends ji{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof n}};function a1(n,e,t){return new xf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var S_=class n extends ji{_toFieldTransform(e){return new zs(e.path,new Hr)}isEqual(e){return e instanceof n}},k_=class n extends ji{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=a1(this,e,!0),i=this._elements.map(s=>Xs(s,t)),r=new qi(i);return new zs(e.path,r)}isEqual(e){return e instanceof n&&Em(this._elements,e._elements)}},I_=class n extends ji{constructor(e,t){super(e),this._elements=t}_toFieldTransform(e){let t=a1(this,e,!0),i=this._elements.map(s=>Xs(s,t)),r=new Ui(i);return new zs(e.path,r)}isEqual(e){return e instanceof n&&Em(this._elements,e._elements)}},A_=class n extends ji{constructor(e,t){super(e),this._operand=t}_toFieldTransform(e){let t=new $r(e.serializer,LA(e.serializer,this._operand));return new zs(e.path,t)}isEqual(e){return e instanceof n&&this._operand===e._operand}};function A0(n,e,t,i){let r=n.createContext(1,e,t);M0("Data must be an object, but it was:",r,i);let s=[],o=Lt.empty();Qs(i,(c,l)=>{let d=R0(e,c,t);l=Ke(l);let u=r.childContextForFieldPath(d);if(l instanceof kl)s.push(d);else{let f=Xs(l,u);f!=null&&(s.push(d),o.set(d,f))}});let a=new pn(s);return new _f(o,a,r.fieldTransforms)}function D0(n,e,t,i,r,s){let o=n.createContext(1,e,t),a=[D_(e,i,t)],c=[r];if(s.length%2!==0)throw new D(k.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(D_(e,s[f])),c.push(s[f+1]);let l=[],d=Lt.empty();for(let f=a.length-1;f>=0;--f)if(!u1(l,a[f])){let b=a[f],E=c[f];E=Ke(E);let T=o.childContextForFieldPath(b);if(E instanceof kl)l.push(b);else{let S=Xs(E,T);S!=null&&(l.push(b),d.set(b,S))}}let u=new pn(l);return new _f(d,u,o.fieldTransforms)}function c1(n,e,t,i=!1){let r=n.createContext(i?4:3,e);return Xs(t,r)}function Xs(n,e){if(n=Ke(n),d1(n))return M0("Unsupported field value:",e,n),l1(n,e);if(n instanceof ji)return i9(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return n9(n,e)}else return r9(n,e)}function l1(n,e){let t={};return lA(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qs(n,(i,r)=>{let s=Xs(r,e.childContextForField(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function n9(n,e){let t=[],i=0;for(let r of n){let s=Xs(r,e.childContextForArray(i));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),i++}return{arrayValue:{values:t}}}function i9(n,e){if(!o1(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function r9(n,e){if(n=Ke(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return LA(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=Ye.fromDate(n);return{timestampValue:Sa(e.serializer,t)}}else if(n instanceof Ye){let t=new Ye(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:Sa(e.serializer,t)}}else{if(n instanceof Hs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ii)return{bytesValue:KA(e.serializer,n._byteString)};if(n instanceof Fe){let t=e.databaseId,i=n.firestore._databaseId;if(!i.isEqual(t))throw e.createError(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:t0(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof Sl)return s9(n,e);throw e.createError(`Unsupported field value: ${Vl(n)}`)}}}function s9(n,e){return{mapValue:{fields:{[W_]:{stringValue:K_},[_a]:{arrayValue:{values:n.toArray().map(i=>{if(typeof i!="number")throw e.createError("VectorValues must only contain numeric values.");return e0(e.serializer,i)})}}}}}}function d1(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof Ye)&&!(n instanceof Hs)&&!(n instanceof Ii)&&!(n instanceof Fe)&&!(n instanceof ji)&&!(n instanceof Sl)}function M0(n,e,t){if(!d1(t)||!v5(t)){let i=Vl(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function D_(n,e,t){if(e=Ke(e),e instanceof Kn)return e._internalPath;if(typeof e=="string")return R0(n,e);throw wf("Field path arguments must be of type string or ",n,!1,void 0,t)}var o9=new RegExp("[~\\*/\\[\\]]");function R0(n,e,t){if(e.search(o9)>=0)throw wf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Kn(...e.split("."))._internalPath}catch{throw wf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wf(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new D(k.INVALID_ARGUMENT,a+n+c)}function u1(n,e){return n.some(t=>t.isEqual(e))}var $s=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new M_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(Gf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},M_=class extends $s{data(){return super.data()}};function Gf(n,e){return typeof e=="string"?R0(n,e):e instanceof Kn?e._internalPath:e._delegate._internalPath}function h1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Il=class{},Ws=class extends Il{};function Wi(n,e,...t){let i=[];e instanceof Il&&i.push(e),i=i.concat(t),m9(i);for(let r of i)n=r._apply(n);return n}var Ef=class n extends Ws{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return w1(e._query,t),new At(e.firestore,e.converter,Z_(e._query,t))}_parse(e){let t=Ys(e.firestore);return a9(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function f1(n,e,t){let i=e,r=Gf("where",n);return Ef._create(r,i,t)}var R_=class n extends Il{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(h9(e._query,t),new At(e.firestore,e.converter,Z_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var N_=class n extends Ws{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=c9(e._query,this._field,this._direction);return new At(e.firestore,e.converter,Sq(e._query,t))}};function m1(n,e="asc"){let t=e,i=Gf("orderBy",n);return N_._create(i,t)}var Tf=class n extends Ws{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new At(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}};function p1(n){return zD("limit",n),Tf._create("limit",n,"F")}function g1(n){return zD("limitToLast",n),Tf._create("limitToLast",n,"L")}var Cf=class n extends Ws{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=x1(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,kq(e._query,t))}};function b1(...n){return Cf._create("startAt",n,!0)}function y1(...n){return Cf._create("startAfter",n,!1)}var Sf=class n extends Ws{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=x1(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,Iq(e._query,t))}};function v1(...n){return Sf._create("endBefore",n,!1)}function _1(...n){return Sf._create("endAt",n,!0)}function x1(n,e,t,i){if(t[0]=Ke(t[0]),t[0]instanceof $s)return l9(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Ys(n.firestore);return d9(n._query,n.firestore._databaseId,r,e,t,i)}}function a9(n,e,t,i,r,s,o){let a;if(r.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new D(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){qI(o,s);let l=[];for(let d of o)l.push(zI(i,n,d));a={arrayValue:{values:l}}}else a=zI(i,n,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&qI(o,s),a=c1(t,e,o,s==="in"||s==="not-in");return ue.create(r,s,a)}function c9(n,e,t){if(n.startAt!==null)throw new D(k.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new D(k.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Bs(e,t)}function l9(n,e,t,i,r){if(!i)throw new D(k.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${t}().`);let s=[];for(let o of Ea(n))if(o.field.isKeyField())s.push(Ls(e,i.key));else{let a=i.data.field(o.field);if(Of(a))throw new D(k.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(a!==null)s.push(a);else{let c=o.field.canonicalString();throw new D(k.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${c}' (used as the orderBy) does not exist.`)}}return new Si(s,r)}function d9(n,e,t,i,r,s){let o=n.explicitOrderBy;if(r.length>o.length)throw new D(k.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let a=[];for(let c=0;c<r.length;c++){let l=r[c];if(o[c].field.isKeyField()){if(typeof l!="string")throw new D(k.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof l}`);if(!X_(n)&&l.indexOf("/")!==-1)throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${l}' contains a slash.`);let u=n.path.child(fe.fromString(l));if(!B.isDocumentKey(u))throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${u}' is not because it contains an odd number of segments.`);let f=new B(u);a.push(Ls(e,f))}else{let u=c1(t,i,l);a.push(u)}}return new Si(a,s)}function zI(n,e,t){if(t=Ke(t),typeof t=="string"){if(t==="")throw new D(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!X_(e)&&t.indexOf("/")!==-1)throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(fe.fromString(t));if(!B.isDocumentKey(i))throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ls(n,new B(i))}else{if(t instanceof Fe)return Ls(n,t._key);throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vl(t)}.`)}}function qI(n,e){if(!Array.isArray(n)||n.length===0)throw new D(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function u9(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function w1(n,e){let t=f9(n.filters,u9(e.op));if(t!==null)throw t===e.op?new D(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function h9(n,e){let t=n,i=e.getFlattenedFilters();for(let r of i)w1(t,r),t=Z_(t,r)}function f9(n,e){for(let t of n)for(let i of t.getFlattenedFilters())if(e.indexOf(i.op)>=0)return i.op;return null}function m9(n){let e=n.filter(i=>i instanceof R_).length,t=n.filter(i=>i instanceof Ef).length;if(e>1||e>0&&t>0)throw new D(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var Fa=class{convertValue(e,t="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ur(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Qs(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t[_a].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>je(o.doubleValue));return new Sl(s)}convertGeoPoint(e){return new Hs(je(e.latitude),je(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=$_(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(cl(e));default:return null}}convertTimestamp(e){let t=zi(e);return new Ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=fe.fromString(e);K(sD(i));let r=new jr(i.get(1),i.get(3)),s=new B(i.popFirst(5));return r.isEqual(t)||Qe(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Hf(n,e,t){let i;return n?t&&(t.merge||t.mergeFields)?i=n.toFirestore(e,t):i=n.toFirestore(e):i=e,i}var O_=class extends Fa{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ii(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};function F_(n){return p9(n,["next","error","complete"])}function p9(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var Gi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Mn=class extends $s{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Yr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let i=this._document.data.field(Gf("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Yr=class extends Mn{data(e={}){return super.data(e)}},Qn=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Gi(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Yr(this._firestore,this._userDataWriter,i.key,i,new Gi(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=g9(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function g9(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(i=>{let r=new Yr(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Gi(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter);return i.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(i=>e||i.type!==3).map(i=>{let r=new Yr(n._firestore,n._userDataWriter,i.doc.key,i.doc,new Gi(n._snapshot.mutatedKeys.has(i.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return i.type!==0&&(s=t.indexOf(i.doc.key),t=t.delete(i.doc.key)),i.type!==1&&(t=t.add(i.doc),o=t.indexOf(i.doc.key)),{type:b9(i.type),doc:r,oldIndex:s,newIndex:o}})}}function b9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}function N0(n,e){return n instanceof Mn&&e instanceof Mn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Qn&&e instanceof Qn?n._firestore===e._firestore&&I0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot):!1}function E1(n){n=be(n,Fe);let e=be(n.firestore,Xe),t=Dt(e);return jD(t,n._key).then(i=>L0(e,n,i))}var Hi=class extends Fa{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ii(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};function T1(n){n=be(n,Fe);let e=be(n.firestore,Xe),t=Dt(e),i=new Hi(e);return N5(t,n._key).then(r=>new Mn(e,i,n._key,r,new Gi(r!==null&&r.hasLocalMutations,!0),n.converter))}function C1(n){n=be(n,Fe);let e=be(n.firestore,Xe),t=Dt(e);return jD(t,n._key,{source:"server"}).then(i=>L0(e,n,i))}function S1(n){n=be(n,At);let e=be(n.firestore,Xe),t=Dt(e),i=new Hi(e);return h1(n._query),GD(t,n._query).then(r=>new Qn(e,i,n,r))}function k1(n){n=be(n,At);let e=be(n.firestore,Xe),t=Dt(e),i=new Hi(e);return O5(t,n._query).then(r=>new Qn(e,i,n,r))}function I1(n){n=be(n,At);let e=be(n.firestore,Xe),t=Dt(e),i=new Hi(e);return GD(t,n._query,{source:"server"}).then(r=>new Qn(e,i,n,r))}function O0(n,e,t){n=be(n,Fe);let i=be(n.firestore,Xe),r=Hf(n.converter,e,t),s=Ys(i),a=jf(s,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,et.none());return $a(i,[a])}function F0(n,e,t,...i){n=be(n,Fe);let r=be(n.firestore,Xe),s=Ys(r);e=Ke(e);let o;typeof e=="string"||e instanceof Kn?o=D0(s,"updateDoc",n._key,e,t,i):o=A0(s,"updateDoc",n._key,e);let a=o.toMutation(n._key,et.exists(!0));return $a(r,[a])}function A1(n){let e=be(n.firestore,Xe),t=[new Kr(n._key,et.none())];return $a(e,t)}function D1(n,e){let t=be(n.firestore,Xe),i=zl(n),r=Hf(n.converter,e),s=Ys(n.firestore),a=jf(s,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,et.exists(!1));return $a(t,[a]).then(()=>i)}function P0(n,...e){var t,i,r;n=Ke(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]=="object"&&!F_(e[o])&&(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(F_(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(i=f.error)===null||i===void 0?void 0:i.bind(f),e[o+2]=(r=f.complete)===null||r===void 0?void 0:r.bind(f)}let c,l,d;if(n instanceof Fe)l=be(n.firestore,Xe),d=za(n._key.path),c={next:f=>{e[o]&&e[o](L0(l,n,f))},error:e[o+1],complete:e[o+2]};else{let f=be(n,At);l=be(f.firestore,Xe),d=f._query;let b=new Hi(l);c={next:E=>{e[o]&&e[o](new Qn(l,b,f,E))},error:e[o+1],complete:e[o+2]},h1(n._query)}let u=Dt(l);return R5(u,d,a,c)}function M1(n,e){n=be(n,Xe);let t=Dt(n),i=F_(e)?e:{next:e};return P5(t,i)}function $a(n,e){let t=Dt(n);return F5(t,e)}function L0(n,e,t){let i=t.docs.get(e._key),r=new Hi(n);return new Mn(n,r,e._key,i,new Gi(t.hasPendingWrites,t.fromCache),e.converter)}var y9={maxAttempts:5};function v9(n){if(n.maxAttempts<1)throw new D(k.INVALID_ARGUMENT,"Max attempts must be at least 1")}var kf=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ys(e)}set(e,t,i){this._verifyNotCommitted();let r=Br(e,this._firestore),s=Hf(r.converter,t,i),o=jf(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,et.none())),this}update(e,t,i,...r){this._verifyNotCommitted();let s=Br(e,this._firestore);t=Ke(t);let o;return typeof t=="string"||t instanceof Kn?o=D0(this._dataReader,"WriteBatch.update",s._key,t,i,r):o=A0(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,et.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Br(e,this._firestore);return this._mutations=this._mutations.concat(new Kr(t._key,et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(k.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Br(n,e){if(n=Ke(n),n.firestore!==e)throw new D(k.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var P_=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ys(e)}get(e){let t=Br(e,this._firestore),i=new O_(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||r.length!==1)return U();let s=r[0];if(s.isFoundDocument())return new $s(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new $s(this._firestore,i,t._key,null,t.converter);throw U()})}set(e,t,i){let r=Br(e,this._firestore),s=Hf(r.converter,t,i),o=jf(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){let s=Br(e,this._firestore);t=Ke(t);let o;return typeof t=="string"||t instanceof Kn?o=D0(this._dataReader,"Transaction.update",s._key,t,i,r):o=A0(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=Br(e,this._firestore);return this._transaction.delete(t._key),this}};var L_=class extends P_{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Br(e,this._firestore),i=new Hi(this._firestore);return super.get(e).then(r=>new Mn(this._firestore,i,t._key,r._document,new Gi(!1,!1),t.converter))}};function R1(n,e,t){n=be(n,Xe);let i=Object.assign(Object.assign({},y9),t);v9(i);let r=Dt(n);return L5(r,s=>e(new L_(n,s)),i)}function N1(){return new kl("deleteField")}function O1(){return new S_("serverTimestamp")}function F1(...n){return new k_("arrayUnion",n)}function P1(...n){return new I_("arrayRemove",n)}function L1(n){return new A_("increment",n)}e9("node");var _9="@firebase/firestore-compat",x9="0.3.38";function j0(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function B1(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function V1(){if(!dA())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}var $f=class n{constructor(e){this._delegate=e}static fromBase64String(e){return V1(),new n(Ii.fromBase64String(e))}static fromUint8Array(e){return B1(),new n(Ii.fromUint8Array(e))}toBase64(){return V1(),this._delegate.toBase64()}toUint8Array(){return B1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function B0(n){return w9(n,["next","error","complete"])}function w9(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var V0=class{enableIndexedDbPersistence(e,t){return XD(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return ZD(e._delegate)}clearIndexedDbPersistence(e){return e1(e._delegate)}},Wf=class{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof jr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Gn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){WD(this._delegate,e,t,i)}enableNetwork(){return n1(this._delegate)}disableNetwork(){return i1(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,w0("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return t1(this._delegate)}onSnapshotsInSync(e){return M1(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qa(this,S0(this._delegate,e))}catch(t){throw Qt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ai(this,zl(this._delegate,e))}catch(t){throw Qt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new to(this,KD(this._delegate,e))}catch(t){throw Qt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return R1(this._delegate,t=>e(new Kf(this,t)))}batch(){return Dt(this._delegate),new Qf(new kf(this._delegate,e=>$a(this._delegate,e)))}loadBundle(e){return r1(this._delegate,e)}namedQuery(e){return s1(this._delegate,e).then(t=>t?new to(this,t):null)}},Wa=class extends Fa{constructor(e){super(),this.firestore=e}convertBytes(e){return new $f(new Ii(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Ai.forKey(t,this.firestore,null)}};function E9(n){jI(n)}var Kf=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Wa(e)}get(e){let t=Zs(e);return this._delegate.get(t).then(i=>new Js(this._firestore,new Mn(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){let r=Zs(e);return i?(j0("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Zs(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Zs(e);return this._delegate.delete(t),this}},Qf=class{constructor(e){this._delegate=e}set(e,t,i){let r=Zs(e);return i?(j0("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Zs(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Zs(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ka=class n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){let i=new Yr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new eo(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let i=n.INSTANCES,r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new n(e,new Wa(e),t),r.set(t,s)),s}};Ka.INSTANCES=new WeakMap;var Ai=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Wa(e)}static forPath(e,t,i){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Fe(t._delegate,i,new B(e)))}static forKey(e,t,i){return new n(t,new Fe(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Qa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qa(this.firestore,S0(this._delegate,e))}catch(t){throw Qt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ke(e),e instanceof Fe?k0(this._delegate,e):!1}set(e,t){t=j0("DocumentReference.set",t);try{return t?O0(this._delegate,e,t):O0(this._delegate,e)}catch(i){throw Qt(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?F0(this._delegate,e):F0(this._delegate,e,t,...i)}catch(r){throw Qt(r,"updateDoc()","DocumentReference.update()")}}delete(){return A1(this._delegate)}onSnapshot(...e){let t=z1(e),i=q1(e,r=>new Js(this.firestore,new Mn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return P0(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=T1(this._delegate):e?.source==="server"?t=C1(this._delegate):t=E1(this._delegate),t.then(i=>new Js(this.firestore,new Mn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Qt(n,e,t){return n.message=n.message.replace(e,t),n}function z1(n){for(let e of n)if(typeof e=="object"&&!B0(e))return e;return{}}function q1(n,e){var t,i;let r;return B0(n[0])?r=n[0]:B0(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var Js=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ai(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return N0(this._delegate,e._delegate)}},eo=class extends Js{data(e){let t=this._delegate.data(e);return this._delegate._converter||GI(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},to=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Wa(e)}where(e,t,i){try{return new n(this.firestore,Wi(this._delegate,f1(e,t,i)))}catch(r){throw Qt(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Wi(this._delegate,m1(e,t)))}catch(i){throw Qt(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Wi(this._delegate,p1(e)))}catch(t){throw Qt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Wi(this._delegate,g1(e)))}catch(t){throw Qt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Wi(this._delegate,b1(...e)))}catch(t){throw Qt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Wi(this._delegate,y1(...e)))}catch(t){throw Qt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Wi(this._delegate,v1(...e)))}catch(t){throw Qt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Wi(this._delegate,_1(...e)))}catch(t){throw Qt(t,"endAt()","Query.endAt()")}}isEqual(e){return I0(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=k1(this._delegate):e?.source==="server"?t=I1(this._delegate):t=S1(this._delegate),t.then(i=>new ql(this.firestore,new Qn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){let t=z1(e),i=q1(e,r=>new ql(this.firestore,new Qn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return P0(this._delegate,t,i)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},z0=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new eo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},ql=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new to(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new eo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new z0(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new eo(this._firestore,i))})}isEqual(e){return N0(this._delegate,e._delegate)}},Qa=class n extends to{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Ai(this.firestore,e):null}doc(e){try{return e===void 0?new Ai(this.firestore,zl(this._delegate)):new Ai(this.firestore,zl(this._delegate,e))}catch(t){throw Qt(t,"doc()","CollectionReference.doc()")}}add(e){return D1(this._delegate,e).then(t=>new Ai(this.firestore,t))}isEqual(e){return k0(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ka.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Zs(n){return be(n,Fe)}var q0=class n{constructor(...e){this._delegate=new Kn(...e)}static documentId(){return new n(ot.keyField().canonicalString())}isEqual(e){return e=Ke(e),e instanceof Kn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var U0=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=O1();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=N1();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=F1(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=P1(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=L1(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var T9={Firestore:Wf,GeoPoint:Hs,Timestamp:Ye,Blob:$f,Transaction:Kf,WriteBatch:Qf,DocumentReference:Ai,DocumentSnapshot:Js,Query:to,QueryDocumentSnapshot:eo,QuerySnapshot:ql,CollectionReference:Qa,FieldPath:q0,FieldValue:U0,setLogLevel:E9,CACHE_SIZE_UNLIMITED:QD};function C9(n,e){n.INTERNAL.registerComponent(new as("firestore-compat",t=>{let i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},T9)))}function S9(n){C9(n,(e,t)=>new Wf(e,t,new V0)),n.registerVersion(_9,x9,"node")}S9(Xt);function k9(n,e=Gl){return new Xn(t=>{let i;return e!=null?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}function U1(n,e){return k9(n,e)}function I9(n,e){return U1(n,e).pipe(ro(void 0),Kl(),nt(t=>{let[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function $0(n,e){return U1(n,e).pipe(nt(t=>({payload:t,type:"query"})))}var Yf=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let i=this.ref.collection(e),{ref:r,query:s}=W1(i,t);return new Zf(r,s,this.afs)}snapshotChanges(){return I9(this.ref,this.afs.schedulers.outsideAngular).pipe(Zt)}valueChanges(e={}){return this.snapshotChanges().pipe(nt(({payload:t})=>e.idField?Yn(ke({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Zn(this.ref.get(e)).pipe(Zt)}};function Xf(n,e){return $0(n,e).pipe(ro(void 0),Kl(),nt(t=>{let[i,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,c)=>{let l=s.find(u=>u.doc.ref.isEqual(a.ref)),d=i?.payload.docs.find(u=>u.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function j1(n,e,t){return Xf(n,t).pipe(Ql((i,r)=>A9(i,r.map(s=>s.payload),e),[]),Wl(),nt(i=>i.map(r=>({type:r.type,payload:r}))))}function A9(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=D9(n,i))}),n}function G0(n,e,t,...i){let r=n.slice();return r.splice(e,t,...i),r}function D9(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return G0(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return G0(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return G0(n,e.oldIndex,1);break}return n}function G1(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Zf=class{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=Xf(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(nt(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(ro(void 0),Kl(),Qi(([i,r])=>r.length>0||!i),nt(([,i])=>i),Zt)}auditTrail(e){return this.stateChanges(e).pipe(Ql((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=G1(e);return j1(this.query,t,this.afs.schedulers.outsideAngular).pipe(Zt)}valueChanges(e={}){return $0(this.query,this.afs.schedulers.outsideAngular).pipe(nt(t=>t.payload.docs.map(i=>e.idField?Yn(ke({},i.data()),{[e.idField]:i.id}):i.data())),Zt)}get(e){return Zn(this.query.get(e)).pipe(Zt)}add(e){return this.ref.add(e)}doc(e){return new Yf(this.ref.doc(e),this.afs)}},H0=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Xf(this.query,this.afs.schedulers.outsideAngular).pipe(Zt):Xf(this.query,this.afs.schedulers.outsideAngular).pipe(nt(t=>t.filter(i=>e.indexOf(i.type)>-1)),Qi(t=>t.length>0),Zt)}auditTrail(e){return this.stateChanges(e).pipe(Ql((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=G1(e);return j1(this.query,t,this.afs.schedulers.outsideAngular).pipe(Zt)}valueChanges(e={}){return $0(this.query,this.afs.schedulers.outsideAngular).pipe(nt(i=>i.payload.docs.map(r=>e.idField?ke({[e.idField]:r.id},r.data()):r.data())),Zt)}get(e){return Zn(this.query.get(e)).pipe(Zt)}},H1=new ee("angularfire2.enableFirestorePersistence"),$1=new ee("angularfire2.firestore.persistenceSettings"),M9=new ee("angularfire2.firestore.settings"),R9=new ee("angularfire2.firestore.use-emulator");function W1(n,e=t=>t){return{query:e(n),ref:n}}var Ul=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,a,c,l,d,u,f,b,E,T,S,M,I){this.schedulers=c;let F=uc(t,a,i),P=d;u&&ap(F,a,f,E,T,S,b,M),[this.firestore,this.persistenceEnabled$]=Dd(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let G=a.runOutsideAngular(()=>F.firestore());if(s&&G.settings(s),P&&G.useEmulator(...P),r&&!id(o)){let J=()=>{try{return Zn(G.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(_){return typeof console<"u"&&console.warn(_),Jn(!1)}};return[G,a.runOutsideAngular(J)]}else return[G,Jn(!1)]},[s,P,r])}collection(t,i){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=W1(r,i),a=this.schedulers.ngZone.run(()=>s);return new Zf(a,o,this)}collectionGroup(t,i){let r=i||(o=>o),s=this.firestore.collectionGroup(t);return new H0(r(s),this)}doc(t){let i;typeof t=="string"?i=this.firestore.doc(t):i=t;let r=this.schedulers.ngZone.run(()=>i);return new Yf(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(j(mo),j(po,8),j(H1,8),j(M9,8),j(Xi),j(de),j(kd),j($1,8),j(R9,8),j(nE,8),j(tp,8),j(np,8),j(ip,8),j(rp,8),j(sp,8),j(op,8),j(fs,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),K1=(()=>{class n{constructor(){Xt.registerVersion("angularfire",fo.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:H1,useValue:!0},{provide:$1,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ae({type:n});static \u0275inj=oe({providers:[Ul]})}return n})();var Jf=(()=>{class n{constructor(t){this.firestore=t,this.collectionName="toppings"}getToppings(){return this.firestore.collection(this.collectionName).valueChanges({idField:"id"})}addTopping(t){return w(this,null,function*(){if(yield this.checkIfToppingExists(t))return Promise.reject("Topping with the same name already exists!");let r=this.firestore.createId();return this.firestore.collection(this.collectionName).doc(r).set({id:r,name:t}).then(()=>"Topping added successfully!")})}updateTopping(t,i){return w(this,null,function*(){return(yield this.checkIfToppingExists(i,t))?Promise.reject("Topping with the same name already exists!"):this.firestore.collection(this.collectionName).doc(t).update({name:i}).then(()=>"Topping updated successfully!")})}checkIfToppingExists(t,i){return w(this,null,function*(){let s=(yield Hl(this.firestore.collection(this.collectionName,o=>o.where("name","==",t.trim())).get())).docs.map(o=>o.data());return i?s.some(o=>o.id!==i):s.length>0})}deleteTopping(t){return this.firestore.collection(this.collectionName).doc(t).delete()}static{this.\u0275fac=function(i){return new(i||n)(j(Ul))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var N9=["mat-button",""],O9=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],F9=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var P9=new ee("MAT_BUTTON_CONFIG");var L9=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],B9=(()=>{class n{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}constructor(t,i,r,s){this._elementRef=t,this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=He(bw),this._rippleLoader=He(Mw),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let o=He(P9,{optional:!0}),a=t.nativeElement,c=a.classList;this.disabledInteractive=o?.disabledInteractive??!1,this._rippleLoader?.configureRipple(a,{className:"mat-mdc-button-ripple"});for(let{attribute:l,mdcClasses:d}of L9)a.hasAttribute(l)&&c.add(...d)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static{this.\u0275fac=function(i){Xl()}}static{this.\u0275dir=we({type:n,inputs:{color:"color",disableRipple:[le.HasDecoratorInputTransform,"disableRipple","disableRipple",jt],disabled:[le.HasDecoratorInputTransform,"disabled","disabled",jt],ariaDisabled:[le.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",jt],disabledInteractive:[le.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",jt]},features:[Zi]})}}return n})();var em=(()=>{class n extends B9{constructor(t,i,r,s){super(t,i,r,s)}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(xt),q(de),q(Rn,8))}}static{this.\u0275cmp=dt({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){i&2&&(qt("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),Zl(r.color?"mat-"+r.color:""),ze("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable",r._animationMode==="NoopAnimations")("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[ti,Yt],attrs:N9,ngContentSelectors:F9,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){i&1&&(gn(O9),Ie(0,"span",0),qe(1),$(2,"span",1),qe(3,1),W(),qe(4,2),Ie(5,"span",2)(6,"span",3)),i&2&&ze("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return n})();var X1=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,Dw,ft]})}}return n})();var J1=nr({passive:!0}),eM=(()=>{class n{constructor(t,i){this._platform=t,this._ngZone=i,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return nx;let i=ri(t),r=this._monitoredElements.get(i);if(r)return r.subject;let s=new Rt,o="cdk-text-field-autofilled",a=c=>{c.animationName==="cdk-text-field-autofill-start"&&!i.classList.contains(o)?(i.classList.add(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!0}))):c.animationName==="cdk-text-field-autofill-end"&&i.classList.contains(o)&&(i.classList.remove(o),this._ngZone.run(()=>s.next({target:c.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",a,J1),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:s,unlisten:()=>{i.removeEventListener("animationstart",a,J1)}}),s}stopMonitoring(t){let i=ri(t),r=this._monitoredElements.get(i);r&&(r.unlisten(),r.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((t,i)=>this.stopMonitoring(i))}static{this.\u0275fac=function(i){return new(i||n)(j(xt),j(de))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var tM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({})}}return n})();var W0=class{constructor(e){this._box=e,this._destroyed=new Rt,this._resizeSubject=new Rt,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new Xn(t=>{let i=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),i.unsubscribe(),this._elementObservables.delete(e)}}).pipe(Qi(t=>t.some(i=>i.target===e)),Xa({bufferSize:1,refCount:!0}),ei(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},nM=(()=>{class n{constructor(){this._observers=new Map,this._ngZone=He(de),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,t]of this._observers)t.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(t,i){let r=i?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new W0(r)),this._observers.get(r).observe(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var z9=["notch"],q9=["matFormFieldNotchedOutline",""],U9=["*"],j9=["textField"],G9=["iconPrefixContainer"],H9=["textPrefixContainer"],$9=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],W9=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function K9(n,e){n&1&&Ie(0,"span",17)}function Q9(n,e){if(n&1&&($(0,"label",16),qe(1,1),We(2,K9,1,0,"span",17),W()),n&2){let t=Se(2);Ve("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),qt("for",t._control.disableAutomaticLabeling?null:t._control.id),se(2),Ut(2,!t.hideRequiredMarker&&t._control.required?2:-1)}}function Y9(n,e){if(n&1&&We(0,Q9,3,5,"label",16),n&2){let t=Se();Ut(0,t._hasFloatingLabel()?0:-1)}}function X9(n,e){n&1&&Ie(0,"div",5)}function Z9(n,e){}function J9(n,e){if(n&1&&We(0,Z9,0,0,"ng-template",11),n&2){Se(2);let t=Za(1);Ve("ngTemplateOutlet",t)}}function eG(n,e){if(n&1&&($(0,"div",7),We(1,J9,1,1,null,11),W()),n&2){let t=Se();Ve("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),se(),Ut(1,t._forceDisplayInfixLabel()?-1:1)}}function tG(n,e){n&1&&($(0,"div",8,2),qe(2,2),W())}function nG(n,e){n&1&&($(0,"div",9,3),qe(2,3),W())}function iG(n,e){}function rG(n,e){if(n&1&&We(0,iG,0,0,"ng-template",11),n&2){Se();let t=Za(1);Ve("ngTemplateOutlet",t)}}function sG(n,e){n&1&&($(0,"div",12),qe(1,4),W())}function oG(n,e){n&1&&($(0,"div",13),qe(1,5),W())}function aG(n,e){n&1&&Ie(0,"div",14)}function cG(n,e){if(n&1&&($(0,"div",18),qe(1,6),W()),n&2){let t=Se();Ve("@transitionMessages",t._subscriptAnimationState)}}function lG(n,e){if(n&1&&($(0,"mat-hint",20),ye(1),W()),n&2){let t=Se(2);Ve("id",t._hintLabelId),se(),oo(t.hintLabel)}}function dG(n,e){if(n&1&&($(0,"div",19),We(1,lG,2,2,"mat-hint",20),qe(2,7),Ie(3,"div",21),qe(4,8),W()),n&2){let t=Se();Ve("@transitionMessages",t._subscriptAnimationState),se(),Ut(1,t.hintLabel?1:-1)}}var Ya=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n,selectors:[["mat-label"]],standalone:!0})}}return n})();var uG=new ee("MatError");var hG=0,iM=(()=>{class n{constructor(){this.align="start",this.id=`mat-mdc-hint-${hG++}`}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,r){i&2&&(ss("id",r.id),qt("align",null),ze("mat-mdc-form-field-hint-end",r.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0})}}return n})(),fG=new ee("MatPrefix");var mG=new ee("MatSuffix");var uM=new ee("FloatingLabelParent"),rM=(()=>{class n{get floating(){return this._floating}set floating(t){this._floating=t,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(t){this._monitorResize=t,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(t){this._elementRef=t,this._floating=!1,this._monitorResize=!1,this._resizeObserver=He(nM),this._ngZone=He(de),this._parent=He(uM),this._resizeSubscription=new cm}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return pG(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static{this.\u0275fac=function(i){return new(i||n)(q($e))}}static{this.\u0275dir=we({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,r){i&2&&ze("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0})}}return n})();function pG(n){let e=n;if(e.offsetParent!==null)return e.scrollWidth;let t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);let i=t.scrollWidth;return t.remove(),i}var sM="mdc-line-ripple--active",tm="mdc-line-ripple--deactivating",oM=(()=>{class n{constructor(t,i){this._elementRef=t,this._handleTransitionEnd=r=>{let s=this._elementRef.nativeElement.classList,o=s.contains(tm);r.propertyName==="opacity"&&o&&s.remove(sM,tm)},i.runOutsideAngular(()=>{t.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let t=this._elementRef.nativeElement.classList;t.remove(tm),t.add(sM)}deactivate(){this._elementRef.nativeElement.classList.add(tm)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(de))}}static{this.\u0275dir=we({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0})}}return n})(),aM=(()=>{class n{constructor(t,i){this._elementRef=t,this._ngZone=i,this.open=!1}ngAfterViewInit(){let t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(t){!this.open||!t?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${t}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(de))}}static{this.\u0275cmp=dt({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,r){if(i&1&&an(z9,5),i&2){let s;ut(s=ht())&&(r._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,r){i&2&&ze("mdc-notched-outline--notched",r.open)},inputs:{open:[le.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[Yt],attrs:q9,ngContentSelectors:U9,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(i,r){i&1&&(gn(),Ie(0,"div",1),$(1,"div",2,0),qe(3),W(),Ie(4,"div",3))},encapsulation:2,changeDetection:0})}}return n})(),gG={transitionMessages:Ex("transitionMessages",[Cx("enter",vm({opacity:1,transform:"translateY(0%)"})),Sx("void => enter",[vm({opacity:0,transform:"translateY(-5px)"}),Tx("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},K0=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=we({type:n})}}return n})();var Q0=new ee("MatFormField"),bG=new ee("MAT_FORM_FIELD_DEFAULT_OPTIONS"),cM=0,lM="fill",yG="auto",dM="fixed",vG="translateY(-50%)",nm=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=ii(t)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||yG}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(t){let i=this._appearance,r=t||this._defaults?.appearance||lM;this._appearance=r,this._appearance==="outline"&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||dM}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||dM}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}constructor(t,i,r,s,o,a,c,l){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=s,this._platform=o,this._defaults=a,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance=lM,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${cM++}`,this._hintLabelId=`mat-mdc-hint-${cM++}`,this._subscriptAnimationState="",this._destroyed=new Rt,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,a&&(a.appearance&&(this.appearance=a.appearance),this._hideRequiredMarker=!!a?.hideRequiredMarker,a.color&&(this.color=a.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${t.controlType}`),t.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(ei(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),$l(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ei(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(ei(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(t){let i=this._control?this._control.ngControl:null;return i&&i[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&t.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let i=this._hintChildren?this._hintChildren.find(s=>s.align==="start"):null,r=this._hintChildren?this._hintChildren.find(s=>s.align==="end"):null;i?t.push(i.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let t=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){t.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,o=r?.getBoundingClientRect().width??0,a=this._dir.value==="rtl"?"-1":"1",c=`${s+o}px`,d=`calc(${a} * (${c} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;t.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${vG} translateX(${d})
    )`}_isAttachedToDom(){let t=this._elementRef.nativeElement;if(t.getRootNode){let i=t.getRootNode();return i&&i!==t}return document.documentElement.contains(t)}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(os),q(de),q(vw),q(xt),q(bG,8),q(Rn,8),q(ln))}}static{this.\u0275cmp=dt({type:n,selectors:[["mat-form-field"]],contentQueries:function(i,r,s){if(i&1&&(Ji(s,Ya,5),Ji(s,Ya,7),Ji(s,K0,5),Ji(s,fG,5),Ji(s,mG,5),Ji(s,uG,5),Ji(s,iM,5)),i&2){let o;ut(o=ht())&&(r._labelChildNonStatic=o.first),ut(o=ht())&&(r._labelChildStatic=o.first),ut(o=ht())&&(r._formFieldControl=o.first),ut(o=ht())&&(r._prefixChildren=o),ut(o=ht())&&(r._suffixChildren=o),ut(o=ht())&&(r._errorChildren=o),ut(o=ht())&&(r._hintChildren=o)}},viewQuery:function(i,r){if(i&1&&(an(j9,5),an(G9,5),an(H9,5),an(rM,5),an(aM,5),an(oM,5)),i&2){let s;ut(s=ht())&&(r._textField=s.first),ut(s=ht())&&(r._iconPrefixContainer=s.first),ut(s=ht())&&(r._textPrefixContainer=s.first),ut(s=ht())&&(r._floatingLabel=s.first),ut(s=ht())&&(r._notchedOutline=s.first),ut(s=ht())&&(r._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,r){i&2&&ze("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations",r._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",r.appearance=="fill")("mat-form-field-appearance-outline",r.appearance=="outline")("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary",r.color!=="accent"&&r.color!=="warn")("mat-accent",r.color==="accent")("mat-warn",r.color==="warn")("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[cn([{provide:Q0,useExisting:n},{provide:uM,useExisting:n}]),Yt],ngContentSelectors:W9,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(i,r){if(i&1){let s=Nn();gn($9),We(0,Y9,1,1,"ng-template",null,0,px),$(2,"div",4,1),Re("click",function(a){return vt(s),_t(r._control.onContainerClick(a))}),We(4,X9,1,0,"div",5),$(5,"div",6),We(6,eG,2,2,"div",7)(7,tG,3,0,"div",8)(8,nG,3,0,"div",9),$(9,"div",10),We(10,rG,1,1,null,11),qe(11),W(),We(12,sG,2,0,"div",12)(13,oG,2,0,"div",13),W(),We(14,aG,1,0,"div",14),W(),$(15,"div",15),We(16,cG,2,1)(17,dG,5,2),W()}if(i&2){let s;se(2),ze("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),se(2),Ut(4,!r._hasOutline()&&!r._control.disabled?4:-1),se(2),Ut(6,r._hasOutline()?6:-1),se(),Ut(7,r._hasIconPrefix?7:-1),se(),Ut(8,r._hasTextPrefix?8:-1),se(2),Ut(10,!r._hasOutline()||r._forceDisplayInfixLabel()?10:-1),se(2),Ut(12,r._hasTextSuffix?12:-1),se(),Ut(13,r._hasIconSuffix?13:-1),se(),Ut(14,r._hasOutline()?-1:14),se(),ze("mat-mdc-form-field-subscript-dynamic-size",r.subscriptSizing==="dynamic"),se(),Ut(16,(s=r._getDisplayedMessages())==="error"?16:s==="hint"?17:-1)}},dependencies:[rM,aM,yx,oM,iM],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[gG.transitionMessages]},changeDetection:0})}}return n})(),Y0=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,nd,dw,ft]})}}return n})();var _G=new ee("MAT_INPUT_VALUE_ACCESSOR"),xG=["button","checkbox","file","hidden","image","radio","range","reset","submit"],wG=0,im=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=ii(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(ad.required)??!1}set required(t){this._required=ii(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Pm().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(t){this._errorStateTracker.matcher=t}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=ii(t)}get errorState(){return this._errorStateTracker.errorState}set errorState(t){this._errorStateTracker.errorState=t}constructor(t,i,r,s,o,a,c,l,d,u){this._elementRef=t,this._platform=i,this.ngControl=r,this._autofillMonitor=l,this._formField=u,this._uid=`mat-input-${wG++}`,this.focused=!1,this.stateChanges=new Rt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(E=>Pm().has(E)),this._iOSKeyupListener=E=>{let T=E.target;!T.value&&T.selectionStart===0&&T.selectionEnd===0&&(T.setSelectionRange(1,1),T.setSelectionRange(0,0))};let f=this._elementRef.nativeElement,b=f.nodeName.toLowerCase();this._inputValueAccessor=c||f,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&d.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new wd(a,r,o,s,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=b==="select",this._isTextarea=b==="textarea",this._isInFormField=!!u,this._isNativeSelect&&(this.controlType=f.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_dirtyCheckPlaceholder(){let t=this._getPlaceholder();if(t!==this._previousPlaceholder){let i=this._elementRef.nativeElement;this._previousPlaceholder=t,t?i.setAttribute("placeholder",t):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){xG.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let t=this._elementRef.nativeElement,i=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&i&&i.label)}else return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let t=this._elementRef.nativeElement;return this._isNativeSelect&&(t.multiple||t.size>1)}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(xt),q(ls,10),q(Mm,8),q(Rm,8),q(Iw),q(_G,10),q(eM),q(de),q(Q0,8))}}static{this.\u0275dir=we({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(i,r){i&1&&Re("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),i&2&&(ss("id",r.id)("disabled",r.disabled)("required",r.required),qt("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),ze("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[le.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[cn([{provide:K0,useExisting:n}]),Yi]})}}return n})(),fM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[ft,Y0,Y0,tM,ft]})}}return n})();function TG(n,e){if(n&1){let t=Nn();$(0,"div"),Ie(1,"br"),$(2,"mat-form-field",6)(3,"mat-label"),ye(4,"Edit topping"),W(),$(5,"input",1),tc("ngModelChange",function(r){vt(t);let s=Se(2);return ec(s.editedToppingName,r)||(s.editedToppingName=r),_t(r)}),W()(),$(6,"button",7),Re("click",function(){vt(t);let r=Se(2);return _t(r.saveEditedTopping())}),ye(7,"Save"),W(),$(8,"button",8),Re("click",function(){vt(t);let r=Se(2);return _t(r.cancelEdit())}),ye(9,"Cancel"),W()()}if(n&2){let t=Se(2);se(5),Ja("ngModel",t.editedToppingName)}}function CG(n,e){if(n&1){let t=Nn();$(0,"div",9),ye(1),$(2,"button",10),Re("click",function(){vt(t);let r=Se().$implicit,s=Se();return _t(s.startEditing(r))}),ye(3,"Edit"),W(),$(4,"button",11),Re("click",function(){vt(t);let r=Se().$implicit,s=Se();return _t(s.deleteTopping(r.id))}),ye(5,"Delete"),W()()}if(n&2){let t=Se().$implicit;se(),ao(" ",t.name," ")}}function SG(n,e){if(n&1&&($(0,"li"),We(1,TG,10,1,"div",4)(2,CG,6,1,"div",5),W()),n&2){let t=e.$implicit,i=Se();se(),Ve("ngIf",i.editingToppingId===t.id),se(),Ve("ngIf",i.editingToppingId!==t.id)}}function kG(n,e){n&1&&($(0,"p"),ye(1,"No toppings available."),W())}var pM=(()=>{class n{constructor(t){this.toppingsService=t,this.toppings=[],this.newTopping="",this.editingToppingId=null,this.editedToppingName=""}ngOnInit(){this.toppingsService.getToppings().subscribe(t=>{this.toppings=t})}addTopping(){if(!this.newTopping.trim()){alert("Topping name cannot be empty!");return}this.toppingsService.addTopping(this.newTopping.trim()).then(t=>{alert(t),this.newTopping=""}).catch(t=>alert(t))}deleteTopping(t){this.toppingsService.deleteTopping(t).catch(i=>console.error("Error deleting topping:",i))}startEditing(t){this.editingToppingId=t.id,this.editedToppingName=t.name}saveEditedTopping(){if(!this.editedToppingName.trim()){alert("Topping name cannot be empty!");return}this.toppingsService.updateTopping(this.editingToppingId,this.editedToppingName.trim()).then(t=>{alert(t),this.editingToppingId=null,this.editedToppingName=""}).catch(t=>alert(t))}cancelEdit(){this.editingToppingId=null,this.editedToppingName=""}static{this.\u0275fac=function(i){return new(i||n)(q(Jf))}}static{this.\u0275cmp=dt({type:n,selectors:[["app-toppings"]],decls:12,vars:3,consts:[[1,"title-heading"],["matInput","","placeholder","Ex. Cheese",3,"ngModelChange","ngModel"],["mat-flat-button","",1,"add-button",3,"click"],[4,"ngFor","ngForOf"],[4,"ngIf"],["style","font-family: 'bradley hand', cursive; font-size: 20px;",4,"ngIf"],[2,"width","40%"],["mat-flat-button","",1,"save-button",3,"click"],["mat-flat-button","",1,"cancel-button",3,"click"],[2,"font-family","'bradley hand', cursive","font-size","20px"],["mat-flat-button","",1,"edit-button",3,"click"],["mat-flat-button","",1,"delete-button",3,"click"]],template:function(i,r){i&1&&($(0,"h2",0),ye(1,"Manage Your Toppings"),W(),$(2,"div")(3,"mat-form-field")(4,"mat-label"),ye(5,"Enter topping name"),W(),$(6,"input",1),tc("ngModelChange",function(o){return ec(r.newTopping,o)||(r.newTopping=o),o}),W()(),$(7,"button",2),Re("click",function(){return r.addTopping()}),ye(8,"Add Topping"),W()(),$(9,"ul"),We(10,SG,3,2,"li",3),W(),We(11,kG,2,0,"p",4)),i&2&&(se(6),Ja("ngModel",r.newTopping),se(4),Ve("ngForOf",r.toppings),se(),Ve("ngIf",r.toppings.length===0))},dependencies:[ed,td,lo,gd,cc,em,im,nm,Ya],styles:[".title-heading[_ngcontent-%COMP%]{font-family:Brush Script MT,cursive;font-size:50px;margin-bottom:5%}.mat-flat-button[_ngcontent-%COMP%]{margin-left:5px;background-color:#d3630e;color:#fff;font-weight:700}.save-button[_ngcontent-%COMP%]{margin-left:15px;margin-right:5px;background-color:#d3630e!important;font-size:12px;width:35px;height:25px}.cancel-button[_ngcontent-%COMP%]{background-color:#0429cc!important;font-size:12px;width:35px;height:25px;color:#fff!important}.edit-button[_ngcontent-%COMP%]{margin-left:15px;margin-right:10px;background-color:#d3630e!important;font-size:10px;width:30px;height:20px}.delete-button[_ngcontent-%COMP%]{background-color:#c90000!important;font-size:10px;width:30px;height:20px;color:#fff!important}.add-button[_ngcontent-%COMP%]{margin-left:15px;background-color:#d3630e!important}"]})}}return n})();var gM=(()=>{class n{constructor(t){this.firestore=t,this.collectionName="pizzas"}getPizzas(){return this.firestore.collection(this.collectionName).valueChanges({idField:"id"})}addPizza(t,i){return w(this,null,function*(){if(yield this.checkIfPizzaExists(t))return Promise.reject("Pizza with the same name already exists!");let s=this.firestore.createId();return this.firestore.collection(this.collectionName).doc(s).set({id:s,name:t,toppings:i}).then(()=>"Pizza added successfully!")})}updatePizza(t,i,r){return w(this,null,function*(){return(yield this.checkIfPizzaExists(i,t))?Promise.reject("Pizza with the same name already exists!"):this.firestore.collection(this.collectionName).doc(t).update({name:i,toppings:r}).then(()=>"Pizza updated successfully!")})}checkIfPizzaExists(t,i){return w(this,null,function*(){let s=(yield Hl(this.firestore.collection(this.collectionName,o=>o.where("name","==",t.trim())).get())).docs.map(o=>o.data());return i?s.some(o=>o.id!==i):s.length>0})}deletePizza(t){return this.firestore.collection(this.collectionName).doc(t).delete()}static{this.\u0275fac=function(i){return new(i||n)(j(Ul))}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var DG=["input"],MG=["label"],RG=["*"],NG=new ee("mat-checkbox-default-options",{providedIn:"root",factory:yM});function yM(){return{color:"accent",clickAction:"check-indeterminate"}}var Bt=function(n){return n[n.Init=0]="Init",n[n.Checked=1]="Checked",n[n.Unchecked=2]="Unchecked",n[n.Indeterminate=3]="Indeterminate",n}(Bt||{}),OG={provide:pd,useExisting:rs(()=>rm),multi:!0},X0=class{},FG=0,bM=yM(),rm=(()=>{class n{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){let i=new X0;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,a){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._animationMode=o,this._options=a,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new on,this.indeterminateChange=new on,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=Bt.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||bM,this.color=this._options.color||bM.color,this.tabIndex=parseInt(s)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++FG}`}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){let i=t!=this._indeterminate;this._indeterminate=t,i&&(this._indeterminate?this._transitionCheckState(Bt.Indeterminate):this._transitionCheckState(this.checked?Bt.Checked:Bt.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&t.value!==!0?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(!(i===t||!r)&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);let s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let t=this._options?.clickAction;!this.disabled&&t!=="noop"?(this.indeterminate&&t!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?Bt.Checked:Bt.Unchecked),this._emitChangeEvent()):!this.disabled&&t==="noop"&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if(this._animationMode==="NoopAnimations")return"";switch(t){case Bt.Init:if(i===Bt.Checked)return this._animationClasses.uncheckedToChecked;if(i==Bt.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case Bt.Unchecked:return i===Bt.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case Bt.Checked:return i===Bt.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case Bt.Indeterminate:return i===Bt.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){let i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static{this.\u0275fac=function(i){return new(i||n)(q($e),q(os),q(de),mm("tabindex"),q(Rn,8),q(NG,8))}}static{this.\u0275cmp=dt({type:n,selectors:[["mat-checkbox"]],viewQuery:function(i,r){if(i&1&&(an(DG,5),an(MG,5),an(Ed,5)),i&2){let s;ut(s=ht())&&(r._inputElement=s.first),ut(s=ht())&&(r._labelElement=s.first),ut(s=ht())&&(r.ripple=s.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(i,r){i&2&&(ss("id",r.id),qt("tabindex",null)("aria-label",null)("aria-labelledby",null),Zl(r.color?"mat-"+r.color:"mat-accent"),ze("_mat-animation-noopable",r._animationMode==="NoopAnimations")("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked))},inputs:{ariaLabel:[le.None,"aria-label","ariaLabel"],ariaLabelledby:[le.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[le.None,"aria-describedby","ariaDescribedby"],id:"id",required:[le.HasDecoratorInputTransform,"required","required",jt],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[le.HasDecoratorInputTransform,"disableRipple","disableRipple",jt],tabIndex:[le.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>t==null?void 0:bm(t)],color:"color",checked:[le.HasDecoratorInputTransform,"checked","checked",jt],disabled:[le.HasDecoratorInputTransform,"disabled","disabled",jt],indeterminate:[le.HasDecoratorInputTransform,"indeterminate","indeterminate",jt]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[cn([OG,{provide:ac,useExisting:n,multi:!0}]),Zi,Yi,Yt],ngContentSelectors:RG,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(i,r){if(i&1){let s=Nn();gn(),$(0,"div",3),Re("click",function(a){return vt(s),_t(r._preventBubblingFromLabel(a))}),$(1,"div",4,0)(3,"div",5),Re("click",function(){return vt(s),_t(r._onTouchTargetClick())}),W(),$(4,"input",6,1),Re("blur",function(){return vt(s),_t(r._onBlur())})("click",function(){return vt(s),_t(r._onInputClick())})("change",function(a){return vt(s),_t(r._onInteractionEvent(a))}),W(),Ie(6,"div",7),$(7,"div",8),lx(),$(8,"svg",9),Ie(9,"path",10),W(),dx(),Ie(10,"div",11),W(),Ie(11,"div",12),W(),$(12,"label",13,2),qe(14),W()()}if(i&2){let s=Za(2);Ve("labelPosition",r.labelPosition),se(4),ze("mdc-checkbox--selected",r.checked),Ve("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled)("id",r.inputId)("required",r.required)("tabIndex",r.disabled?-1:r.tabIndex),qt("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("name",r.name)("value",r.value),se(7),Ve("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),se(),Ve("for",r.inputId)}},dependencies:[Ed,Rw],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return n})();var vM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n})}static{this.\u0275inj=oe({imports:[rm,ft,ft]})}}return n})();function LG(n,e){if(n&1){let t=Nn();$(0,"div",9)(1,"label")(2,"mat-checkbox",10),Re("change",function(){let r=vt(t).$implicit,s=Se();return _t(s.toggleTopping(r.id))}),W(),ye(3),W()()}if(n&2){let t=e.$implicit,i=Se();se(2),Ve("checked",i.selectedToppings.includes(t.id)),se(),ao(" ",t.name," ")}}function BG(n,e){if(n&1){let t=Nn();$(0,"button",11),Re("click",function(){vt(t);let r=Se();return _t(r.clearForm())}),ye(1,"Cancel"),W()}}function VG(n,e){if(n&1){let t=Nn();$(0,"li")(1,"strong",12),ye(2),W(),ye(3," - "),$(4,"i")(5,"b"),ye(6,"Toppings: "),W()(),$(7,"small",13),ye(8),W(),Ie(9,"br"),$(10,"button",14),Re("click",function(){let r=vt(t).$implicit,s=Se();return _t(s.editPizza(r))}),ye(11,"Edit"),W(),$(12,"button",15),Re("click",function(){let r=vt(t).$implicit,s=Se();return _t(s.deletePizza(r.id))}),ye(13,"Delete"),W(),Ie(14,"br")(15,"br"),W()}if(n&2){let t=e.$implicit,i=Se();se(2),oo(t.name),se(6),oo(i.getToppingNames(t.toppings))}}var _M=(()=>{class n{constructor(t,i){this.pizzasService=t,this.toppingsService=i,this.pizzas=[],this.toppingsList=[],this.selectedToppings=[],this.newPizzaName="",this.editingPizzaId=null}ngOnInit(){this.pizzasService.getPizzas().subscribe(t=>{this.pizzas=t}),this.toppingsService.getToppings().subscribe(t=>{this.toppingsList=t})}savePizza(){if(!this.newPizzaName.trim()){alert("Pizza name cannot be empty!");return}this.editingPizzaId?this.pizzasService.updatePizza(this.editingPizzaId,this.newPizzaName.trim(),this.selectedToppings).then(t=>{alert(t),this.clearForm()}).catch(t=>alert(t)):this.pizzasService.addPizza(this.newPizzaName.trim(),this.selectedToppings).then(t=>{alert(t),this.clearForm()}).catch(t=>alert(t))}editPizza(t){this.editingPizzaId=t.id,this.newPizzaName=t.name,this.selectedToppings=[...t.toppings]}deletePizza(t){this.pizzasService.deletePizza(t).then(()=>{alert("Pizza deleted successfully!")})}toggleTopping(t){let i=this.selectedToppings.indexOf(t);i>-1?this.selectedToppings.splice(i,1):this.selectedToppings.push(t)}getToppingNames(t){let i=t.map(r=>{let s=this.toppingsList.find(o=>o.id===r);return s?s.name:null}).filter(r=>r!==null);return i.length>0?i.join(", "):"No Toppings"}clearForm(){this.newPizzaName="",this.selectedToppings=[],this.editingPizzaId=null}static{this.\u0275fac=function(i){return new(i||n)(q(gM),q(Jf))}}static{this.\u0275cmp=dt({type:n,selectors:[["app-pizzas"]],decls:23,vars:6,consts:[[1,"title-header-pizza"],[2,"margin","5px"],["matInput","","placeholder","Enter pizza name",1,"form-input",3,"ngModelChange","ngModel"],["class","topping-checkbox",4,"ngFor","ngForOf"],["mat-flat-button","",1,"add-update-button",3,"click"],["mat-flat-button","","class","cancel-button",3,"click",4,"ngIf"],[1,"divider-style"],[1,"created-title"],[4,"ngFor","ngForOf"],[1,"topping-checkbox"],[2,"transform","scale(0.8)","transform-origin","center left",3,"change","checked"],["mat-flat-button","",1,"cancel-button",3,"click"],[2,"font-family","'Brush Script MT', cursive","font-size","30px"],[1,"topping-list"],["mat-flat-button","",1,"designed-pizza-edit",3,"click"],["mat-flat-button","",1,"designed-pizza-delete",3,"click"]],template:function(i,r){i&1&&($(0,"h2",0),ye(1,"Design Your Pizzas"),W(),$(2,"div")(3,"h3",1),ye(4),W(),$(5,"mat-form-field")(6,"mat-label"),ye(7,"Enter pizza name"),W(),$(8,"input",2),tc("ngModelChange",function(o){return ec(r.newPizzaName,o)||(r.newPizzaName=o),o}),W()(),Ie(9,"br"),$(10,"h4",1),ye(11,"Select Toppings:"),W(),We(12,LG,4,2,"div",3),Ie(13,"br"),$(14,"button",4),Re("click",function(){return r.savePizza()}),ye(15),W(),We(16,BG,2,0,"button",5),W(),Ie(17,"br")(18,"mat-divider",6),$(19,"h3",7),ye(20,"Your Pizzas Created"),W(),$(21,"ul"),We(22,VG,16,2,"li",8),W()),i&2&&(se(4),oo(r.editingPizzaId?"Edit Pizza":"Add New Pizza"),se(4),Ja("ngModel",r.newPizzaName),se(4),Ve("ngForOf",r.toppingsList),se(3),ao(" ",r.editingPizzaId?"Update Pizza":"Add Pizza"," "),se(),Ve("ngIf",r.editingPizzaId),se(6),Ve("ngForOf",r.pizzas))},dependencies:[ed,td,lo,gd,cc,Cd,em,im,nm,Ya,rm],styles:[".title-header-pizza[_ngcontent-%COMP%]{font-family:Brush Script MT,cursive;font-size:50px;margin-bottom:5%}.designed-pizza-edit[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;margin-left:15px;background-color:#d3630e!important;font-size:12px;width:35px;height:25px}.designed-pizza-delete[_ngcontent-%COMP%]{margin-top:5px;background-color:#c90000!important;font-size:12px;width:35px;height:25px;color:#fff!important}.cancel-button[_ngcontent-%COMP%]{background-color:#0429cc!important;color:#fff!important}.add-update-button[_ngcontent-%COMP%]{margin-left:15px;margin-right:5px;background-color:#d3630e!important}.divider-style[_ngcontent-%COMP%]{width:auto;margin-right:10%;border-top-width:3px;border-color:#d3630e!important;margin-top:5%}.topping-checkbox[_ngcontent-%COMP%]{font-family:bradley hand,cursive;font-size:17px;margin-bottom:3px}.topping-list[_ngcontent-%COMP%]{font-family:bradley hand,cursive;font-size:16px}.created-title[_ngcontent-%COMP%]{font-family:Brush Script MT,cursive;font-size:40px;margin-bottom:5%}"]})}}return n})();var sm=(()=>{class n{constructor(){this.title="pizza-manager"}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=dt({type:n,selectors:[["app-root"]],decls:12,vars:0,consts:[[1,"card-wrapper"],["ngSkipHydration","","appearance","outlined",1,"manager-card"],[1,"pizza-header-style"],["mat-card-avatar","",1,"pizza-header-image"],[1,"main-title"],[1,"main-subtitle"],[1,"topping-alignment"],[1,"divider-style-transition"],[1,"pizza-alignment"]],template:function(i,r){i&1&&($(0,"div",0)(1,"mat-card",1)(2,"mat-card-header",2),Ie(3,"div",3),$(4,"mat-card-title",4),ye(5,"Pizza Designer App"),W(),$(6,"mat-card-subtitle",5),ye(7,"Design Your Own Pizza!"),W()(),$(8,"div"),Ie(9,"app-toppings",6)(10,"mat-divider",7)(11,"app-pizzas",8),W()()())},dependencies:[Nw,Lw,Pw,Fw,Ow,Cd,pM,_M],styles:[".card-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;padding:1rem;width:100%;box-sizing:border-box}.main-title[_ngcontent-%COMP%]{font-family:Brush Script MT,cursive;font-size:40px;font-weight:700}.main-subtitle[_ngcontent-%COMP%]{font-size:medium;font-weight:700}.manager-card[_ngcontent-%COMP%]{max-width:100%;display:flex;margin:5% auto 10%;width:auto;background-color:#efb080;box-shadow:50px 50px 50px #000;border-radius:16px}.topping-alignment[_ngcontent-%COMP%]{display:block;margin-left:10%;width:75%}.pizza-alignment[_ngcontent-%COMP%]{display:block;margin-left:10%;margin-right:10%;width:auto}.pizza-header-style[_ngcontent-%COMP%]{background-color:#d3630e;display:flex;justify-content:center;align-items:center;border-top-left-radius:16px;border-top-right-radius:16px}.pizza-body-style[_ngcontent-%COMP%]{background-color:#efb080}.pizza-header-image[_ngcontent-%COMP%]{background-image:url(/assets/pizza-avatar.png);background-size:cover;width:80px;height:80px;border-radius:50%}.divider-style-transition[_ngcontent-%COMP%]{width:auto;margin:7% 10%;border-top-width:3px;border-color:#d3630e!important}"]})}}return n})();var qG="@",UG=(()=>{class n{constructor(t,i,r,s,o){this.doc=t,this.delegate=i,this.zone=r,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=He(hx,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-BL2JXLZI.mjs")).catch(i=>{throw new so(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:r})=>{this._engine=i(this.animationType,this.doc,this.scheduler);let s=new r(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,i){let r=this.delegate.createRenderer(t,i);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let s=new Z0(r);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let a=o.createRenderer(t,i);s.use(a)}).catch(o=>{s.use(r)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(i){Xl()}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac})}}return n})(),Z0=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,i,r){this.delegate.insertBefore(e,t,i,r)}removeChild(e,t,i){this.delegate.removeChild(e,t,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){this.shouldReplay(t)&&this.replay.push(r=>r.setProperty(e,t,i)),this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.shouldReplay(t)&&this.replay.push(r=>r.listen(e,t,i)),this.delegate.listen(e,t,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(qG)}};function xM(n="animations"){return mx("NgAsyncAnimations"),cx([{provide:fx,useFactory:(e,t,i)=>new UG(e,t,i,n),deps:[ln,_x,de]},{provide:Rn,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var wM={production:!0,firebaseConfig:{apiKey:"YOUR_API_KEY",authDomain:"YOUR_PROJECT_ID.firebaseapp.com",projectId:"YOUR_PROJECT_ID",storageBucket:"YOUR_PROJECT_ID.appspot.com",messagingSenderId:"YOUR_MESSAGING_SENDER_ID",appId:"YOUR_APP_ID"}};var EM=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n,bootstrap:[sm]})}static{this.\u0275inj=oe({providers:[wx(),xM()],imports:[xx,ow,sw,Td,Bw,X1,fM,vM,tE.initializeApp(wM.firebaseConfig),K1]})}}return n})();var jG=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ae({type:n,bootstrap:[sm]})}static{this.\u0275inj=oe({imports:[EM,kx,Td]})}}return n})();export{jG as a};
